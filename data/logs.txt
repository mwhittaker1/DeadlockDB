2025-05-08 21:59:41,478 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 21:59:47,096 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 21:59:47,101 [INFO] [root.drop_all_tables] Dropped table: player_trends
2025-05-08 22:00:23,568 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:00:23,574 [INFO] [root.drop_all_tables] Dropped table: hero_trends
2025-05-08 22:00:39,974 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:00:39,979 [INFO] [root.drop_all_tables] Dropped table: player_rolling_stats
2025-05-08 22:00:39,982 [INFO] [root.drop_all_tables] Dropped table: matches
2025-05-08 22:00:39,982 [INFO] [root.drop_all_tables] Dropped table: hero_trends
2025-05-08 22:00:39,986 [INFO] [root.drop_all_tables] Dropped table: player_matches
2025-05-08 22:00:39,990 [INFO] [root.drop_all_tables] Dropped table: player_hero_trends
2025-05-08 22:00:39,990 [INFO] [root.drop_all_tables] Dropped table: player_trends
2025-05-08 22:00:40,002 [INFO] [root.drop_all_tables] All tables dropped: {'player_rolling_stats', 'matches', 'hero_trends', 'player_matches', 'player_hero_trends', 'player_trends'}
2025-05-08 22:00:40,002 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:00:40,017 [INFO] [root.create_all_tables] Resulting tables: {'matches', 'player_rolling_stats', 'hero_trends', 'player_matches', 'player_hero_trends', 'player_trends'}
2025-05-08 22:01:25,179 [INFO] [root.drop_all_tables] Dropped table: player_hero_trends
2025-05-08 22:01:25,183 [INFO] [root.drop_all_tables] Dropped table: player_trends
2025-05-08 22:02:10,537 [INFO] [root.drop_all_tables] Dropped table: player_hero_trends
2025-05-08 22:03:36,143 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:03:36,143 [INFO] [root.drop_all_tables] Dropped table: player_hero_trends
2025-05-08 22:03:36,144 [INFO] [root.drop_all_tables] Dropped table: player_rolling_stats
2025-05-08 22:03:36,150 [INFO] [root.drop_all_tables] Dropped table: hero_trends
2025-05-08 22:03:36,150 [INFO] [root.drop_all_tables] Dropped table: player_trends
2025-05-08 22:03:36,151 [INFO] [root.drop_all_tables] Dropped table: matches
2025-05-08 22:03:36,154 [INFO] [root.drop_all_tables] Dropped table: player_matches
2025-05-08 22:03:36,168 [INFO] [root.drop_all_tables] All tables dropped: {'player_hero_trends', 'player_rolling_stats', 'hero_trends', 'player_trends', 'matches', 'player_matches'}
2025-05-08 22:03:36,168 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:03:36,191 [INFO] [root.create_all_tables] Resulting tables: {'hero_trends', 'player_matches', 'player_hero_trends', 'player_rolling_stats', 'player_trends', 'matches'}
2025-05-08 22:03:52,554 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:03:52,559 [INFO] [root.drop_all_tables] Dropped table: matches
2025-05-08 22:04:45,047 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:04:45,048 [INFO] [root.drop_all_tables] Dropped table: matches
2025-05-08 22:06:07,592 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:06:07,592 [INFO] [root.drop_all_tables] Dropped table: player_rolling_stats
2025-05-08 22:06:07,593 [INFO] [root.drop_all_tables] Dropped table: player_hero_trends
2025-05-08 22:06:07,593 [INFO] [root.drop_all_tables] Dropped table: player_matches
2025-05-08 22:06:07,593 [INFO] [root.drop_all_tables] Dropped table: hero_trendsplayer_trends
2025-05-08 22:06:07,593 [INFO] [root.drop_all_tables] Dropped table: matches
2025-05-08 22:06:07,605 [INFO] [root.drop_all_tables] All tables dropped: {'player_rolling_stats', 'player_hero_trends', 'player_matches', 'hero_trendsplayer_trends', 'matches'}
2025-05-08 22:06:07,605 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:07:29,614 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:07:29,614 [INFO] [root.drop_all_tables] Dropped table: player_hero_trends
2025-05-08 22:07:29,614 [INFO] [root.drop_all_tables] Dropped table: hero_trendsplayer_trends
2025-05-08 22:07:29,619 [INFO] [root.drop_all_tables] Dropped table: player_matches
2025-05-08 22:07:29,622 [INFO] [root.drop_all_tables] Dropped table: matches
2025-05-08 22:07:29,623 [INFO] [root.drop_all_tables] Dropped table: player_rolling_stats
2025-05-08 22:07:29,634 [INFO] [root.drop_all_tables] All tables dropped: {'player_hero_trends', 'hero_trendsplayer_trends', 'player_matches', 'matches', 'player_rolling_stats'}
2025-05-08 22:07:29,634 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:08:58,068 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:08:58,089 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:08:58,116 [INFO] [root.create_all_tables] Resulting tables: {'player_matches', 'player_rolling_stats', 'player_trends', 'player_hero_trends', 'hero_trends', 'matches'}
2025-05-08 22:08:58,116 [INFO] [root.create_all_tables] All tables created: {'player_matches', 'player_hero_trends', 'matches', 'player_rolling_stats', 'hero_trends', 'player_trends'}
2025-05-08 22:09:15,646 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:09:15,649 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:09:16,524 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746670155&max_unix_timestamp=1746756555&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:09:16,624 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:09:17,411 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746583756&max_unix_timestamp=1746670156&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:09:17,422 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:09:17,934 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746497357&max_unix_timestamp=1746583757&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:09:18,036 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:09:18,542 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746410958&max_unix_timestamp=1746497358&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:09:18,560 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:09:19,305 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746324558&max_unix_timestamp=1746410958&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:09:19,390 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data fetched
2025-05-08 22:09:19,390 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Normalizing data
2025-05-08 22:09:19,390 [INFO] [root.normalize_bulk_matches] Normalizing bulk match data
2025-05-08 22:09:19,390 [INFO] [root.normalize_bulk_matches] Processing day #0 with 240 matches
2025-05-08 22:09:19,392 [INFO] [root.normalize_bulk_matches] Processing day #1 with 168 matches
2025-05-08 22:09:19,392 [INFO] [root.normalize_bulk_matches] Processing day #2 with 191 matches
2025-05-08 22:09:19,394 [INFO] [root.normalize_bulk_matches] Processing day #3 with 187 matches
2025-05-08 22:09:19,394 [INFO] [root.normalize_bulk_matches] Processing day #4 with 180 matches
2025-05-08 22:09:19,408 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data normalized
2025-05-08 22:09:19,408 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Loading data into database
2025-05-08 22:09:19,408 [INFO] [root.save_bulk_matches_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:09:19,470 [INFO] [root.save_bulk_matches_to_db] Bulk load complete.
2025-05-08 22:09:19,470 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data loaded into database
2025-05-08 22:09:19,475 [INFO] [root.run_etl_hero_trends] starting run_etl_hero_trends ETL without critical errors.
2025-05-08 22:09:19,475 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 7 days
2025-05-08 22:09:19,475 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?7&100


2025-05-08 22:09:19,476 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:09:19,519 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?7&100 HTTP/1.1" 200 None
2025-05-08 22:09:19,520 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:09:19,520 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:09:19,521 [INFO] [root.build_hero_trends] Setting trend window: start=1747361359, end=1746756559, window_days=7
2025-05-08 22:09:19,525 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'matches', 'losses', 'total_kills', 'players', 'total_deaths', 'total_creep_damage', 'total_shots_hit', 'total_boss_damage', 'total_neutral_damage', 'total_max_health', 'total_last_hits', 'total_net_worth', 'total_denies', 'total_assists', 'wins', 'total_player_damage_taken', 'total_shots_missed', 'total_player_damage'}
2025-05-08 22:09:19,525 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:09:19,531 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 26-0
2025-05-08 22:09:19,531 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 30 days
2025-05-08 22:09:19,531 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?30&100


2025-05-08 22:09:19,531 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:09:19,566 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?30&100 HTTP/1.1" 200 None
2025-05-08 22:09:19,567 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:09:19,567 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:09:19,567 [INFO] [root.build_hero_trends] Setting trend window: start=1749348559, end=1746756559, window_days=30
2025-05-08 22:09:19,570 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'matches', 'losses', 'total_kills', 'players', 'total_deaths', 'total_creep_damage', 'total_shots_hit', 'total_boss_damage', 'total_neutral_damage', 'total_max_health', 'total_last_hits', 'total_net_worth', 'total_denies', 'total_assists', 'wins', 'total_player_damage_taken', 'total_shots_missed', 'total_player_damage'}
2025-05-08 22:09:19,570 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:09:19,576 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 52-26
2025-05-08 22:09:19,576 [INFO] [root.run_etl_hero_trends] completed 7d and 30d hero trends ETL without critical errors.
2025-05-08 22:09:19,576 [INFO] [root.run_etl_player_hero_match_trends] Starting function tests
2025-05-08 22:09:19,581 [INFO] [root.pull_trend_players_from_db] Pulled 50 players to trend
2025-05-08 22:09:19,582 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=0, account_id=1040431772) of 50
2025-05-08 22:09:19,582 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1040431772/match-history?only_stored_history=true
2025-05-08 22:09:19,582 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:09:20,067 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1040431772/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:09:20,152 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:09:20,154 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1040431772
1       1040431772
2       1040431772
3       1040431772
4       1040431772
           ...    
1543    1040431772
1544    1040431772
1545    1040431772
1546    1040431772
1547    1040431772
Name: account_id, Length: 1548, dtype: int64
2025-05-08 22:09:20,154 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9374
2025-05-08 22:09:20,154 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7504
2025-05-08 22:09:20,154 [DEBUG] [root.generate_player_performance_metrics] match_total: 1548
2025-05-08 22:09:20,155 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1040431772
1       1040431772
2       1040431772
3       1040431772
4       1040431772
           ...    
1543    1040431772
1544    1040431772
1545    1040431772
1546    1040431772
1547    1040431772
Name: account_id, Length: 1548, dtype: int64
2025-05-08 22:09:20,155 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:09:20,161 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:09:20,163 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:09:20,163 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:09:20,163 [ERROR] [root.save_player_trends_to_db] Player Trends DataFrame schema mismatch:  missing={'p_v_h_win_pct', 'p_v_h_pick_pct'}, extra={'match_result', 'net_worth', 'abandoned_time_s', 'team_abandoned', 'match_mode', 'player_assists', 'player_deaths', 'hero_level', 'last_hits', 'objectives_mask_team1', 'player_kills', 'hero_id', 'player_team', 'objectives_mask_team0', 'start_time', 'won', 'match_id', 'denies', 'match_duration_s', 'game_mode'}
2025-05-08 22:11:48,104 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:11:48,130 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:11:48,154 [INFO] [root.create_all_tables] Resulting tables: {'player_trends', 'hero_trends', 'player_hero_trends', 'matches', 'player_rolling_stats', 'player_matches'}
2025-05-08 22:11:48,154 [INFO] [root.create_all_tables] All tables created: {'player_trends', 'player_matches', 'matches', 'player_hero_trends', 'hero_trends', 'player_rolling_stats'}
2025-05-08 22:11:48,154 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:11:48,156 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:11:49,017 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746670308&max_unix_timestamp=1746756708&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:11:49,122 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:11:49,868 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746583909&max_unix_timestamp=1746670309&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:11:49,948 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:11:50,682 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746497509&max_unix_timestamp=1746583909&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:11:50,767 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:11:51,280 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746411110&max_unix_timestamp=1746497510&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:11:51,297 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:11:51,814 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746324711&max_unix_timestamp=1746411111&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:11:51,829 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data fetched
2025-05-08 22:11:51,829 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Normalizing data
2025-05-08 22:11:51,829 [INFO] [root.normalize_bulk_matches] Normalizing bulk match data
2025-05-08 22:11:51,829 [INFO] [root.normalize_bulk_matches] Processing day #0 with 240 matches
2025-05-08 22:11:51,831 [INFO] [root.normalize_bulk_matches] Processing day #1 with 167 matches
2025-05-08 22:11:51,831 [INFO] [root.normalize_bulk_matches] Processing day #2 with 192 matches
2025-05-08 22:11:51,832 [INFO] [root.normalize_bulk_matches] Processing day #3 with 187 matches
2025-05-08 22:11:51,833 [INFO] [root.normalize_bulk_matches] Processing day #4 with 180 matches
2025-05-08 22:11:51,846 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data normalized
2025-05-08 22:11:51,846 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Loading data into database
2025-05-08 22:11:51,846 [INFO] [root.save_bulk_matches_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:11:51,904 [INFO] [root.save_bulk_matches_to_db] Bulk load complete.
2025-05-08 22:11:51,904 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data loaded into database
2025-05-08 22:11:51,905 [INFO] [root.run_etl_hero_trends] starting run_etl_hero_trends ETL without critical errors.
2025-05-08 22:11:51,905 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 7 days
2025-05-08 22:11:51,905 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?7&100


2025-05-08 22:11:51,906 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:11:51,950 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?7&100 HTTP/1.1" 200 None
2025-05-08 22:11:51,950 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:11:51,951 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:11:51,951 [INFO] [root.build_hero_trends] Setting trend window: start=1747361511, end=1746756711, window_days=7
2025-05-08 22:11:51,954 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_player_damage_taken', 'total_denies', 'total_creep_damage', 'total_max_health', 'total_assists', 'total_boss_damage', 'losses', 'matches', 'total_neutral_damage', 'total_net_worth', 'total_kills', 'wins', 'players', 'total_shots_hit', 'total_deaths', 'total_shots_missed', 'total_last_hits', 'total_player_damage'}
2025-05-08 22:11:51,954 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:11:51,960 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 26-0
2025-05-08 22:11:51,960 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 30 days
2025-05-08 22:11:51,960 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?30&100


2025-05-08 22:11:51,961 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:11:52,003 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?30&100 HTTP/1.1" 200 None
2025-05-08 22:11:52,004 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:11:52,004 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:11:52,004 [INFO] [root.build_hero_trends] Setting trend window: start=1749348712, end=1746756712, window_days=30
2025-05-08 22:11:52,006 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_player_damage_taken', 'total_denies', 'total_creep_damage', 'total_max_health', 'total_assists', 'total_boss_damage', 'losses', 'matches', 'total_neutral_damage', 'total_net_worth', 'total_kills', 'wins', 'players', 'total_shots_hit', 'total_deaths', 'total_shots_missed', 'total_last_hits', 'total_player_damage'}
2025-05-08 22:11:52,006 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:11:52,012 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 52-26
2025-05-08 22:11:52,012 [INFO] [root.run_etl_hero_trends] completed 7d and 30d hero trends ETL without critical errors.
2025-05-08 22:11:52,012 [INFO] [root.run_etl_player_hero_match_trends] Starting function tests
2025-05-08 22:11:52,015 [INFO] [root.pull_trend_players_from_db] Pulled 50 players to trend
2025-05-08 22:11:52,015 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=0, account_id=116510665) of 50
2025-05-08 22:11:52,015 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/116510665/match-history?only_stored_history=true
2025-05-08 22:11:52,017 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:11:52,477 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/116510665/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:11:52,482 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:11:52,483 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      116510665
1      116510665
2      116510665
3      116510665
4      116510665
         ...    
797    116510665
798    116510665
799    116510665
800    116510665
801    116510665
Name: account_id, Length: 802, dtype: int64
2025-05-08 22:11:52,483 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5708
2025-05-08 22:11:52,483 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4039
2025-05-08 22:11:52,483 [DEBUG] [root.generate_player_performance_metrics] match_total: 802
2025-05-08 22:11:52,484 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      116510665
1      116510665
2      116510665
3      116510665
4      116510665
         ...    
797    116510665
798    116510665
799    116510665
800    116510665
801    116510665
Name: account_id, Length: 802, dtype: int64
2025-05-08 22:11:52,484 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:11:52,490 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:11:52,491 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:11:52,491 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:11:52,491 [ERROR] [root.save_player_trends_to_db] Player Trends DataFrame schema mismatch:  missing={'p_v_h_pick_pct', 'p_v_h_win_pct'}, extra={'match_duration_s', 'net_worth', 'team_abandoned', 'player_assists', 'objectives_mask_team0', 'match_mode', 'won', 'start_time', 'hero_level', 'match_result', 'player_team', 'hero_id', 'denies', 'last_hits', 'match_id', 'abandoned_time_s', 'player_deaths', 'player_kills', 'game_mode', 'objectives_mask_team1'}
2025-05-08 22:12:43,607 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:12:43,610 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:12:53,628 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:12:53,657 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:12:53,683 [INFO] [root.create_all_tables] Resulting tables: {'player_hero_trends', 'player_trends', 'hero_trends', 'player_rolling_stats', 'matches', 'player_matches'}
2025-05-08 22:12:53,683 [INFO] [root.create_all_tables] All tables created: {'player_hero_trends', 'player_rolling_stats', 'player_trends', 'matches', 'player_matches', 'hero_trends'}
2025-05-08 22:12:53,683 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:12:53,686 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:12:54,463 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746670373&max_unix_timestamp=1746756773&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:12:54,567 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:12:55,317 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746583974&max_unix_timestamp=1746670374&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:12:55,422 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:12:55,949 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746497575&max_unix_timestamp=1746583975&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:12:55,964 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:12:56,722 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746411175&max_unix_timestamp=1746497575&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:12:56,736 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:12:57,418 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746324776&max_unix_timestamp=1746411176&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:12:57,504 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data fetched
2025-05-08 22:12:57,504 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Normalizing data
2025-05-08 22:12:57,504 [INFO] [root.normalize_bulk_matches] Normalizing bulk match data
2025-05-08 22:12:57,504 [INFO] [root.normalize_bulk_matches] Processing day #0 with 241 matches
2025-05-08 22:12:57,505 [INFO] [root.normalize_bulk_matches] Processing day #1 with 167 matches
2025-05-08 22:12:57,506 [INFO] [root.normalize_bulk_matches] Processing day #2 with 192 matches
2025-05-08 22:12:57,507 [INFO] [root.normalize_bulk_matches] Processing day #3 with 187 matches
2025-05-08 22:12:57,508 [INFO] [root.normalize_bulk_matches] Processing day #4 with 179 matches
2025-05-08 22:12:57,522 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data normalized
2025-05-08 22:12:57,522 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Loading data into database
2025-05-08 22:12:57,522 [INFO] [root.save_bulk_matches_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:12:57,583 [INFO] [root.save_bulk_matches_to_db] Bulk load complete.
2025-05-08 22:12:57,583 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data loaded into database
2025-05-08 22:12:57,584 [INFO] [root.run_etl_hero_trends] starting run_etl_hero_trends ETL without critical errors.
2025-05-08 22:12:57,584 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 7 days
2025-05-08 22:12:57,584 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?7&100


2025-05-08 22:12:57,585 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:12:57,633 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?7&100 HTTP/1.1" 200 None
2025-05-08 22:12:57,634 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:12:57,634 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:12:57,634 [INFO] [root.build_hero_trends] Setting trend window: start=1747361577, end=1746756777, window_days=7
2025-05-08 22:12:57,638 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_neutral_damage', 'total_denies', 'total_creep_damage', 'total_player_damage', 'total_max_health', 'total_deaths', 'wins', 'players', 'matches', 'total_assists', 'total_shots_missed', 'total_kills', 'total_player_damage_taken', 'total_net_worth', 'total_shots_hit', 'total_last_hits', 'losses', 'total_boss_damage'}
2025-05-08 22:12:57,638 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:12:57,643 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 26-0
2025-05-08 22:12:57,644 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 30 days
2025-05-08 22:12:57,644 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?30&100


2025-05-08 22:12:57,644 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:12:57,683 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?30&100 HTTP/1.1" 200 None
2025-05-08 22:12:57,684 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:12:57,684 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:12:57,684 [INFO] [root.build_hero_trends] Setting trend window: start=1749348777, end=1746756777, window_days=30
2025-05-08 22:12:57,687 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_neutral_damage', 'total_denies', 'total_creep_damage', 'total_player_damage', 'total_max_health', 'total_deaths', 'wins', 'players', 'matches', 'total_assists', 'total_shots_missed', 'total_kills', 'total_player_damage_taken', 'total_net_worth', 'total_shots_hit', 'total_last_hits', 'losses', 'total_boss_damage'}
2025-05-08 22:12:57,687 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:12:57,692 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 52-26
2025-05-08 22:12:57,692 [INFO] [root.run_etl_hero_trends] completed 7d and 30d hero trends ETL without critical errors.
2025-05-08 22:12:57,692 [INFO] [root.run_etl_player_hero_match_trends] Starting function tests
2025-05-08 22:12:57,696 [INFO] [root.pull_trend_players_from_db] Pulled 50 players to trend
2025-05-08 22:12:57,697 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=0, account_id=1115903684) of 50
2025-05-08 22:12:57,697 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1115903684/match-history?only_stored_history=true
2025-05-08 22:12:57,697 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:12:58,202 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1115903684/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:12:58,209 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:12:58,209 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1115903684
1       1115903684
2       1115903684
3       1115903684
4       1115903684
           ...    
1102    1115903684
1103    1115903684
1104    1115903684
1105    1115903684
1106    1115903684
Name: account_id, Length: 1107, dtype: int64
2025-05-08 22:12:58,210 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5740
2025-05-08 22:12:58,210 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6008
2025-05-08 22:12:58,210 [DEBUG] [root.generate_player_performance_metrics] match_total: 1107
2025-05-08 22:12:58,211 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1115903684
1       1115903684
2       1115903684
3       1115903684
4       1115903684
           ...    
1102    1115903684
1103    1115903684
1104    1115903684
1105    1115903684
1106    1115903684
Name: account_id, Length: 1107, dtype: int64
2025-05-08 22:12:58,211 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:12:58,217 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:12:58,219 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:12:58,219 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:12:58,219 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'player_team', 'hero_level', 'objectives_mask_team0', 'player_kills', 'team_abandoned', 'denies', 'match_mode', 'abandoned_time_s', 'start_time', 'game_mode', 'match_id', 'net_worth', 'match_result', 'won', 'player_assists', 'match_duration_s', 'hero_id', 'last_hits', 'objectives_mask_team1', 'player_deaths'}
2025-05-08 22:12:58,219 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:12:58,233 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 1-0
2025-05-08 22:12:58,233 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:12:58,236 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1115903684
2025-05-08 22:12:58,236 [ERROR] [root.save_player_rolling_stats_to_db] roll_stats df schema mismatch:  missing={'trend_end_date', 'average_kills', 'average_assists', 'trend_date', 'average_deaths', 'win_rate', 'average_kd', 'pick_rate', 'trend_window_days', 'trend_start_date'}, extra={'player_team', 'p_win_pct_4', 'hero_level', 'objectives_mask_team0', 'player_kills', 'team_abandoned', 'p_loss_pct_4', 'denies', 'match_mode', 'abandoned_time_s', 'start_time', 'p_loss_pct_3', 'p_win_pct_5', 'game_mode', 'match_id', 'net_worth', 'match_result', 'won', 'account_id', 'p_loss_pct_6', 'player_assists', 'match_duration_s', 'p_loss_pct_5', 'last_hits', 'p_loss_pct_2', 'objectives_mask_team1', 'player_deaths', 'p_win_pct_6', 'p_win_pct_3', 'p_win_pct_2'}
2025-05-08 22:14:49,164 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:14:49,190 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:14:49,215 [INFO] [root.create_all_tables] Resulting tables: {'matches', 'player_matches', 'hero_trends', 'player_trends', 'player_hero_trends', 'player_rolling_stats'}
2025-05-08 22:14:49,216 [INFO] [root.create_all_tables] All tables created: {'player_trends', 'player_hero_trends', 'matches', 'player_matches', 'hero_trends', 'player_rolling_stats'}
2025-05-08 22:14:49,216 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:14:49,218 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:14:50,805 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746670489&max_unix_timestamp=1746756889&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:14:50,903 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:14:52,695 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746584090&max_unix_timestamp=1746670490&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:14:52,787 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:14:53,503 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746497692&max_unix_timestamp=1746584092&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:14:53,616 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:14:54,198 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746411293&max_unix_timestamp=1746497693&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:14:54,300 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:14:54,834 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746324894&max_unix_timestamp=1746411294&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:14:54,850 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data fetched
2025-05-08 22:14:54,850 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Normalizing data
2025-05-08 22:14:54,850 [INFO] [root.normalize_bulk_matches] Normalizing bulk match data
2025-05-08 22:14:54,850 [INFO] [root.normalize_bulk_matches] Processing day #0 with 241 matches
2025-05-08 22:14:54,852 [INFO] [root.normalize_bulk_matches] Processing day #1 with 168 matches
2025-05-08 22:14:54,852 [INFO] [root.normalize_bulk_matches] Processing day #2 with 191 matches
2025-05-08 22:14:54,853 [INFO] [root.normalize_bulk_matches] Processing day #3 with 188 matches
2025-05-08 22:14:54,854 [INFO] [root.normalize_bulk_matches] Processing day #4 with 179 matches
2025-05-08 22:14:54,868 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data normalized
2025-05-08 22:14:54,868 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Loading data into database
2025-05-08 22:14:54,868 [INFO] [root.save_bulk_matches_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:14:54,926 [INFO] [root.save_bulk_matches_to_db] Bulk load complete.
2025-05-08 22:14:54,926 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data loaded into database
2025-05-08 22:14:54,927 [INFO] [root.run_etl_hero_trends] starting run_etl_hero_trends ETL without critical errors.
2025-05-08 22:14:54,927 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 7 days
2025-05-08 22:14:54,927 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?7&100


2025-05-08 22:14:54,928 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:14:54,970 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?7&100 HTTP/1.1" 200 None
2025-05-08 22:14:54,970 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:14:54,971 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:14:54,971 [INFO] [root.build_hero_trends] Setting trend window: start=1747361694, end=1746756894, window_days=7
2025-05-08 22:14:54,974 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_kills', 'total_max_health', 'matches', 'players', 'total_shots_hit', 'total_shots_missed', 'total_creep_damage', 'total_neutral_damage', 'total_last_hits', 'wins', 'losses', 'total_net_worth', 'total_assists', 'total_player_damage', 'total_player_damage_taken', 'total_boss_damage', 'total_denies', 'total_deaths'}
2025-05-08 22:14:54,974 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:14:54,980 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 26-0
2025-05-08 22:14:54,980 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 30 days
2025-05-08 22:14:54,980 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?30&100


2025-05-08 22:14:54,980 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:14:55,018 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?30&100 HTTP/1.1" 200 None
2025-05-08 22:14:55,019 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:14:55,020 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:14:55,020 [INFO] [root.build_hero_trends] Setting trend window: start=1749348895, end=1746756895, window_days=30
2025-05-08 22:14:55,022 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_kills', 'total_max_health', 'matches', 'players', 'total_shots_hit', 'total_shots_missed', 'total_creep_damage', 'total_neutral_damage', 'total_last_hits', 'wins', 'losses', 'total_net_worth', 'total_assists', 'total_player_damage', 'total_player_damage_taken', 'total_boss_damage', 'total_denies', 'total_deaths'}
2025-05-08 22:14:55,022 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:14:55,027 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 52-26
2025-05-08 22:14:55,027 [INFO] [root.run_etl_hero_trends] completed 7d and 30d hero trends ETL without critical errors.
2025-05-08 22:14:55,027 [INFO] [root.run_etl_player_hero_match_trends] Starting function tests
2025-05-08 22:14:55,032 [INFO] [root.pull_trend_players_from_db] Pulled 50 players to trend
2025-05-08 22:14:55,032 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=0, account_id=1146874782) of 50
2025-05-08 22:14:55,032 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1146874782/match-history?only_stored_history=true
2025-05-08 22:14:55,033 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:14:55,648 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1146874782/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:14:55,654 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:14:55,654 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1146874782
1       1146874782
2       1146874782
3       1146874782
4       1146874782
           ...    
1058    1146874782
1059    1146874782
1060    1146874782
1061    1146874782
1062    1146874782
Name: account_id, Length: 1063, dtype: int64
2025-05-08 22:14:55,655 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8745
2025-05-08 22:14:55,655 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5944
2025-05-08 22:14:55,655 [DEBUG] [root.generate_player_performance_metrics] match_total: 1063
2025-05-08 22:14:55,656 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1146874782
1       1146874782
2       1146874782
3       1146874782
4       1146874782
           ...    
1058    1146874782
1059    1146874782
1060    1146874782
1061    1146874782
1062    1146874782
Name: account_id, Length: 1063, dtype: int64
2025-05-08 22:14:55,656 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:14:55,662 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:14:55,664 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:14:55,664 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:14:55,664 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'hero_level', 'game_mode', 'objectives_mask_team0', 'player_kills', 'net_worth', 'player_deaths', 'hero_id', 'player_assists', 'match_duration_s', 'match_result', 'start_time', 'match_mode', 'last_hits', 'abandoned_time_s', 'player_team', 'denies', 'match_id', 'objectives_mask_team1', 'team_abandoned'}
2025-05-08 22:14:55,664 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:14:55,671 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 1-0
2025-05-08 22:14:55,671 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:14:55,673 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1146874782
2025-05-08 22:14:55,673 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'hero_level', 'game_mode', 'objectives_mask_team0', 'player_kills', 'net_worth', 'player_deaths', 'hero_id', 'player_assists', 'match_duration_s', 'match_result', 'p_win_pct_6', 'match_mode', 'last_hits', 'abandoned_time_s', 'player_team', 'denies', 'p_loss_pct_6', 'objectives_mask_team1', 'team_abandoned'}
2025-05-08 22:14:55,673 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:14:55,680 [ERROR] [root.save_player_rolling_stats_to_db] Failed to load bulk match data
Traceback (most recent call last):
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 531, in save_player_rolling_stats_to_db
    with duckdb.connect(database=db.DB_PATH) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 535, in save_player_rolling_stats_to_db
    con.execute("""
duckdb.duckdb.CatalogException: Catalog Error: Table with name roll_stats does not exist!
Did you mean "df_roll_stats"?
2025-05-08 22:15:49,401 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:15:49,435 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:15:49,468 [INFO] [root.create_all_tables] Resulting tables: {'player_hero_trends', 'hero_trends', 'player_rolling_stats', 'matches', 'player_matches', 'player_trends'}
2025-05-08 22:15:49,468 [INFO] [root.create_all_tables] All tables created: {'player_hero_trends', 'player_rolling_stats', 'player_matches', 'hero_trends', 'matches', 'player_trends'}
2025-05-08 22:15:49,468 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:15:49,471 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:15:50,225 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746670549&max_unix_timestamp=1746756949&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:15:50,350 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:15:50,850 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746584150&max_unix_timestamp=1746670550&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:15:50,864 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:15:51,645 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746497750&max_unix_timestamp=1746584150&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:15:51,662 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:15:52,347 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746411351&max_unix_timestamp=1746497751&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:15:52,469 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:15:53,186 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746324952&max_unix_timestamp=1746411352&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:15:53,286 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data fetched
2025-05-08 22:15:53,286 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Normalizing data
2025-05-08 22:15:53,286 [INFO] [root.normalize_bulk_matches] Normalizing bulk match data
2025-05-08 22:15:53,286 [INFO] [root.normalize_bulk_matches] Processing day #0 with 242 matches
2025-05-08 22:15:53,288 [INFO] [root.normalize_bulk_matches] Processing day #1 with 168 matches
2025-05-08 22:15:53,288 [INFO] [root.normalize_bulk_matches] Processing day #2 with 191 matches
2025-05-08 22:15:53,289 [INFO] [root.normalize_bulk_matches] Processing day #3 with 188 matches
2025-05-08 22:15:53,290 [INFO] [root.normalize_bulk_matches] Processing day #4 with 178 matches
2025-05-08 22:15:53,304 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data normalized
2025-05-08 22:15:53,304 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Loading data into database
2025-05-08 22:15:53,304 [INFO] [root.save_bulk_matches_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:15:53,365 [INFO] [root.save_bulk_matches_to_db] Bulk load complete.
2025-05-08 22:15:53,365 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data loaded into database
2025-05-08 22:15:53,367 [INFO] [root.run_etl_hero_trends] starting run_etl_hero_trends ETL without critical errors.
2025-05-08 22:15:53,367 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 7 days
2025-05-08 22:15:53,367 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?7&100


2025-05-08 22:15:53,367 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:15:53,409 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?7&100 HTTP/1.1" 200 None
2025-05-08 22:15:53,409 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:15:53,410 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:15:53,410 [INFO] [root.build_hero_trends] Setting trend window: start=1747361753, end=1746756953, window_days=7
2025-05-08 22:15:53,413 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_neutral_damage', 'total_player_damage', 'total_last_hits', 'total_kills', 'total_net_worth', 'players', 'total_max_health', 'total_assists', 'total_player_damage_taken', 'losses', 'total_shots_missed', 'total_boss_damage', 'total_deaths', 'total_denies', 'matches', 'total_creep_damage', 'wins', 'total_shots_hit'}
2025-05-08 22:15:53,413 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:15:53,423 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 26-0
2025-05-08 22:15:53,423 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 30 days
2025-05-08 22:15:53,423 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?30&100


2025-05-08 22:15:53,424 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:15:53,479 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?30&100 HTTP/1.1" 200 None
2025-05-08 22:15:53,480 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:15:53,480 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:15:53,480 [INFO] [root.build_hero_trends] Setting trend window: start=1749348953, end=1746756953, window_days=30
2025-05-08 22:15:53,482 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_neutral_damage', 'total_player_damage', 'total_last_hits', 'total_kills', 'total_net_worth', 'players', 'total_max_health', 'total_assists', 'total_player_damage_taken', 'losses', 'total_shots_missed', 'total_boss_damage', 'total_deaths', 'total_denies', 'matches', 'total_creep_damage', 'wins', 'total_shots_hit'}
2025-05-08 22:15:53,482 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:15:53,487 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 52-26
2025-05-08 22:15:53,487 [INFO] [root.run_etl_hero_trends] completed 7d and 30d hero trends ETL without critical errors.
2025-05-08 22:15:53,487 [INFO] [root.run_etl_player_hero_match_trends] Starting function tests
2025-05-08 22:15:53,491 [INFO] [root.pull_trend_players_from_db] Pulled 50 players to trend
2025-05-08 22:15:53,492 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=0, account_id=1825438569) of 50
2025-05-08 22:15:53,492 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1825438569/match-history?only_stored_history=true
2025-05-08 22:15:53,492 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:15:53,969 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1825438569/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:15:53,971 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:15:53,971 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1825438569
1      1825438569
2      1825438569
3      1825438569
4      1825438569
          ...    
194    1825438569
195    1825438569
196    1825438569
197    1825438569
198    1825438569
Name: account_id, Length: 199, dtype: int64
2025-05-08 22:15:53,972 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1858
2025-05-08 22:15:53,972 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1276
2025-05-08 22:15:53,972 [DEBUG] [root.generate_player_performance_metrics] match_total: 199
2025-05-08 22:15:53,973 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1825438569
1      1825438569
2      1825438569
3      1825438569
4      1825438569
          ...    
194    1825438569
195    1825438569
196    1825438569
197    1825438569
198    1825438569
Name: account_id, Length: 199, dtype: int64
2025-05-08 22:15:53,973 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:15:53,978 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:15:53,980 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:15:53,980 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:15:53,980 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'last_hits', 'player_assists', 'game_mode', 'player_kills', 'denies', 'won', 'objectives_mask_team0', 'player_team', 'match_result', 'team_abandoned', 'net_worth', 'match_duration_s', 'objectives_mask_team1', 'hero_level', 'match_id', 'player_deaths', 'hero_id', 'match_mode', 'abandoned_time_s', 'start_time'}
2025-05-08 22:15:53,980 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:15:53,987 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 1-0
2025-05-08 22:15:53,987 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:15:53,989 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1825438569
2025-05-08 22:15:53,989 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'last_hits', 'player_assists', 'game_mode', 'player_kills', 'denies', 'won', 'p_loss_pct_6', 'objectives_mask_team0', 'player_team', 'match_result', 'team_abandoned', 'p_win_pct_6', 'net_worth', 'match_duration_s', 'objectives_mask_team1', 'hero_level', 'player_deaths', 'hero_id', 'match_mode', 'abandoned_time_s'}
2025-05-08 22:15:53,989 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:15:53,993 [ERROR] [root.save_player_rolling_stats_to_db] Failed to load bulk match data
Traceback (most recent call last):
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 531, in save_player_rolling_stats_to_db
    with duckdb.connect(database=db.DB_PATH) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 535, in save_player_rolling_stats_to_db
    con.execute("""
duckdb.duckdb.ConversionException: Conversion Error: Unimplemented type for cast (BIGINT -> TIMESTAMP)

LINE 8:                 account_id, match_id, start_time,
                                              ^
2025-05-08 22:20:22,424 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:20:22,450 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:20:22,474 [INFO] [root.create_all_tables] Resulting tables: {'hero_trends', 'player_rolling_stats', 'player_trends', 'player_hero_trends', 'matches', 'player_matches'}
2025-05-08 22:20:22,474 [INFO] [root.create_all_tables] All tables created: {'hero_trends', 'player_matches', 'player_hero_trends', 'matches', 'player_rolling_stats', 'player_trends'}
2025-05-08 22:20:22,474 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:20:22,476 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:20:23,134 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746670822&max_unix_timestamp=1746757222&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:20:23,254 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:20:23,948 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746584423&max_unix_timestamp=1746670823&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:20:24,031 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:20:24,747 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746498024&max_unix_timestamp=1746584424&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:20:24,827 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:20:25,548 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746411624&max_unix_timestamp=1746498024&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:20:25,632 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:20:26,286 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746325225&max_unix_timestamp=1746411625&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:20:26,386 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data fetched
2025-05-08 22:20:26,386 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Normalizing data
2025-05-08 22:20:26,386 [INFO] [root.normalize_bulk_matches] Normalizing bulk match data
2025-05-08 22:20:26,386 [INFO] [root.normalize_bulk_matches] Processing day #0 with 240 matches
2025-05-08 22:20:26,388 [INFO] [root.normalize_bulk_matches] Processing day #1 with 169 matches
2025-05-08 22:20:26,388 [INFO] [root.normalize_bulk_matches] Processing day #2 with 192 matches
2025-05-08 22:20:26,389 [INFO] [root.normalize_bulk_matches] Processing day #3 with 188 matches
2025-05-08 22:20:26,390 [INFO] [root.normalize_bulk_matches] Processing day #4 with 178 matches
2025-05-08 22:20:26,404 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data normalized
2025-05-08 22:20:26,404 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Loading data into database
2025-05-08 22:20:26,405 [INFO] [root.save_bulk_matches_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:20:26,463 [INFO] [root.save_bulk_matches_to_db] Bulk load complete.
2025-05-08 22:20:26,463 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data loaded into database
2025-05-08 22:20:26,465 [INFO] [root.run_etl_hero_trends] starting run_etl_hero_trends ETL without critical errors.
2025-05-08 22:20:26,465 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 7 days
2025-05-08 22:20:26,465 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?7&100


2025-05-08 22:20:26,465 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:20:26,811 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?7&100 HTTP/1.1" 200 None
2025-05-08 22:20:26,812 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:20:26,812 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:20:26,812 [INFO] [root.build_hero_trends] Setting trend window: start=1747362026, end=1746757226, window_days=7
2025-05-08 22:20:26,816 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_assists', 'total_denies', 'losses', 'total_kills', 'total_deaths', 'total_last_hits', 'total_player_damage', 'total_creep_damage', 'total_shots_hit', 'players', 'total_shots_missed', 'total_player_damage_taken', 'total_net_worth', 'total_max_health', 'total_neutral_damage', 'total_boss_damage', 'matches', 'wins'}
2025-05-08 22:20:26,816 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:20:26,823 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 26-0
2025-05-08 22:20:26,823 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 30 days
2025-05-08 22:20:26,823 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?30&100


2025-05-08 22:20:26,823 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:20:27,010 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?30&100 HTTP/1.1" 200 None
2025-05-08 22:20:27,011 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:20:27,012 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:20:27,012 [INFO] [root.build_hero_trends] Setting trend window: start=1749349227, end=1746757227, window_days=30
2025-05-08 22:20:27,014 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_assists', 'total_denies', 'losses', 'total_kills', 'total_deaths', 'total_last_hits', 'total_player_damage', 'total_creep_damage', 'total_shots_hit', 'players', 'total_shots_missed', 'total_player_damage_taken', 'total_net_worth', 'total_max_health', 'total_neutral_damage', 'total_boss_damage', 'matches', 'wins'}
2025-05-08 22:20:27,014 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:20:27,020 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 52-26
2025-05-08 22:20:27,020 [INFO] [root.run_etl_hero_trends] completed 7d and 30d hero trends ETL without critical errors.
2025-05-08 22:20:27,020 [INFO] [root.run_etl_player_hero_match_trends] Starting function tests
2025-05-08 22:20:27,024 [INFO] [root.pull_trend_players_from_db] Pulled 50 players to trend
2025-05-08 22:20:27,024 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=0, account_id=1115903684) of 50
2025-05-08 22:20:27,024 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1115903684/match-history?only_stored_history=true
2025-05-08 22:20:27,025 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:20:27,546 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1115903684/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:20:27,553 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:20:27,553 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1115903684
1       1115903684
2       1115903684
3       1115903684
4       1115903684
           ...    
1102    1115903684
1103    1115903684
1104    1115903684
1105    1115903684
1106    1115903684
Name: account_id, Length: 1107, dtype: int64
2025-05-08 22:20:27,554 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5740
2025-05-08 22:20:27,554 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6008
2025-05-08 22:20:27,554 [DEBUG] [root.generate_player_performance_metrics] match_total: 1107
2025-05-08 22:20:27,555 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1115903684
1       1115903684
2       1115903684
3       1115903684
4       1115903684
           ...    
1102    1115903684
1103    1115903684
1104    1115903684
1105    1115903684
1106    1115903684
Name: account_id, Length: 1107, dtype: int64
2025-05-08 22:20:27,555 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:20:27,561 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:20:27,563 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:20:27,563 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:20:27,563 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'start_time', 'player_team', 'hero_level', 'match_duration_s', 'match_id', 'won', 'denies', 'player_deaths', 'abandoned_time_s', 'objectives_mask_team1', 'player_assists', 'team_abandoned', 'match_result', 'objectives_mask_team0', 'hero_id', 'net_worth', 'last_hits', 'game_mode', 'match_mode', 'player_kills'}
2025-05-08 22:20:27,563 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:20:27,570 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 1-0
2025-05-08 22:20:27,570 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:20:27,573 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1115903684
2025-05-08 22:20:27,573 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'player_team', 'hero_level', 'match_duration_s', 'won', 'denies', 'player_deaths', 'abandoned_time_s', 'objectives_mask_team1', 'p_loss_pct_6', 'player_assists', 'team_abandoned', 'match_result', 'objectives_mask_team0', 'hero_id', 'net_worth', 'p_win_pct_6', 'last_hits', 'game_mode', 'match_mode', 'player_kills'}
2025-05-08 22:20:27,573 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:20:27,581 [ERROR] [root.save_player_rolling_stats_to_db] Failed to load bulk match data
Traceback (most recent call last):
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 532, in save_player_rolling_stats_to_db
    with duckdb.connect(database=db.DB_PATH) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 536, in save_player_rolling_stats_to_db
    con.execute("""
duckdb.duckdb.ConstraintException: Constraint Error: Violates foreign key constraint because key "account_id: 1115903684, match_id: 35456256" does not exist in the referenced table
2025-05-08 22:21:46,602 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:21:46,627 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:21:46,652 [INFO] [root.create_all_tables] Resulting tables: {'player_matches', 'hero_trends', 'player_rolling_stats', 'player_trends', 'matches', 'player_hero_trends'}
2025-05-08 22:21:46,652 [INFO] [root.create_all_tables] All tables created: {'player_matches', 'player_trends', 'player_hero_trends', 'matches', 'hero_trends', 'player_rolling_stats'}
2025-05-08 22:21:46,652 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:21:46,654 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:47,519 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746670906&max_unix_timestamp=1746757306&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:21:47,555 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:48,331 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746584507&max_unix_timestamp=1746670907&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:21:48,344 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:49,084 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746498108&max_unix_timestamp=1746584508&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:21:49,186 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:49,716 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746411709&max_unix_timestamp=1746498109&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:21:49,816 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:50,307 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746325309&max_unix_timestamp=1746411709&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:21:50,399 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data fetched
2025-05-08 22:21:50,399 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Normalizing data
2025-05-08 22:21:50,399 [INFO] [root.normalize_bulk_matches] Normalizing bulk match data
2025-05-08 22:21:50,399 [INFO] [root.normalize_bulk_matches] Processing day #0 with 240 matches
2025-05-08 22:21:50,401 [INFO] [root.normalize_bulk_matches] Processing day #1 with 169 matches
2025-05-08 22:21:50,402 [INFO] [root.normalize_bulk_matches] Processing day #2 with 192 matches
2025-05-08 22:21:50,403 [INFO] [root.normalize_bulk_matches] Processing day #3 with 188 matches
2025-05-08 22:21:50,403 [INFO] [root.normalize_bulk_matches] Processing day #4 with 178 matches
2025-05-08 22:21:50,417 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data normalized
2025-05-08 22:21:50,417 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Loading data into database
2025-05-08 22:21:50,417 [INFO] [root.save_bulk_matches_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:50,478 [INFO] [root.save_bulk_matches_to_db] Bulk load complete.
2025-05-08 22:21:50,478 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data loaded into database
2025-05-08 22:21:50,481 [INFO] [root.run_etl_hero_trends] starting run_etl_hero_trends ETL without critical errors.
2025-05-08 22:21:50,481 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 7 days
2025-05-08 22:21:50,481 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?7&100


2025-05-08 22:21:50,482 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:50,526 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?7&100 HTTP/1.1" 200 None
2025-05-08 22:21:50,526 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:21:50,527 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:21:50,527 [INFO] [root.build_hero_trends] Setting trend window: start=1747362110, end=1746757310, window_days=7
2025-05-08 22:21:50,530 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_net_worth', 'total_player_damage', 'players', 'wins', 'total_creep_damage', 'total_shots_hit', 'losses', 'total_neutral_damage', 'total_max_health', 'total_assists', 'total_kills', 'matches', 'total_denies', 'total_player_damage_taken', 'total_shots_missed', 'total_deaths', 'total_boss_damage', 'total_last_hits'}
2025-05-08 22:21:50,530 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:50,537 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 26-0
2025-05-08 22:21:50,537 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 30 days
2025-05-08 22:21:50,537 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?30&100


2025-05-08 22:21:50,537 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:50,582 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?30&100 HTTP/1.1" 200 None
2025-05-08 22:21:50,582 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:21:50,583 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:21:50,583 [INFO] [root.build_hero_trends] Setting trend window: start=1749349310, end=1746757310, window_days=30
2025-05-08 22:21:50,585 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_net_worth', 'total_player_damage', 'players', 'wins', 'total_creep_damage', 'total_shots_hit', 'losses', 'total_neutral_damage', 'total_max_health', 'total_assists', 'total_kills', 'matches', 'total_denies', 'total_player_damage_taken', 'total_shots_missed', 'total_deaths', 'total_boss_damage', 'total_last_hits'}
2025-05-08 22:21:50,585 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:50,595 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 52-26
2025-05-08 22:21:50,595 [INFO] [root.run_etl_hero_trends] completed 7d and 30d hero trends ETL without critical errors.
2025-05-08 22:21:50,595 [INFO] [root.run_etl_player_hero_match_trends] Starting function tests
2025-05-08 22:21:50,599 [INFO] [root.pull_trend_players_from_db] Pulled 50 players to trend
2025-05-08 22:21:50,599 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=0, account_id=193143480) of 50
2025-05-08 22:21:50,599 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/193143480/match-history?only_stored_history=true
2025-05-08 22:21:50,600 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:51,071 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/193143480/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:51,076 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:51,077 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      193143480
1      193143480
2      193143480
3      193143480
4      193143480
         ...    
857    193143480
858    193143480
859    193143480
860    193143480
861    193143480
Name: account_id, Length: 862, dtype: int64
2025-05-08 22:21:51,078 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7875
2025-05-08 22:21:51,078 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5856
2025-05-08 22:21:51,078 [DEBUG] [root.generate_player_performance_metrics] match_total: 862
2025-05-08 22:21:51,079 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      193143480
1      193143480
2      193143480
3      193143480
4      193143480
         ...    
857    193143480
858    193143480
859    193143480
860    193143480
861    193143480
Name: account_id, Length: 862, dtype: int64
2025-05-08 22:21:51,079 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:51,085 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:51,087 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:51,087 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:51,087 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:51,087 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:51,094 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 1-0
2025-05-08 22:21:51,094 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:51,096 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 193143480
2025-05-08 22:21:51,096 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:51,096 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:51,104 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 862-0
2025-05-08 22:21:51,104 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=1, account_id=1889172005) of 50
2025-05-08 22:21:51,104 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1889172005/match-history?only_stored_history=true
2025-05-08 22:21:51,105 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:51,504 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1889172005/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:51,505 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:51,506 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1889172005
1     1889172005
2     1889172005
3     1889172005
4     1889172005
5     1889172005
6     1889172005
7     1889172005
8     1889172005
9     1889172005
10    1889172005
11    1889172005
12    1889172005
13    1889172005
14    1889172005
15    1889172005
16    1889172005
17    1889172005
18    1889172005
19    1889172005
20    1889172005
21    1889172005
22    1889172005
23    1889172005
24    1889172005
25    1889172005
26    1889172005
27    1889172005
28    1889172005
29    1889172005
30    1889172005
31    1889172005
32    1889172005
33    1889172005
34    1889172005
35    1889172005
36    1889172005
37    1889172005
38    1889172005
39    1889172005
40    1889172005
41    1889172005
42    1889172005
43    1889172005
44    1889172005
45    1889172005
46    1889172005
47    1889172005
48    1889172005
49    1889172005
50    1889172005
51    1889172005
52    1889172005
53    1889172005
54    1889172005
55    1889172005
56    1889172005
Name: account_id, dtype: int64
2025-05-08 22:21:51,506 [DEBUG] [root.generate_player_performance_metrics] total_kills: 845
2025-05-08 22:21:51,506 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 381
2025-05-08 22:21:51,506 [DEBUG] [root.generate_player_performance_metrics] match_total: 57
2025-05-08 22:21:51,507 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1889172005
1     1889172005
2     1889172005
3     1889172005
4     1889172005
5     1889172005
6     1889172005
7     1889172005
8     1889172005
9     1889172005
10    1889172005
11    1889172005
12    1889172005
13    1889172005
14    1889172005
15    1889172005
16    1889172005
17    1889172005
18    1889172005
19    1889172005
20    1889172005
21    1889172005
22    1889172005
23    1889172005
24    1889172005
25    1889172005
26    1889172005
27    1889172005
28    1889172005
29    1889172005
30    1889172005
31    1889172005
32    1889172005
33    1889172005
34    1889172005
35    1889172005
36    1889172005
37    1889172005
38    1889172005
39    1889172005
40    1889172005
41    1889172005
42    1889172005
43    1889172005
44    1889172005
45    1889172005
46    1889172005
47    1889172005
48    1889172005
49    1889172005
50    1889172005
51    1889172005
52    1889172005
53    1889172005
54    1889172005
55    1889172005
56    1889172005
Name: account_id, dtype: int64
2025-05-08 22:21:51,507 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:51,512 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:51,513 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:51,513 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:51,513 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:51,513 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:51,520 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 2-1
2025-05-08 22:21:51,520 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:51,523 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1889172005
2025-05-08 22:21:51,523 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:51,524 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:51,529 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 919-862
2025-05-08 22:21:51,529 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=2, account_id=89528902) of 50
2025-05-08 22:21:51,529 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/89528902/match-history?only_stored_history=true
2025-05-08 22:21:51,529 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:51,829 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/89528902/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:51,863 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:51,864 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       89528902
1       89528902
2       89528902
3       89528902
4       89528902
          ...   
1148    89528902
1149    89528902
1150    89528902
1151    89528902
1152    89528902
Name: account_id, Length: 1153, dtype: int64
2025-05-08 22:21:51,864 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11784
2025-05-08 22:21:51,864 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11696
2025-05-08 22:21:51,864 [DEBUG] [root.generate_player_performance_metrics] match_total: 1153
2025-05-08 22:21:51,865 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       89528902
1       89528902
2       89528902
3       89528902
4       89528902
          ...   
1148    89528902
1149    89528902
1150    89528902
1151    89528902
1152    89528902
Name: account_id, Length: 1153, dtype: int64
2025-05-08 22:21:51,865 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:51,870 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:51,872 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:51,872 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:51,872 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:51,872 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:51,881 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 3-2
2025-05-08 22:21:51,881 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:51,883 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 89528902
2025-05-08 22:21:51,883 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:51,883 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:51,893 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 2072-919
2025-05-08 22:21:51,893 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=3, account_id=1676299122) of 50
2025-05-08 22:21:51,893 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1676299122/match-history?only_stored_history=true
2025-05-08 22:21:51,894 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:52,396 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1676299122/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:52,497 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:52,497 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1676299122
1       1676299122
2       1676299122
3       1676299122
4       1676299122
           ...    
1991    1676299122
1992    1676299122
1993    1676299122
1994    1676299122
1995    1676299122
Name: account_id, Length: 1996, dtype: int64
2025-05-08 22:21:52,498 [DEBUG] [root.generate_player_performance_metrics] total_kills: 20246
2025-05-08 22:21:52,498 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 13332
2025-05-08 22:21:52,498 [DEBUG] [root.generate_player_performance_metrics] match_total: 1996
2025-05-08 22:21:52,499 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1676299122
1       1676299122
2       1676299122
3       1676299122
4       1676299122
           ...    
1991    1676299122
1992    1676299122
1993    1676299122
1994    1676299122
1995    1676299122
Name: account_id, Length: 1996, dtype: int64
2025-05-08 22:21:52,499 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:52,504 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:52,505 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:52,505 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:52,506 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:52,506 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:52,514 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 4-3
2025-05-08 22:21:52,514 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:52,516 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1676299122
2025-05-08 22:21:52,517 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:52,517 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:52,535 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 4068-2072
2025-05-08 22:21:52,535 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=4, account_id=1090737694) of 50
2025-05-08 22:21:52,535 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1090737694/match-history?only_stored_history=true
2025-05-08 22:21:52,535 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:52,828 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1090737694/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:52,847 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:52,848 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1090737694
1       1090737694
2       1090737694
3       1090737694
4       1090737694
           ...    
1770    1090737694
1771    1090737694
1772    1090737694
1773    1090737694
1774    1090737694
Name: account_id, Length: 1775, dtype: int64
2025-05-08 22:21:52,848 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14313
2025-05-08 22:21:52,848 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 13687
2025-05-08 22:21:52,848 [DEBUG] [root.generate_player_performance_metrics] match_total: 1775
2025-05-08 22:21:52,849 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1090737694
1       1090737694
2       1090737694
3       1090737694
4       1090737694
           ...    
1770    1090737694
1771    1090737694
1772    1090737694
1773    1090737694
1774    1090737694
Name: account_id, Length: 1775, dtype: int64
2025-05-08 22:21:52,849 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:52,855 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:52,856 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:52,856 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:52,856 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:52,856 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:52,866 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 5-4
2025-05-08 22:21:52,866 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:52,868 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1090737694
2025-05-08 22:21:52,869 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:52,869 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:52,884 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 5843-4068
2025-05-08 22:21:52,884 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=5, account_id=865111006) of 50
2025-05-08 22:21:52,884 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/865111006/match-history?only_stored_history=true
2025-05-08 22:21:52,884 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:53,354 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/865111006/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:53,358 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:53,359 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      865111006
1      865111006
2      865111006
3      865111006
4      865111006
         ...    
742    865111006
743    865111006
744    865111006
745    865111006
746    865111006
Name: account_id, Length: 747, dtype: int64
2025-05-08 22:21:53,359 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5361
2025-05-08 22:21:53,360 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3861
2025-05-08 22:21:53,360 [DEBUG] [root.generate_player_performance_metrics] match_total: 747
2025-05-08 22:21:53,361 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      865111006
1      865111006
2      865111006
3      865111006
4      865111006
         ...    
742    865111006
743    865111006
744    865111006
745    865111006
746    865111006
Name: account_id, Length: 747, dtype: int64
2025-05-08 22:21:53,361 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:53,365 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:53,366 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:53,366 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:53,366 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:53,366 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:53,374 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 6-5
2025-05-08 22:21:53,374 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:53,376 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 865111006
2025-05-08 22:21:53,376 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:53,376 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:53,385 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 6590-5843
2025-05-08 22:21:53,385 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=6, account_id=1866929202) of 50
2025-05-08 22:21:53,385 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1866929202/match-history?only_stored_history=true
2025-05-08 22:21:53,385 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:53,879 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1866929202/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:53,882 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:53,883 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1866929202
1      1866929202
2      1866929202
3      1866929202
4      1866929202
          ...    
470    1866929202
471    1866929202
472    1866929202
473    1866929202
474    1866929202
Name: account_id, Length: 475, dtype: int64
2025-05-08 22:21:53,883 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3194
2025-05-08 22:21:53,883 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2290
2025-05-08 22:21:53,883 [DEBUG] [root.generate_player_performance_metrics] match_total: 475
2025-05-08 22:21:53,884 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1866929202
1      1866929202
2      1866929202
3      1866929202
4      1866929202
          ...    
470    1866929202
471    1866929202
472    1866929202
473    1866929202
474    1866929202
Name: account_id, Length: 475, dtype: int64
2025-05-08 22:21:53,884 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:53,889 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:53,890 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:53,890 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:53,890 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:53,890 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:53,896 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 7-6
2025-05-08 22:21:53,896 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:53,898 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1866929202
2025-05-08 22:21:53,898 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:53,898 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:53,905 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 7065-6590
2025-05-08 22:21:53,905 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=7, account_id=1446007996) of 50
2025-05-08 22:21:53,906 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1446007996/match-history?only_stored_history=true
2025-05-08 22:21:53,906 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:54,134 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1446007996/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:54,135 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:54,136 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1446007996
1      1446007996
2      1446007996
3      1446007996
4      1446007996
          ...    
137    1446007996
138    1446007996
139    1446007996
140    1446007996
141    1446007996
Name: account_id, Length: 142, dtype: int64
2025-05-08 22:21:54,136 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2187
2025-05-08 22:21:54,136 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 611
2025-05-08 22:21:54,136 [DEBUG] [root.generate_player_performance_metrics] match_total: 142
2025-05-08 22:21:54,137 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1446007996
1      1446007996
2      1446007996
3      1446007996
4      1446007996
          ...    
137    1446007996
138    1446007996
139    1446007996
140    1446007996
141    1446007996
Name: account_id, Length: 142, dtype: int64
2025-05-08 22:21:54,137 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:54,141 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:54,142 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:54,142 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:54,142 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:54,143 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:54,150 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 8-7
2025-05-08 22:21:54,150 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:54,151 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1446007996
2025-05-08 22:21:54,152 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:54,152 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:54,157 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 7207-7065
2025-05-08 22:21:54,157 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=8, account_id=173907991) of 50
2025-05-08 22:21:54,157 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/173907991/match-history?only_stored_history=true
2025-05-08 22:21:54,158 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:54,606 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/173907991/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:54,626 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:54,626 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      173907991
1      173907991
2      173907991
3      173907991
4      173907991
         ...    
741    173907991
742    173907991
743    173907991
744    173907991
745    173907991
Name: account_id, Length: 746, dtype: int64
2025-05-08 22:21:54,627 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6114
2025-05-08 22:21:54,627 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4124
2025-05-08 22:21:54,627 [DEBUG] [root.generate_player_performance_metrics] match_total: 746
2025-05-08 22:21:54,628 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      173907991
1      173907991
2      173907991
3      173907991
4      173907991
         ...    
741    173907991
742    173907991
743    173907991
744    173907991
745    173907991
Name: account_id, Length: 746, dtype: int64
2025-05-08 22:21:54,628 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:54,632 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:54,633 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:54,633 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:54,633 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:54,633 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:54,640 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 9-8
2025-05-08 22:21:54,640 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:54,643 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 173907991
2025-05-08 22:21:54,644 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:54,644 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:54,653 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 7953-7207
2025-05-08 22:21:54,653 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=9, account_id=55126821) of 50
2025-05-08 22:21:54,653 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/55126821/match-history?only_stored_history=true
2025-05-08 22:21:54,653 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:55,156 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/55126821/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:55,162 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:55,162 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      55126821
1      55126821
2      55126821
3      55126821
4      55126821
         ...   
865    55126821
866    55126821
867    55126821
868    55126821
869    55126821
Name: account_id, Length: 870, dtype: int64
2025-05-08 22:21:55,162 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6794
2025-05-08 22:21:55,162 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5728
2025-05-08 22:21:55,162 [DEBUG] [root.generate_player_performance_metrics] match_total: 870
2025-05-08 22:21:55,163 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      55126821
1      55126821
2      55126821
3      55126821
4      55126821
         ...   
865    55126821
866    55126821
867    55126821
868    55126821
869    55126821
Name: account_id, Length: 870, dtype: int64
2025-05-08 22:21:55,164 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:55,167 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:55,170 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:55,170 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:55,170 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:55,170 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:55,176 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 10-9
2025-05-08 22:21:55,176 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:55,178 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 55126821
2025-05-08 22:21:55,178 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:55,178 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:55,188 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 8823-7953
2025-05-08 22:21:55,188 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=10, account_id=1837991471) of 50
2025-05-08 22:21:55,188 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1837991471/match-history?only_stored_history=true
2025-05-08 22:21:55,188 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:55,565 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1837991471/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:55,569 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:55,570 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1837991471
1      1837991471
2      1837991471
3      1837991471
4      1837991471
          ...    
710    1837991471
711    1837991471
712    1837991471
713    1837991471
714    1837991471
Name: account_id, Length: 715, dtype: int64
2025-05-08 22:21:55,570 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7593
2025-05-08 22:21:55,570 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3843
2025-05-08 22:21:55,570 [DEBUG] [root.generate_player_performance_metrics] match_total: 715
2025-05-08 22:21:55,571 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1837991471
1      1837991471
2      1837991471
3      1837991471
4      1837991471
          ...    
710    1837991471
711    1837991471
712    1837991471
713    1837991471
714    1837991471
Name: account_id, Length: 715, dtype: int64
2025-05-08 22:21:55,571 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:55,576 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:55,577 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:55,577 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:55,577 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:55,577 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:55,584 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 11-10
2025-05-08 22:21:55,584 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:55,586 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1837991471
2025-05-08 22:21:55,586 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:55,586 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:55,594 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 9538-8823
2025-05-08 22:21:55,594 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=11, account_id=1869783455) of 50
2025-05-08 22:21:55,594 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1869783455/match-history?only_stored_history=true
2025-05-08 22:21:55,594 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:55,995 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1869783455/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:55,997 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:55,998 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1869783455
1      1869783455
2      1869783455
3      1869783455
4      1869783455
          ...    
235    1869783455
236    1869783455
237    1869783455
238    1869783455
239    1869783455
Name: account_id, Length: 240, dtype: int64
2025-05-08 22:21:55,998 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2401
2025-05-08 22:21:55,998 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1227
2025-05-08 22:21:55,998 [DEBUG] [root.generate_player_performance_metrics] match_total: 240
2025-05-08 22:21:55,999 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1869783455
1      1869783455
2      1869783455
3      1869783455
4      1869783455
          ...    
235    1869783455
236    1869783455
237    1869783455
238    1869783455
239    1869783455
Name: account_id, Length: 240, dtype: int64
2025-05-08 22:21:55,999 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:56,003 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:56,005 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:56,005 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:56,005 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:56,005 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:56,012 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 12-11
2025-05-08 22:21:56,012 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:56,014 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1869783455
2025-05-08 22:21:56,014 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:56,015 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:56,021 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 9778-9538
2025-05-08 22:21:56,021 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=12, account_id=442403321) of 50
2025-05-08 22:21:56,021 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/442403321/match-history?only_stored_history=true
2025-05-08 22:21:56,021 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:56,460 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/442403321/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:56,464 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:56,465 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      442403321
1      442403321
2      442403321
3      442403321
4      442403321
         ...    
569    442403321
570    442403321
571    442403321
572    442403321
573    442403321
Name: account_id, Length: 574, dtype: int64
2025-05-08 22:21:56,465 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5567
2025-05-08 22:21:56,465 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2832
2025-05-08 22:21:56,465 [DEBUG] [root.generate_player_performance_metrics] match_total: 574
2025-05-08 22:21:56,466 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      442403321
1      442403321
2      442403321
3      442403321
4      442403321
         ...    
569    442403321
570    442403321
571    442403321
572    442403321
573    442403321
Name: account_id, Length: 574, dtype: int64
2025-05-08 22:21:56,466 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:56,471 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:56,472 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:56,472 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:56,472 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:56,472 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:56,479 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 13-12
2025-05-08 22:21:56,479 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:56,482 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 442403321
2025-05-08 22:21:56,482 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:56,482 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:56,490 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 10352-9778
2025-05-08 22:21:56,490 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=13, account_id=866626250) of 50
2025-05-08 22:21:56,490 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/866626250/match-history?only_stored_history=true
2025-05-08 22:21:56,490 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:56,936 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/866626250/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:56,949 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:56,949 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      866626250
1      866626250
2      866626250
3      866626250
4      866626250
         ...    
580    866626250
581    866626250
582    866626250
583    866626250
584    866626250
Name: account_id, Length: 585, dtype: int64
2025-05-08 22:21:56,950 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4035
2025-05-08 22:21:56,950 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3586
2025-05-08 22:21:56,950 [DEBUG] [root.generate_player_performance_metrics] match_total: 585
2025-05-08 22:21:56,951 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      866626250
1      866626250
2      866626250
3      866626250
4      866626250
         ...    
580    866626250
581    866626250
582    866626250
583    866626250
584    866626250
Name: account_id, Length: 585, dtype: int64
2025-05-08 22:21:56,951 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:56,955 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:56,956 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:56,957 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:56,957 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:56,957 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:56,965 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 14-13
2025-05-08 22:21:56,965 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:56,967 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 866626250
2025-05-08 22:21:56,967 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:56,967 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:56,975 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 10937-10352
2025-05-08 22:21:56,975 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=14, account_id=1519487905) of 50
2025-05-08 22:21:56,975 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1519487905/match-history?only_stored_history=true
2025-05-08 22:21:56,976 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:57,237 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1519487905/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:57,252 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:57,253 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1519487905
1      1519487905
2      1519487905
3      1519487905
4      1519487905
          ...    
476    1519487905
477    1519487905
478    1519487905
479    1519487905
480    1519487905
Name: account_id, Length: 481, dtype: int64
2025-05-08 22:21:57,253 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4644
2025-05-08 22:21:57,253 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3766
2025-05-08 22:21:57,253 [DEBUG] [root.generate_player_performance_metrics] match_total: 481
2025-05-08 22:21:57,254 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1519487905
1      1519487905
2      1519487905
3      1519487905
4      1519487905
          ...    
476    1519487905
477    1519487905
478    1519487905
479    1519487905
480    1519487905
Name: account_id, Length: 481, dtype: int64
2025-05-08 22:21:57,254 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:57,259 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:57,260 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:57,260 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:57,260 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:57,260 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:57,267 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 15-14
2025-05-08 22:21:57,267 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:57,269 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1519487905
2025-05-08 22:21:57,269 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:57,269 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:57,277 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 11418-10937
2025-05-08 22:21:57,277 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=15, account_id=50746830) of 50
2025-05-08 22:21:57,277 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/50746830/match-history?only_stored_history=true
2025-05-08 22:21:57,277 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:57,730 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/50746830/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:57,805 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:57,806 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       50746830
1       50746830
2       50746830
3       50746830
4       50746830
          ...   
1264    50746830
1265    50746830
1266    50746830
1267    50746830
1268    50746830
Name: account_id, Length: 1269, dtype: int64
2025-05-08 22:21:57,806 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9641
2025-05-08 22:21:57,806 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9098
2025-05-08 22:21:57,806 [DEBUG] [root.generate_player_performance_metrics] match_total: 1269
2025-05-08 22:21:57,807 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       50746830
1       50746830
2       50746830
3       50746830
4       50746830
          ...   
1264    50746830
1265    50746830
1266    50746830
1267    50746830
1268    50746830
Name: account_id, Length: 1269, dtype: int64
2025-05-08 22:21:57,807 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:57,813 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:57,814 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:57,815 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:57,815 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:57,815 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:57,822 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 16-15
2025-05-08 22:21:57,822 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:57,824 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 50746830
2025-05-08 22:21:57,825 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:57,825 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:57,836 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 12687-11418
2025-05-08 22:21:57,836 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=16, account_id=904667162) of 50
2025-05-08 22:21:57,836 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/904667162/match-history?only_stored_history=true
2025-05-08 22:21:57,837 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:58,355 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/904667162/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:58,437 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:58,438 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       904667162
1       904667162
2       904667162
3       904667162
4       904667162
          ...    
1518    904667162
1519    904667162
1520    904667162
1521    904667162
1522    904667162
Name: account_id, Length: 1523, dtype: int64
2025-05-08 22:21:58,438 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12081
2025-05-08 22:21:58,438 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8474
2025-05-08 22:21:58,438 [DEBUG] [root.generate_player_performance_metrics] match_total: 1523
2025-05-08 22:21:58,439 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       904667162
1       904667162
2       904667162
3       904667162
4       904667162
          ...    
1518    904667162
1519    904667162
1520    904667162
1521    904667162
1522    904667162
Name: account_id, Length: 1523, dtype: int64
2025-05-08 22:21:58,439 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:58,444 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:58,445 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:58,445 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:58,445 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:58,445 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:58,454 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 17-16
2025-05-08 22:21:58,454 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:58,456 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 904667162
2025-05-08 22:21:58,456 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:58,457 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:58,469 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 14210-12687
2025-05-08 22:21:58,469 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=17, account_id=34561399) of 50
2025-05-08 22:21:58,469 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/34561399/match-history?only_stored_history=true
2025-05-08 22:21:58,469 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:58,952 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/34561399/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:58,958 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:58,959 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       34561399
1       34561399
2       34561399
3       34561399
4       34561399
          ...   
1011    34561399
1012    34561399
1013    34561399
1014    34561399
1015    34561399
Name: account_id, Length: 1016, dtype: int64
2025-05-08 22:21:58,959 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7422
2025-05-08 22:21:58,959 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6910
2025-05-08 22:21:58,959 [DEBUG] [root.generate_player_performance_metrics] match_total: 1016
2025-05-08 22:21:58,960 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       34561399
1       34561399
2       34561399
3       34561399
4       34561399
          ...   
1011    34561399
1012    34561399
1013    34561399
1014    34561399
1015    34561399
Name: account_id, Length: 1016, dtype: int64
2025-05-08 22:21:58,960 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:58,965 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:58,966 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:58,966 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:58,966 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:58,966 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:58,973 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 18-17
2025-05-08 22:21:58,973 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:58,975 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 34561399
2025-05-08 22:21:58,976 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:58,976 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:58,984 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 15226-14210
2025-05-08 22:21:58,986 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=18, account_id=343111136) of 50
2025-05-08 22:21:58,986 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/343111136/match-history?only_stored_history=true
2025-05-08 22:21:58,986 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:59,418 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/343111136/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:59,485 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:59,486 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       343111136
1       343111136
2       343111136
3       343111136
4       343111136
          ...    
1046    343111136
1047    343111136
1048    343111136
1049    343111136
1050    343111136
Name: account_id, Length: 1051, dtype: int64
2025-05-08 22:21:59,486 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11353
2025-05-08 22:21:59,486 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8472
2025-05-08 22:21:59,486 [DEBUG] [root.generate_player_performance_metrics] match_total: 1051
2025-05-08 22:21:59,487 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       343111136
1       343111136
2       343111136
3       343111136
4       343111136
          ...    
1046    343111136
1047    343111136
1048    343111136
1049    343111136
1050    343111136
Name: account_id, Length: 1051, dtype: int64
2025-05-08 22:21:59,487 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:59,492 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:59,493 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:59,493 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:59,493 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:59,493 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:59,502 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 19-18
2025-05-08 22:21:59,502 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:59,505 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 343111136
2025-05-08 22:21:59,505 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:59,505 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:59,514 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 16277-15226
2025-05-08 22:21:59,514 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=19, account_id=1314666446) of 50
2025-05-08 22:21:59,514 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1314666446/match-history?only_stored_history=true
2025-05-08 22:21:59,515 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:21:59,964 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1314666446/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:21:59,966 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:21:59,966 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1314666446
1      1314666446
2      1314666446
3      1314666446
4      1314666446
          ...    
240    1314666446
241    1314666446
242    1314666446
243    1314666446
244    1314666446
Name: account_id, Length: 245, dtype: int64
2025-05-08 22:21:59,966 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3148
2025-05-08 22:21:59,967 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 914
2025-05-08 22:21:59,967 [DEBUG] [root.generate_player_performance_metrics] match_total: 245
2025-05-08 22:21:59,967 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1314666446
1      1314666446
2      1314666446
3      1314666446
4      1314666446
          ...    
240    1314666446
241    1314666446
242    1314666446
243    1314666446
244    1314666446
Name: account_id, Length: 245, dtype: int64
2025-05-08 22:21:59,967 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:21:59,972 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:21:59,973 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:59,973 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:21:59,973 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:59,973 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:59,982 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 20-19
2025-05-08 22:21:59,982 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:21:59,984 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1314666446
2025-05-08 22:21:59,984 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:21:59,984 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:21:59,992 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 16522-16277
2025-05-08 22:21:59,992 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=20, account_id=409050595) of 50
2025-05-08 22:21:59,992 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/409050595/match-history?only_stored_history=true
2025-05-08 22:21:59,993 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:00,551 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/409050595/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:00,644 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:00,645 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       409050595
1       409050595
2       409050595
3       409050595
4       409050595
          ...    
2163    409050595
2164    409050595
2165    409050595
2166    409050595
2167    409050595
Name: account_id, Length: 2168, dtype: int64
2025-05-08 22:22:00,645 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14209
2025-05-08 22:22:00,645 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11209
2025-05-08 22:22:00,645 [DEBUG] [root.generate_player_performance_metrics] match_total: 2168
2025-05-08 22:22:00,646 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       409050595
1       409050595
2       409050595
3       409050595
4       409050595
          ...    
2163    409050595
2164    409050595
2165    409050595
2166    409050595
2167    409050595
Name: account_id, Length: 2168, dtype: int64
2025-05-08 22:22:00,646 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:00,652 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:00,653 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:00,653 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:00,653 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:00,653 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:00,661 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 21-20
2025-05-08 22:22:00,661 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:00,663 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 409050595
2025-05-08 22:22:00,664 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:00,664 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:00,681 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 18690-16522
2025-05-08 22:22:00,681 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=21, account_id=395848978) of 50
2025-05-08 22:22:00,681 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/395848978/match-history?only_stored_history=true
2025-05-08 22:22:00,682 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:00,989 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/395848978/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:00,992 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:00,993 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      395848978
1      395848978
2      395848978
3      395848978
4      395848978
         ...    
513    395848978
514    395848978
515    395848978
516    395848978
517    395848978
Name: account_id, Length: 518, dtype: int64
2025-05-08 22:22:00,993 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4711
2025-05-08 22:22:00,993 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3057
2025-05-08 22:22:00,993 [DEBUG] [root.generate_player_performance_metrics] match_total: 518
2025-05-08 22:22:00,994 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      395848978
1      395848978
2      395848978
3      395848978
4      395848978
         ...    
513    395848978
514    395848978
515    395848978
516    395848978
517    395848978
Name: account_id, Length: 518, dtype: int64
2025-05-08 22:22:00,994 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:00,999 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:01,000 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:01,000 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:01,000 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:01,000 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:01,008 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 22-21
2025-05-08 22:22:01,008 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:01,010 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 395848978
2025-05-08 22:22:01,010 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:01,010 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:01,017 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 19208-18690
2025-05-08 22:22:01,017 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=22, account_id=1873906862) of 50
2025-05-08 22:22:01,017 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1873906862/match-history?only_stored_history=true
2025-05-08 22:22:01,018 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:01,245 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1873906862/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:01,246 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:01,247 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1873906862
1      1873906862
2      1873906862
3      1873906862
4      1873906862
          ...    
118    1873906862
119    1873906862
120    1873906862
121    1873906862
122    1873906862
Name: account_id, Length: 123, dtype: int64
2025-05-08 22:22:01,247 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1317
2025-05-08 22:22:01,247 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 749
2025-05-08 22:22:01,247 [DEBUG] [root.generate_player_performance_metrics] match_total: 123
2025-05-08 22:22:01,248 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1873906862
1      1873906862
2      1873906862
3      1873906862
4      1873906862
          ...    
118    1873906862
119    1873906862
120    1873906862
121    1873906862
122    1873906862
Name: account_id, Length: 123, dtype: int64
2025-05-08 22:22:01,248 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:01,253 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:01,254 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:01,254 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:01,254 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:01,254 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:01,261 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 23-22
2025-05-08 22:22:01,261 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:01,263 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1873906862
2025-05-08 22:22:01,264 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:01,264 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:01,269 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 19331-19208
2025-05-08 22:22:01,269 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=23, account_id=1826179440) of 50
2025-05-08 22:22:01,269 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1826179440/match-history?only_stored_history=true
2025-05-08 22:22:01,270 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:01,769 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1826179440/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:01,774 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:01,774 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1826179440
1      1826179440
2      1826179440
3      1826179440
4      1826179440
          ...    
653    1826179440
654    1826179440
655    1826179440
656    1826179440
657    1826179440
Name: account_id, Length: 658, dtype: int64
2025-05-08 22:22:01,775 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6867
2025-05-08 22:22:01,775 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5800
2025-05-08 22:22:01,775 [DEBUG] [root.generate_player_performance_metrics] match_total: 658
2025-05-08 22:22:01,776 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1826179440
1      1826179440
2      1826179440
3      1826179440
4      1826179440
          ...    
653    1826179440
654    1826179440
655    1826179440
656    1826179440
657    1826179440
Name: account_id, Length: 658, dtype: int64
2025-05-08 22:22:01,776 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:01,780 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:01,781 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:01,781 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:01,781 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:01,781 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:01,788 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 24-23
2025-05-08 22:22:01,788 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:01,791 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1826179440
2025-05-08 22:22:01,791 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:01,791 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:01,798 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 19989-19331
2025-05-08 22:22:01,798 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=24, account_id=1201602714) of 50
2025-05-08 22:22:01,798 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1201602714/match-history?only_stored_history=true
2025-05-08 22:22:01,799 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:02,090 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1201602714/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:02,100 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:02,100 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1201602714
1      1201602714
2      1201602714
3      1201602714
4      1201602714
          ...    
788    1201602714
789    1201602714
790    1201602714
791    1201602714
792    1201602714
Name: account_id, Length: 793, dtype: int64
2025-05-08 22:22:02,101 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8405
2025-05-08 22:22:02,101 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5661
2025-05-08 22:22:02,101 [DEBUG] [root.generate_player_performance_metrics] match_total: 793
2025-05-08 22:22:02,102 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1201602714
1      1201602714
2      1201602714
3      1201602714
4      1201602714
          ...    
788    1201602714
789    1201602714
790    1201602714
791    1201602714
792    1201602714
Name: account_id, Length: 793, dtype: int64
2025-05-08 22:22:02,102 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:02,106 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:02,107 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:02,107 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:02,108 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:02,108 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:02,115 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 25-24
2025-05-08 22:22:02,115 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:02,117 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1201602714
2025-05-08 22:22:02,118 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:02,118 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:02,125 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 20782-19989
2025-05-08 22:22:02,125 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=25, account_id=1475821079) of 50
2025-05-08 22:22:02,125 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1475821079/match-history?only_stored_history=true
2025-05-08 22:22:02,125 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:02,572 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1475821079/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:02,692 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:02,692 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1475821079
1       1475821079
2       1475821079
3       1475821079
4       1475821079
           ...    
1571    1475821079
1572    1475821079
1573    1475821079
1574    1475821079
1575    1475821079
Name: account_id, Length: 1576, dtype: int64
2025-05-08 22:22:02,693 [DEBUG] [root.generate_player_performance_metrics] total_kills: 15325
2025-05-08 22:22:02,693 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9186
2025-05-08 22:22:02,693 [DEBUG] [root.generate_player_performance_metrics] match_total: 1576
2025-05-08 22:22:02,694 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1475821079
1       1475821079
2       1475821079
3       1475821079
4       1475821079
           ...    
1571    1475821079
1572    1475821079
1573    1475821079
1574    1475821079
1575    1475821079
Name: account_id, Length: 1576, dtype: int64
2025-05-08 22:22:02,694 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:02,699 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:02,700 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:02,700 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:02,700 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:02,700 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:02,709 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 26-25
2025-05-08 22:22:02,709 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:02,711 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1475821079
2025-05-08 22:22:02,711 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:02,711 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:02,724 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 22358-20782
2025-05-08 22:22:02,724 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=26, account_id=1144960447) of 50
2025-05-08 22:22:02,724 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1144960447/match-history?only_stored_history=true
2025-05-08 22:22:02,724 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:03,251 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1144960447/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:03,257 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:03,258 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1144960447
1       1144960447
2       1144960447
3       1144960447
4       1144960447
           ...    
1027    1144960447
1028    1144960447
1029    1144960447
1030    1144960447
1031    1144960447
Name: account_id, Length: 1032, dtype: int64
2025-05-08 22:22:03,258 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8896
2025-05-08 22:22:03,258 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4602
2025-05-08 22:22:03,258 [DEBUG] [root.generate_player_performance_metrics] match_total: 1032
2025-05-08 22:22:03,259 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1144960447
1       1144960447
2       1144960447
3       1144960447
4       1144960447
           ...    
1027    1144960447
1028    1144960447
1029    1144960447
1030    1144960447
1031    1144960447
Name: account_id, Length: 1032, dtype: int64
2025-05-08 22:22:03,259 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:03,264 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:03,265 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:03,266 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:03,266 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:03,266 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:03,273 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 27-26
2025-05-08 22:22:03,273 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:03,275 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1144960447
2025-05-08 22:22:03,276 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:03,276 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:03,286 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 23390-22358
2025-05-08 22:22:03,286 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=27, account_id=119080791) of 50
2025-05-08 22:22:03,286 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/119080791/match-history?only_stored_history=true
2025-05-08 22:22:03,286 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:03,583 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/119080791/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:03,589 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:03,589 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      119080791
1      119080791
2      119080791
3      119080791
4      119080791
         ...    
929    119080791
930    119080791
931    119080791
932    119080791
933    119080791
Name: account_id, Length: 934, dtype: int64
2025-05-08 22:22:03,590 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6728
2025-05-08 22:22:03,590 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5409
2025-05-08 22:22:03,590 [DEBUG] [root.generate_player_performance_metrics] match_total: 934
2025-05-08 22:22:03,591 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      119080791
1      119080791
2      119080791
3      119080791
4      119080791
         ...    
929    119080791
930    119080791
931    119080791
932    119080791
933    119080791
Name: account_id, Length: 934, dtype: int64
2025-05-08 22:22:03,591 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:03,595 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:03,596 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:03,596 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:03,596 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:03,596 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:03,605 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 28-27
2025-05-08 22:22:03,605 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:03,607 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 119080791
2025-05-08 22:22:03,607 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:03,607 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:03,616 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 24324-23390
2025-05-08 22:22:03,616 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=28, account_id=1268598782) of 50
2025-05-08 22:22:03,616 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1268598782/match-history?only_stored_history=true
2025-05-08 22:22:03,616 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:03,841 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1268598782/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:03,844 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:03,845 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1268598782
1      1268598782
2      1268598782
3      1268598782
4      1268598782
          ...    
99     1268598782
100    1268598782
101    1268598782
102    1268598782
103    1268598782
Name: account_id, Length: 104, dtype: int64
2025-05-08 22:22:03,845 [DEBUG] [root.generate_player_performance_metrics] total_kills: 620
2025-05-08 22:22:03,845 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 699
2025-05-08 22:22:03,845 [DEBUG] [root.generate_player_performance_metrics] match_total: 104
2025-05-08 22:22:03,846 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1268598782
1      1268598782
2      1268598782
3      1268598782
4      1268598782
          ...    
99     1268598782
100    1268598782
101    1268598782
102    1268598782
103    1268598782
Name: account_id, Length: 104, dtype: int64
2025-05-08 22:22:03,846 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:03,850 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:03,851 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:03,852 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:03,852 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:03,852 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:03,859 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 29-28
2025-05-08 22:22:03,859 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:03,861 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1268598782
2025-05-08 22:22:03,861 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:03,861 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:03,867 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 24428-24324
2025-05-08 22:22:03,867 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=29, account_id=855666586) of 50
2025-05-08 22:22:03,867 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/855666586/match-history?only_stored_history=true
2025-05-08 22:22:03,867 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:04,334 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/855666586/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:04,340 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:04,340 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      855666586
1      855666586
2      855666586
3      855666586
4      855666586
         ...    
885    855666586
886    855666586
887    855666586
888    855666586
889    855666586
Name: account_id, Length: 890, dtype: int64
2025-05-08 22:22:04,341 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6516
2025-05-08 22:22:04,341 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5635
2025-05-08 22:22:04,341 [DEBUG] [root.generate_player_performance_metrics] match_total: 890
2025-05-08 22:22:04,341 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      855666586
1      855666586
2      855666586
3      855666586
4      855666586
         ...    
885    855666586
886    855666586
887    855666586
888    855666586
889    855666586
Name: account_id, Length: 890, dtype: int64
2025-05-08 22:22:04,342 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:04,347 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:04,348 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:04,348 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:04,348 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:04,348 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:04,356 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 30-29
2025-05-08 22:22:04,356 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:04,359 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 855666586
2025-05-08 22:22:04,359 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:04,359 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:04,368 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 25318-24428
2025-05-08 22:22:04,368 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=30, account_id=211469463) of 50
2025-05-08 22:22:04,368 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/211469463/match-history?only_stored_history=true
2025-05-08 22:22:04,368 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:04,966 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/211469463/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:04,986 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:04,986 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       211469463
1       211469463
2       211469463
3       211469463
4       211469463
          ...    
1791    211469463
1792    211469463
1793    211469463
1794    211469463
1795    211469463
Name: account_id, Length: 1796, dtype: int64
2025-05-08 22:22:04,987 [DEBUG] [root.generate_player_performance_metrics] total_kills: 17337
2025-05-08 22:22:04,987 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8148
2025-05-08 22:22:04,987 [DEBUG] [root.generate_player_performance_metrics] match_total: 1796
2025-05-08 22:22:04,987 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       211469463
1       211469463
2       211469463
3       211469463
4       211469463
          ...    
1791    211469463
1792    211469463
1793    211469463
1794    211469463
1795    211469463
Name: account_id, Length: 1796, dtype: int64
2025-05-08 22:22:04,987 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:04,992 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:04,993 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:04,993 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:04,993 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:04,993 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:05,002 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 31-30
2025-05-08 22:22:05,002 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:05,004 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 211469463
2025-05-08 22:22:05,005 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:05,005 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:05,020 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 27114-25318
2025-05-08 22:22:05,020 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=31, account_id=1888691513) of 50
2025-05-08 22:22:05,020 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1888691513/match-history?only_stored_history=true
2025-05-08 22:22:05,020 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:05,405 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1888691513/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:05,406 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:05,407 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1888691513
1     1888691513
2     1888691513
3     1888691513
4     1888691513
5     1888691513
6     1888691513
7     1888691513
8     1888691513
9     1888691513
10    1888691513
11    1888691513
12    1888691513
13    1888691513
14    1888691513
15    1888691513
16    1888691513
17    1888691513
18    1888691513
19    1888691513
20    1888691513
21    1888691513
22    1888691513
23    1888691513
24    1888691513
25    1888691513
26    1888691513
27    1888691513
28    1888691513
29    1888691513
30    1888691513
31    1888691513
32    1888691513
33    1888691513
34    1888691513
35    1888691513
36    1888691513
37    1888691513
38    1888691513
39    1888691513
40    1888691513
41    1888691513
42    1888691513
43    1888691513
44    1888691513
45    1888691513
46    1888691513
47    1888691513
48    1888691513
49    1888691513
Name: account_id, dtype: int64
2025-05-08 22:22:05,407 [DEBUG] [root.generate_player_performance_metrics] total_kills: 412
2025-05-08 22:22:05,407 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 244
2025-05-08 22:22:05,407 [DEBUG] [root.generate_player_performance_metrics] match_total: 50
2025-05-08 22:22:05,408 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1888691513
1     1888691513
2     1888691513
3     1888691513
4     1888691513
5     1888691513
6     1888691513
7     1888691513
8     1888691513
9     1888691513
10    1888691513
11    1888691513
12    1888691513
13    1888691513
14    1888691513
15    1888691513
16    1888691513
17    1888691513
18    1888691513
19    1888691513
20    1888691513
21    1888691513
22    1888691513
23    1888691513
24    1888691513
25    1888691513
26    1888691513
27    1888691513
28    1888691513
29    1888691513
30    1888691513
31    1888691513
32    1888691513
33    1888691513
34    1888691513
35    1888691513
36    1888691513
37    1888691513
38    1888691513
39    1888691513
40    1888691513
41    1888691513
42    1888691513
43    1888691513
44    1888691513
45    1888691513
46    1888691513
47    1888691513
48    1888691513
49    1888691513
Name: account_id, dtype: int64
2025-05-08 22:22:05,408 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:05,413 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:05,414 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:05,414 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:05,414 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:05,414 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:05,421 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 32-31
2025-05-08 22:22:05,421 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:05,423 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1888691513
2025-05-08 22:22:05,423 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:05,423 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:05,429 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 27164-27114
2025-05-08 22:22:05,429 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=32, account_id=1062664388) of 50
2025-05-08 22:22:05,429 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1062664388/match-history?only_stored_history=true
2025-05-08 22:22:05,429 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:05,921 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1062664388/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:05,997 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:05,998 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1062664388
1       1062664388
2       1062664388
3       1062664388
4       1062664388
           ...    
1443    1062664388
1444    1062664388
1445    1062664388
1446    1062664388
1447    1062664388
Name: account_id, Length: 1448, dtype: int64
2025-05-08 22:22:05,998 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12265
2025-05-08 22:22:05,998 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10046
2025-05-08 22:22:05,998 [DEBUG] [root.generate_player_performance_metrics] match_total: 1448
2025-05-08 22:22:05,999 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1062664388
1       1062664388
2       1062664388
3       1062664388
4       1062664388
           ...    
1443    1062664388
1444    1062664388
1445    1062664388
1446    1062664388
1447    1062664388
Name: account_id, Length: 1448, dtype: int64
2025-05-08 22:22:05,999 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:06,004 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:06,005 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:06,005 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:06,005 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:06,005 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:06,013 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 33-32
2025-05-08 22:22:06,013 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:06,016 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1062664388
2025-05-08 22:22:06,016 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:06,016 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:06,028 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 28612-27164
2025-05-08 22:22:06,028 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=33, account_id=1260716420) of 50
2025-05-08 22:22:06,028 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1260716420/match-history?only_stored_history=true
2025-05-08 22:22:06,028 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:06,581 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1260716420/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:06,588 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:06,588 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1260716420
1       1260716420
2       1260716420
3       1260716420
4       1260716420
           ...    
1332    1260716420
1333    1260716420
1334    1260716420
1335    1260716420
1336    1260716420
Name: account_id, Length: 1337, dtype: int64
2025-05-08 22:22:06,590 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11521
2025-05-08 22:22:06,590 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8186
2025-05-08 22:22:06,590 [DEBUG] [root.generate_player_performance_metrics] match_total: 1337
2025-05-08 22:22:06,591 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1260716420
1       1260716420
2       1260716420
3       1260716420
4       1260716420
           ...    
1332    1260716420
1333    1260716420
1334    1260716420
1335    1260716420
1336    1260716420
Name: account_id, Length: 1337, dtype: int64
2025-05-08 22:22:06,591 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:06,595 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:06,596 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:06,596 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:06,596 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:06,597 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:06,606 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 34-33
2025-05-08 22:22:06,606 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:06,608 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1260716420
2025-05-08 22:22:06,608 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:06,608 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:06,619 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 29949-28612
2025-05-08 22:22:06,619 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=34, account_id=168215213) of 50
2025-05-08 22:22:06,619 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/168215213/match-history?only_stored_history=true
2025-05-08 22:22:06,620 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:06,915 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/168215213/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:06,939 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:06,940 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      168215213
1      168215213
2      168215213
3      168215213
4      168215213
         ...    
811    168215213
812    168215213
813    168215213
814    168215213
815    168215213
Name: account_id, Length: 816, dtype: int64
2025-05-08 22:22:06,940 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8121
2025-05-08 22:22:06,940 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6675
2025-05-08 22:22:06,940 [DEBUG] [root.generate_player_performance_metrics] match_total: 816
2025-05-08 22:22:06,941 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      168215213
1      168215213
2      168215213
3      168215213
4      168215213
         ...    
811    168215213
812    168215213
813    168215213
814    168215213
815    168215213
Name: account_id, Length: 816, dtype: int64
2025-05-08 22:22:06,941 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:06,946 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:06,947 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:06,947 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:06,948 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:06,948 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:06,956 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 35-34
2025-05-08 22:22:06,956 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:06,958 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 168215213
2025-05-08 22:22:06,958 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:06,958 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:06,966 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 30765-29949
2025-05-08 22:22:06,966 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=35, account_id=1829203098) of 50
2025-05-08 22:22:06,966 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1829203098/match-history?only_stored_history=true
2025-05-08 22:22:06,967 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:07,187 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1829203098/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:07,188 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:07,189 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1829203098
1      1829203098
2      1829203098
3      1829203098
4      1829203098
          ...    
107    1829203098
108    1829203098
109    1829203098
110    1829203098
111    1829203098
Name: account_id, Length: 112, dtype: int64
2025-05-08 22:22:07,189 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1276
2025-05-08 22:22:07,189 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 857
2025-05-08 22:22:07,189 [DEBUG] [root.generate_player_performance_metrics] match_total: 112
2025-05-08 22:22:07,190 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1829203098
1      1829203098
2      1829203098
3      1829203098
4      1829203098
          ...    
107    1829203098
108    1829203098
109    1829203098
110    1829203098
111    1829203098
Name: account_id, Length: 112, dtype: int64
2025-05-08 22:22:07,190 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:07,195 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:07,196 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:07,196 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:07,196 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:07,196 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:07,203 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 36-35
2025-05-08 22:22:07,203 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:07,205 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1829203098
2025-05-08 22:22:07,205 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:07,205 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:07,211 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 30877-30765
2025-05-08 22:22:07,211 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=36, account_id=1728161748) of 50
2025-05-08 22:22:07,211 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1728161748/match-history?only_stored_history=true
2025-05-08 22:22:07,212 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:07,487 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1728161748/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:07,491 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:07,491 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1728161748
1      1728161748
2      1728161748
3      1728161748
4      1728161748
          ...    
567    1728161748
568    1728161748
569    1728161748
570    1728161748
571    1728161748
Name: account_id, Length: 572, dtype: int64
2025-05-08 22:22:07,492 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5359
2025-05-08 22:22:07,492 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3750
2025-05-08 22:22:07,492 [DEBUG] [root.generate_player_performance_metrics] match_total: 572
2025-05-08 22:22:07,493 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1728161748
1      1728161748
2      1728161748
3      1728161748
4      1728161748
          ...    
567    1728161748
568    1728161748
569    1728161748
570    1728161748
571    1728161748
Name: account_id, Length: 572, dtype: int64
2025-05-08 22:22:07,493 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:07,498 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:07,499 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:07,499 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:07,499 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:07,499 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:07,507 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 37-36
2025-05-08 22:22:07,507 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:07,508 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1728161748
2025-05-08 22:22:07,509 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:07,509 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:07,516 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 31449-30877
2025-05-08 22:22:07,516 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=37, account_id=195288263) of 50
2025-05-08 22:22:07,516 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/195288263/match-history?only_stored_history=true
2025-05-08 22:22:07,517 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:07,797 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/195288263/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:07,810 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:07,811 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       195288263
1       195288263
2       195288263
3       195288263
4       195288263
          ...    
1102    195288263
1103    195288263
1104    195288263
1105    195288263
1106    195288263
Name: account_id, Length: 1107, dtype: int64
2025-05-08 22:22:07,811 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6127
2025-05-08 22:22:07,811 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7444
2025-05-08 22:22:07,811 [DEBUG] [root.generate_player_performance_metrics] match_total: 1107
2025-05-08 22:22:07,813 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       195288263
1       195288263
2       195288263
3       195288263
4       195288263
          ...    
1102    195288263
1103    195288263
1104    195288263
1105    195288263
1106    195288263
Name: account_id, Length: 1107, dtype: int64
2025-05-08 22:22:07,813 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:07,817 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:07,819 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:07,819 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:07,819 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:07,819 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:07,827 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 38-37
2025-05-08 22:22:07,827 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:07,829 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 195288263
2025-05-08 22:22:07,829 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:07,829 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:07,840 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 32556-31449
2025-05-08 22:22:07,840 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=38, account_id=1053407836) of 50
2025-05-08 22:22:07,840 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1053407836/match-history?only_stored_history=true
2025-05-08 22:22:07,840 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:08,353 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1053407836/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:08,430 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:08,431 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1053407836
1       1053407836
2       1053407836
3       1053407836
4       1053407836
           ...    
1431    1053407836
1432    1053407836
1433    1053407836
1434    1053407836
1435    1053407836
Name: account_id, Length: 1436, dtype: int64
2025-05-08 22:22:08,431 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12280
2025-05-08 22:22:08,431 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 14851
2025-05-08 22:22:08,431 [DEBUG] [root.generate_player_performance_metrics] match_total: 1436
2025-05-08 22:22:08,432 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1053407836
1       1053407836
2       1053407836
3       1053407836
4       1053407836
           ...    
1431    1053407836
1432    1053407836
1433    1053407836
1434    1053407836
1435    1053407836
Name: account_id, Length: 1436, dtype: int64
2025-05-08 22:22:08,432 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:08,437 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:08,438 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:08,438 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:08,438 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:08,438 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:08,448 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 39-38
2025-05-08 22:22:08,448 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:08,450 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1053407836
2025-05-08 22:22:08,450 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:08,450 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:08,462 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 33992-32556
2025-05-08 22:22:08,462 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=39, account_id=145961401) of 50
2025-05-08 22:22:08,462 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/145961401/match-history?only_stored_history=true
2025-05-08 22:22:08,462 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:08,700 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/145961401/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:08,713 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:08,713 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      145961401
1      145961401
2      145961401
3      145961401
4      145961401
         ...    
436    145961401
437    145961401
438    145961401
439    145961401
440    145961401
Name: account_id, Length: 441, dtype: int64
2025-05-08 22:22:08,714 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4223
2025-05-08 22:22:08,714 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3211
2025-05-08 22:22:08,714 [DEBUG] [root.generate_player_performance_metrics] match_total: 441
2025-05-08 22:22:08,715 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      145961401
1      145961401
2      145961401
3      145961401
4      145961401
         ...    
436    145961401
437    145961401
438    145961401
439    145961401
440    145961401
Name: account_id, Length: 441, dtype: int64
2025-05-08 22:22:08,715 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:08,719 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:08,721 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:08,721 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:08,721 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:08,721 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:08,727 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 40-39
2025-05-08 22:22:08,728 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:08,729 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 145961401
2025-05-08 22:22:08,730 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:08,730 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:08,737 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 34433-33992
2025-05-08 22:22:08,737 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=40, account_id=63365536) of 50
2025-05-08 22:22:08,737 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/63365536/match-history?only_stored_history=true
2025-05-08 22:22:08,738 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:09,323 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/63365536/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:09,330 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:09,330 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       63365536
1       63365536
2       63365536
3       63365536
4       63365536
          ...   
1087    63365536
1088    63365536
1089    63365536
1090    63365536
1091    63365536
Name: account_id, Length: 1092, dtype: int64
2025-05-08 22:22:09,331 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7305
2025-05-08 22:22:09,331 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7540
2025-05-08 22:22:09,331 [DEBUG] [root.generate_player_performance_metrics] match_total: 1092
2025-05-08 22:22:09,331 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       63365536
1       63365536
2       63365536
3       63365536
4       63365536
          ...   
1087    63365536
1088    63365536
1089    63365536
1090    63365536
1091    63365536
Name: account_id, Length: 1092, dtype: int64
2025-05-08 22:22:09,332 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:09,336 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:09,338 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:09,338 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:09,338 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:09,338 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:09,346 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 41-40
2025-05-08 22:22:09,346 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:09,348 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 63365536
2025-05-08 22:22:09,348 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:09,348 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:09,359 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 35525-34433
2025-05-08 22:22:09,359 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=41, account_id=119886020) of 50
2025-05-08 22:22:09,359 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/119886020/match-history?only_stored_history=true
2025-05-08 22:22:09,359 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:09,645 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/119886020/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:09,677 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:09,678 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      119886020
1      119886020
2      119886020
3      119886020
4      119886020
         ...    
848    119886020
849    119886020
850    119886020
851    119886020
852    119886020
Name: account_id, Length: 853, dtype: int64
2025-05-08 22:22:09,678 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6244
2025-05-08 22:22:09,678 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5629
2025-05-08 22:22:09,679 [DEBUG] [root.generate_player_performance_metrics] match_total: 853
2025-05-08 22:22:09,680 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      119886020
1      119886020
2      119886020
3      119886020
4      119886020
         ...    
848    119886020
849    119886020
850    119886020
851    119886020
852    119886020
Name: account_id, Length: 853, dtype: int64
2025-05-08 22:22:09,680 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:09,687 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:09,689 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:09,689 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:09,689 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:09,689 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:09,699 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 42-41
2025-05-08 22:22:09,699 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:09,701 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 119886020
2025-05-08 22:22:09,701 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:09,702 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:09,712 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 36378-35525
2025-05-08 22:22:09,712 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=42, account_id=355049988) of 50
2025-05-08 22:22:09,712 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/355049988/match-history?only_stored_history=true
2025-05-08 22:22:09,712 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:10,207 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/355049988/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:10,298 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:10,299 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       355049988
1       355049988
2       355049988
3       355049988
4       355049988
          ...    
1661    355049988
1662    355049988
1663    355049988
1664    355049988
1665    355049988
Name: account_id, Length: 1666, dtype: int64
2025-05-08 22:22:10,299 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13329
2025-05-08 22:22:10,299 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 13530
2025-05-08 22:22:10,299 [DEBUG] [root.generate_player_performance_metrics] match_total: 1666
2025-05-08 22:22:10,300 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       355049988
1       355049988
2       355049988
3       355049988
4       355049988
          ...    
1661    355049988
1662    355049988
1663    355049988
1664    355049988
1665    355049988
Name: account_id, Length: 1666, dtype: int64
2025-05-08 22:22:10,300 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:10,306 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:10,307 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:10,308 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:10,308 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:10,308 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:10,319 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 43-42
2025-05-08 22:22:10,319 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:10,322 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 355049988
2025-05-08 22:22:10,322 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:10,322 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:10,337 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 38044-36378
2025-05-08 22:22:10,337 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=43, account_id=58422272) of 50
2025-05-08 22:22:10,337 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/58422272/match-history?only_stored_history=true
2025-05-08 22:22:10,338 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:10,588 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/58422272/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:10,592 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:10,592 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      58422272
1      58422272
2      58422272
3      58422272
4      58422272
         ...   
676    58422272
677    58422272
678    58422272
679    58422272
680    58422272
Name: account_id, Length: 681, dtype: int64
2025-05-08 22:22:10,592 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5788
2025-05-08 22:22:10,592 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4645
2025-05-08 22:22:10,592 [DEBUG] [root.generate_player_performance_metrics] match_total: 681
2025-05-08 22:22:10,593 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      58422272
1      58422272
2      58422272
3      58422272
4      58422272
         ...   
676    58422272
677    58422272
678    58422272
679    58422272
680    58422272
Name: account_id, Length: 681, dtype: int64
2025-05-08 22:22:10,593 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:10,598 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:10,599 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:10,599 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:10,599 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:10,599 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:10,610 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 44-43
2025-05-08 22:22:10,610 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:10,612 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 58422272
2025-05-08 22:22:10,612 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:10,612 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:10,620 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 38725-38044
2025-05-08 22:22:10,620 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=44, account_id=389156861) of 50
2025-05-08 22:22:10,620 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/389156861/match-history?only_stored_history=true
2025-05-08 22:22:10,621 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:11,062 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/389156861/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:11,148 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:11,148 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       389156861
1       389156861
2       389156861
3       389156861
4       389156861
          ...    
1027    389156861
1028    389156861
1029    389156861
1030    389156861
1031    389156861
Name: account_id, Length: 1032, dtype: int64
2025-05-08 22:22:11,149 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7785
2025-05-08 22:22:11,149 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8823
2025-05-08 22:22:11,149 [DEBUG] [root.generate_player_performance_metrics] match_total: 1032
2025-05-08 22:22:11,149 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       389156861
1       389156861
2       389156861
3       389156861
4       389156861
          ...    
1027    389156861
1028    389156861
1029    389156861
1030    389156861
1031    389156861
Name: account_id, Length: 1032, dtype: int64
2025-05-08 22:22:11,149 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:11,155 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:11,156 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:11,156 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:11,156 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:11,156 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:11,167 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 45-44
2025-05-08 22:22:11,167 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:11,169 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 389156861
2025-05-08 22:22:11,170 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:11,170 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:11,178 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 39757-38725
2025-05-08 22:22:11,178 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=45, account_id=5447772) of 50
2025-05-08 22:22:11,179 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/5447772/match-history?only_stored_history=true
2025-05-08 22:22:11,179 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:11,706 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/5447772/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:11,787 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:11,787 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       5447772
1       5447772
2       5447772
3       5447772
4       5447772
         ...   
1525    5447772
1526    5447772
1527    5447772
1528    5447772
1529    5447772
Name: account_id, Length: 1530, dtype: int64
2025-05-08 22:22:11,788 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12123
2025-05-08 22:22:11,788 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7620
2025-05-08 22:22:11,788 [DEBUG] [root.generate_player_performance_metrics] match_total: 1530
2025-05-08 22:22:11,789 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       5447772
1       5447772
2       5447772
3       5447772
4       5447772
         ...   
1525    5447772
1526    5447772
1527    5447772
1528    5447772
1529    5447772
Name: account_id, Length: 1530, dtype: int64
2025-05-08 22:22:11,789 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:11,795 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:11,796 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:11,796 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:11,796 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:11,796 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:11,809 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 46-45
2025-05-08 22:22:11,809 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:11,811 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 5447772
2025-05-08 22:22:11,812 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:11,812 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:11,825 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 41287-39757
2025-05-08 22:22:11,825 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=46, account_id=204197551) of 50
2025-05-08 22:22:11,825 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/204197551/match-history?only_stored_history=true
2025-05-08 22:22:11,825 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:12,263 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/204197551/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:12,264 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:12,265 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     204197551
1     204197551
2     204197551
3     204197551
4     204197551
5     204197551
6     204197551
7     204197551
8     204197551
9     204197551
10    204197551
11    204197551
12    204197551
13    204197551
14    204197551
15    204197551
16    204197551
17    204197551
18    204197551
19    204197551
20    204197551
21    204197551
22    204197551
23    204197551
24    204197551
25    204197551
26    204197551
27    204197551
28    204197551
29    204197551
30    204197551
31    204197551
32    204197551
33    204197551
34    204197551
35    204197551
36    204197551
37    204197551
38    204197551
39    204197551
40    204197551
41    204197551
42    204197551
43    204197551
44    204197551
45    204197551
46    204197551
47    204197551
48    204197551
49    204197551
50    204197551
51    204197551
52    204197551
53    204197551
Name: account_id, dtype: int64
2025-05-08 22:22:12,265 [DEBUG] [root.generate_player_performance_metrics] total_kills: 655
2025-05-08 22:22:12,265 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 215
2025-05-08 22:22:12,265 [DEBUG] [root.generate_player_performance_metrics] match_total: 54
2025-05-08 22:22:12,266 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     204197551
1     204197551
2     204197551
3     204197551
4     204197551
5     204197551
6     204197551
7     204197551
8     204197551
9     204197551
10    204197551
11    204197551
12    204197551
13    204197551
14    204197551
15    204197551
16    204197551
17    204197551
18    204197551
19    204197551
20    204197551
21    204197551
22    204197551
23    204197551
24    204197551
25    204197551
26    204197551
27    204197551
28    204197551
29    204197551
30    204197551
31    204197551
32    204197551
33    204197551
34    204197551
35    204197551
36    204197551
37    204197551
38    204197551
39    204197551
40    204197551
41    204197551
42    204197551
43    204197551
44    204197551
45    204197551
46    204197551
47    204197551
48    204197551
49    204197551
50    204197551
51    204197551
52    204197551
53    204197551
Name: account_id, dtype: int64
2025-05-08 22:22:12,266 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:12,271 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:12,271 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:12,272 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:12,272 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:12,272 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:12,281 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 47-46
2025-05-08 22:22:12,282 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:12,284 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 204197551
2025-05-08 22:22:12,285 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:12,285 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:12,290 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 41341-41287
2025-05-08 22:22:12,290 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=47, account_id=401440477) of 50
2025-05-08 22:22:12,290 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/401440477/match-history?only_stored_history=true
2025-05-08 22:22:12,290 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:12,579 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/401440477/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:12,583 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:12,584 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      401440477
1      401440477
2      401440477
3      401440477
4      401440477
         ...    
498    401440477
499    401440477
500    401440477
501    401440477
502    401440477
Name: account_id, Length: 503, dtype: int64
2025-05-08 22:22:12,584 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4336
2025-05-08 22:22:12,584 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3972
2025-05-08 22:22:12,584 [DEBUG] [root.generate_player_performance_metrics] match_total: 503
2025-05-08 22:22:12,585 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      401440477
1      401440477
2      401440477
3      401440477
4      401440477
         ...    
498    401440477
499    401440477
500    401440477
501    401440477
502    401440477
Name: account_id, Length: 503, dtype: int64
2025-05-08 22:22:12,585 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:12,590 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:12,591 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:12,591 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:12,591 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:12,591 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:12,600 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 48-47
2025-05-08 22:22:12,600 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:12,603 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 401440477
2025-05-08 22:22:12,603 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:12,603 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:12,610 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 41844-41341
2025-05-08 22:22:12,610 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=48, account_id=390532588) of 50
2025-05-08 22:22:12,610 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/390532588/match-history?only_stored_history=true
2025-05-08 22:22:12,611 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:13,204 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/390532588/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:13,210 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:13,211 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       390532588
1       390532588
2       390532588
3       390532588
4       390532588
          ...    
1058    390532588
1059    390532588
1060    390532588
1061    390532588
1062    390532588
Name: account_id, Length: 1063, dtype: int64
2025-05-08 22:22:13,211 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10202
2025-05-08 22:22:13,211 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6852
2025-05-08 22:22:13,211 [DEBUG] [root.generate_player_performance_metrics] match_total: 1063
2025-05-08 22:22:13,213 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       390532588
1       390532588
2       390532588
3       390532588
4       390532588
          ...    
1058    390532588
1059    390532588
1060    390532588
1061    390532588
1062    390532588
Name: account_id, Length: 1063, dtype: int64
2025-05-08 22:22:13,213 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:13,218 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:13,219 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:13,219 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:13,219 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:13,219 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:13,226 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 49-48
2025-05-08 22:22:13,226 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:13,228 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 390532588
2025-05-08 22:22:13,229 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:13,229 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:13,238 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 42907-41844
2025-05-08 22:22:13,238 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=49, account_id=339976259) of 50
2025-05-08 22:22:13,238 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/339976259/match-history?only_stored_history=true
2025-05-08 22:22:13,239 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:22:13,869 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/339976259/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:22:13,876 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:22:13,877 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       339976259
1       339976259
2       339976259
3       339976259
4       339976259
          ...    
1076    339976259
1077    339976259
1078    339976259
1079    339976259
1080    339976259
Name: account_id, Length: 1081, dtype: int64
2025-05-08 22:22:13,877 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7913
2025-05-08 22:22:13,877 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5711
2025-05-08 22:22:13,877 [DEBUG] [root.generate_player_performance_metrics] match_total: 1081
2025-05-08 22:22:13,878 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       339976259
1       339976259
2       339976259
3       339976259
4       339976259
          ...    
1076    339976259
1077    339976259
1078    339976259
1079    339976259
1080    339976259
Name: account_id, Length: 1081, dtype: int64
2025-05-08 22:22:13,878 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:22:13,883 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:22:13,884 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:13,884 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:22:13,884 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'match_duration_s', 'match_id', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'start_time', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:13,884 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:13,892 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 50-49
2025-05-08 22:22:13,892 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:22:13,895 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 339976259
2025-05-08 22:22:13,895 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'match_duration_s', 'p_win_pct_6', 'won', 'match_mode', 'net_worth', 'abandoned_time_s', 'denies', 'player_deaths', 'last_hits', 'objectives_mask_team0', 'hero_id', 'team_abandoned', 'player_team', 'match_result', 'player_kills', 'p_loss_pct_6', 'player_assists', 'game_mode', 'hero_level', 'objectives_mask_team1'}
2025-05-08 22:22:13,895 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:22:13,906 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 43988-42907
2025-05-08 22:22:13,906 [INFO] [root.run_etl_player_hero_match_trends] *TEST*completed player_trends
2025-05-08 22:32:39,279 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:32:39,306 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:32:39,334 [INFO] [root.create_all_tables] Resulting tables: {'matches', 'hero_trends', 'player_rolling_stats', 'player_matches', 'player_trends', 'player_hero_trends'}
2025-05-08 22:32:39,334 [INFO] [root.create_all_tables] All tables created: {'matches', 'player_trends', 'player_matches', 'player_rolling_stats', 'hero_trends', 'player_hero_trends'}
2025-05-08 22:32:39,334 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:32:39,334 [DEBUG] [root.bulk_fetch_matches] 
*day:0 min =1 max = 0
2025-05-08 22:32:39,336 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:40,225 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746671559&max_unix_timestamp=1746757959&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:40,327 [DEBUG] [root.bulk_fetch_matches] 
*day:1 min =2 max = 1
2025-05-08 22:32:40,328 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:41,030 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746585160&max_unix_timestamp=1746671560&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:41,128 [DEBUG] [root.bulk_fetch_matches] 
*day:2 min =3 max = 2
2025-05-08 22:32:41,128 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:41,650 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746498761&max_unix_timestamp=1746585161&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:41,747 [DEBUG] [root.bulk_fetch_matches] 
*day:3 min =4 max = 3
2025-05-08 22:32:41,747 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:42,251 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746412361&max_unix_timestamp=1746498761&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:42,265 [DEBUG] [root.bulk_fetch_matches] 
*day:4 min =5 max = 4
2025-05-08 22:32:42,266 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:43,060 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746325962&max_unix_timestamp=1746412362&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:43,079 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data fetched
2025-05-08 22:32:43,079 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Normalizing data
2025-05-08 22:32:43,079 [INFO] [root.normalize_bulk_matches] Normalizing bulk match data
2025-05-08 22:32:43,079 [INFO] [root.normalize_bulk_matches] Processing day #0 with 242 matches
2025-05-08 22:32:43,080 [INFO] [root.normalize_bulk_matches] Processing day #1 with 169 matches
2025-05-08 22:32:43,081 [INFO] [root.normalize_bulk_matches] Processing day #2 with 192 matches
2025-05-08 22:32:43,082 [INFO] [root.normalize_bulk_matches] Processing day #3 with 187 matches
2025-05-08 22:32:43,083 [INFO] [root.normalize_bulk_matches] Processing day #4 with 179 matches
2025-05-08 22:32:43,096 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data normalized
2025-05-08 22:32:43,096 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Loading data into database
2025-05-08 22:32:43,096 [INFO] [root.save_bulk_matches_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:43,154 [INFO] [root.save_bulk_matches_to_db] Bulk load complete.
2025-05-08 22:32:43,154 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data loaded into database
2025-05-08 22:32:43,155 [INFO] [root.run_etl_hero_trends] starting run_etl_hero_trends ETL without critical errors.
2025-05-08 22:32:43,155 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 7 days
2025-05-08 22:32:43,155 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?7&100


2025-05-08 22:32:43,156 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:43,200 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?7&100 HTTP/1.1" 200 None
2025-05-08 22:32:43,201 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:32:43,201 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:32:43,201 [INFO] [root.build_hero_trends] Setting trend window: start=1747362763, end=1746757963, window_days=7
2025-05-08 22:32:43,205 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_denies', 'total_max_health', 'total_shots_missed', 'players', 'matches', 'total_neutral_damage', 'total_last_hits', 'total_assists', 'total_creep_damage', 'wins', 'total_kills', 'total_net_worth', 'total_player_damage', 'total_deaths', 'total_player_damage_taken', 'total_shots_hit', 'losses', 'total_boss_damage'}
2025-05-08 22:32:43,205 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:43,210 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 26-0
2025-05-08 22:32:43,211 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 30 days
2025-05-08 22:32:43,211 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?30&100


2025-05-08 22:32:43,211 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:43,251 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?30&100 HTTP/1.1" 200 None
2025-05-08 22:32:43,251 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:32:43,252 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:32:43,252 [INFO] [root.build_hero_trends] Setting trend window: start=1749349963, end=1746757963, window_days=30
2025-05-08 22:32:43,254 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_denies', 'total_max_health', 'total_shots_missed', 'players', 'matches', 'total_neutral_damage', 'total_last_hits', 'total_assists', 'total_creep_damage', 'wins', 'total_kills', 'total_net_worth', 'total_player_damage', 'total_deaths', 'total_player_damage_taken', 'total_shots_hit', 'losses', 'total_boss_damage'}
2025-05-08 22:32:43,255 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:43,260 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 52-26
2025-05-08 22:32:43,260 [INFO] [root.run_etl_hero_trends] completed 7d and 30d hero trends ETL without critical errors.
2025-05-08 22:32:43,260 [INFO] [root.run_etl_player_hero_match_trends] Starting function tests
2025-05-08 22:32:43,262 [INFO] [root.pull_trend_players_from_db] Pulled 250 players to trend
2025-05-08 22:32:43,262 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 0.00seconds. Processed 0 of 250 players
2025-05-08 22:32:43,263 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=0, account_id=193143480) of 250
2025-05-08 22:32:43,263 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/193143480/match-history?only_stored_history=true
2025-05-08 22:32:43,263 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:43,727 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/193143480/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:43,733 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:43,734 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      193143480
1      193143480
2      193143480
3      193143480
4      193143480
         ...    
857    193143480
858    193143480
859    193143480
860    193143480
861    193143480
Name: account_id, Length: 862, dtype: int64
2025-05-08 22:32:43,734 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7875
2025-05-08 22:32:43,734 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5856
2025-05-08 22:32:43,734 [DEBUG] [root.generate_player_performance_metrics] match_total: 862
2025-05-08 22:32:43,735 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      193143480
1      193143480
2      193143480
3      193143480
4      193143480
         ...    
857    193143480
858    193143480
859    193143480
860    193143480
861    193143480
Name: account_id, Length: 862, dtype: int64
2025-05-08 22:32:43,735 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:43,741 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:43,742 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:43,742 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:43,742 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:43,742 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:43,750 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 1-0
2025-05-08 22:32:43,750 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:43,752 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 193143480
2025-05-08 22:32:43,752 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:43,752 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:43,762 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 862-0
2025-05-08 22:32:43,762 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=1, account_id=1889172005) of 250
2025-05-08 22:32:43,762 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1889172005/match-history?only_stored_history=true
2025-05-08 22:32:43,763 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:44,164 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1889172005/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:44,166 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:44,166 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1889172005
1     1889172005
2     1889172005
3     1889172005
4     1889172005
5     1889172005
6     1889172005
7     1889172005
8     1889172005
9     1889172005
10    1889172005
11    1889172005
12    1889172005
13    1889172005
14    1889172005
15    1889172005
16    1889172005
17    1889172005
18    1889172005
19    1889172005
20    1889172005
21    1889172005
22    1889172005
23    1889172005
24    1889172005
25    1889172005
26    1889172005
27    1889172005
28    1889172005
29    1889172005
30    1889172005
31    1889172005
32    1889172005
33    1889172005
34    1889172005
35    1889172005
36    1889172005
37    1889172005
38    1889172005
39    1889172005
40    1889172005
41    1889172005
42    1889172005
43    1889172005
44    1889172005
45    1889172005
46    1889172005
47    1889172005
48    1889172005
49    1889172005
50    1889172005
51    1889172005
52    1889172005
53    1889172005
54    1889172005
55    1889172005
56    1889172005
Name: account_id, dtype: int64
2025-05-08 22:32:44,166 [DEBUG] [root.generate_player_performance_metrics] total_kills: 845
2025-05-08 22:32:44,166 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 381
2025-05-08 22:32:44,166 [DEBUG] [root.generate_player_performance_metrics] match_total: 57
2025-05-08 22:32:44,167 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1889172005
1     1889172005
2     1889172005
3     1889172005
4     1889172005
5     1889172005
6     1889172005
7     1889172005
8     1889172005
9     1889172005
10    1889172005
11    1889172005
12    1889172005
13    1889172005
14    1889172005
15    1889172005
16    1889172005
17    1889172005
18    1889172005
19    1889172005
20    1889172005
21    1889172005
22    1889172005
23    1889172005
24    1889172005
25    1889172005
26    1889172005
27    1889172005
28    1889172005
29    1889172005
30    1889172005
31    1889172005
32    1889172005
33    1889172005
34    1889172005
35    1889172005
36    1889172005
37    1889172005
38    1889172005
39    1889172005
40    1889172005
41    1889172005
42    1889172005
43    1889172005
44    1889172005
45    1889172005
46    1889172005
47    1889172005
48    1889172005
49    1889172005
50    1889172005
51    1889172005
52    1889172005
53    1889172005
54    1889172005
55    1889172005
56    1889172005
Name: account_id, dtype: int64
2025-05-08 22:32:44,167 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:44,172 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:44,173 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:44,173 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:44,173 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:44,173 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:44,180 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 2-1
2025-05-08 22:32:44,180 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:44,182 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1889172005
2025-05-08 22:32:44,183 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:44,183 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:44,188 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 919-862
2025-05-08 22:32:44,188 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=2, account_id=89528902) of 250
2025-05-08 22:32:44,188 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/89528902/match-history?only_stored_history=true
2025-05-08 22:32:44,189 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:44,493 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/89528902/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:44,509 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:44,510 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       89528902
1       89528902
2       89528902
3       89528902
4       89528902
          ...   
1148    89528902
1149    89528902
1150    89528902
1151    89528902
1152    89528902
Name: account_id, Length: 1153, dtype: int64
2025-05-08 22:32:44,510 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11784
2025-05-08 22:32:44,510 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11696
2025-05-08 22:32:44,510 [DEBUG] [root.generate_player_performance_metrics] match_total: 1153
2025-05-08 22:32:44,511 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       89528902
1       89528902
2       89528902
3       89528902
4       89528902
          ...   
1148    89528902
1149    89528902
1150    89528902
1151    89528902
1152    89528902
Name: account_id, Length: 1153, dtype: int64
2025-05-08 22:32:44,511 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:44,516 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:44,517 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:44,517 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:44,517 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:44,518 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:44,526 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 3-2
2025-05-08 22:32:44,526 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:44,528 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 89528902
2025-05-08 22:32:44,528 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:44,528 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:44,538 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 2072-919
2025-05-08 22:32:44,538 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=3, account_id=1676299122) of 250
2025-05-08 22:32:44,538 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1676299122/match-history?only_stored_history=true
2025-05-08 22:32:44,538 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:45,021 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1676299122/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:45,122 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:45,123 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1676299122
1       1676299122
2       1676299122
3       1676299122
4       1676299122
           ...    
1994    1676299122
1995    1676299122
1996    1676299122
1997    1676299122
1998    1676299122
Name: account_id, Length: 1999, dtype: int64
2025-05-08 22:32:45,123 [DEBUG] [root.generate_player_performance_metrics] total_kills: 20288
2025-05-08 22:32:45,123 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 13352
2025-05-08 22:32:45,123 [DEBUG] [root.generate_player_performance_metrics] match_total: 1999
2025-05-08 22:32:45,124 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1676299122
1       1676299122
2       1676299122
3       1676299122
4       1676299122
           ...    
1994    1676299122
1995    1676299122
1996    1676299122
1997    1676299122
1998    1676299122
Name: account_id, Length: 1999, dtype: int64
2025-05-08 22:32:45,124 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:45,130 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:45,131 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:45,131 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:45,131 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:45,131 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:45,141 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 4-3
2025-05-08 22:32:45,141 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:45,143 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1676299122
2025-05-08 22:32:45,144 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:45,144 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:45,161 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 4071-2072
2025-05-08 22:32:45,161 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=4, account_id=1090737694) of 250
2025-05-08 22:32:45,161 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1090737694/match-history?only_stored_history=true
2025-05-08 22:32:45,161 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:45,432 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1090737694/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:45,537 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:45,537 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1090737694
1       1090737694
2       1090737694
3       1090737694
4       1090737694
           ...    
1770    1090737694
1771    1090737694
1772    1090737694
1773    1090737694
1774    1090737694
Name: account_id, Length: 1775, dtype: int64
2025-05-08 22:32:45,538 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14313
2025-05-08 22:32:45,538 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 13687
2025-05-08 22:32:45,538 [DEBUG] [root.generate_player_performance_metrics] match_total: 1775
2025-05-08 22:32:45,539 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1090737694
1       1090737694
2       1090737694
3       1090737694
4       1090737694
           ...    
1770    1090737694
1771    1090737694
1772    1090737694
1773    1090737694
1774    1090737694
Name: account_id, Length: 1775, dtype: int64
2025-05-08 22:32:45,539 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:45,544 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:45,545 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:45,545 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:45,545 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:45,545 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:45,554 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 5-4
2025-05-08 22:32:45,554 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:45,556 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1090737694
2025-05-08 22:32:45,556 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:45,557 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:45,571 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 5846-4071
2025-05-08 22:32:45,571 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=5, account_id=865111006) of 250
2025-05-08 22:32:45,571 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/865111006/match-history?only_stored_history=true
2025-05-08 22:32:45,571 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:46,036 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/865111006/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:46,042 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:46,042 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      865111006
1      865111006
2      865111006
3      865111006
4      865111006
         ...    
742    865111006
743    865111006
744    865111006
745    865111006
746    865111006
Name: account_id, Length: 747, dtype: int64
2025-05-08 22:32:46,043 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5361
2025-05-08 22:32:46,043 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3861
2025-05-08 22:32:46,043 [DEBUG] [root.generate_player_performance_metrics] match_total: 747
2025-05-08 22:32:46,044 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      865111006
1      865111006
2      865111006
3      865111006
4      865111006
         ...    
742    865111006
743    865111006
744    865111006
745    865111006
746    865111006
Name: account_id, Length: 747, dtype: int64
2025-05-08 22:32:46,044 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:46,048 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:46,049 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:46,050 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:46,050 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:46,050 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:46,058 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 6-5
2025-05-08 22:32:46,058 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:46,060 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 865111006
2025-05-08 22:32:46,060 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:46,060 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:46,068 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 6593-5846
2025-05-08 22:32:46,068 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=6, account_id=1866929202) of 250
2025-05-08 22:32:46,068 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1866929202/match-history?only_stored_history=true
2025-05-08 22:32:46,069 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:46,483 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1866929202/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:46,486 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:46,487 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1866929202
1      1866929202
2      1866929202
3      1866929202
4      1866929202
          ...    
470    1866929202
471    1866929202
472    1866929202
473    1866929202
474    1866929202
Name: account_id, Length: 475, dtype: int64
2025-05-08 22:32:46,487 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3194
2025-05-08 22:32:46,487 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2290
2025-05-08 22:32:46,487 [DEBUG] [root.generate_player_performance_metrics] match_total: 475
2025-05-08 22:32:46,488 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1866929202
1      1866929202
2      1866929202
3      1866929202
4      1866929202
          ...    
470    1866929202
471    1866929202
472    1866929202
473    1866929202
474    1866929202
Name: account_id, Length: 475, dtype: int64
2025-05-08 22:32:46,488 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:46,493 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:46,494 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:46,494 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:46,494 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:46,494 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:46,503 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 7-6
2025-05-08 22:32:46,503 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:46,505 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1866929202
2025-05-08 22:32:46,505 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:46,505 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:46,512 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 7068-6593
2025-05-08 22:32:46,512 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=7, account_id=1446007996) of 250
2025-05-08 22:32:46,512 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1446007996/match-history?only_stored_history=true
2025-05-08 22:32:46,513 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:46,733 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1446007996/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:46,735 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:46,736 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1446007996
1      1446007996
2      1446007996
3      1446007996
4      1446007996
          ...    
137    1446007996
138    1446007996
139    1446007996
140    1446007996
141    1446007996
Name: account_id, Length: 142, dtype: int64
2025-05-08 22:32:46,736 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2187
2025-05-08 22:32:46,736 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 611
2025-05-08 22:32:46,736 [DEBUG] [root.generate_player_performance_metrics] match_total: 142
2025-05-08 22:32:46,737 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1446007996
1      1446007996
2      1446007996
3      1446007996
4      1446007996
          ...    
137    1446007996
138    1446007996
139    1446007996
140    1446007996
141    1446007996
Name: account_id, Length: 142, dtype: int64
2025-05-08 22:32:46,737 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:46,742 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:46,743 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:46,744 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:46,744 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:46,744 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:46,751 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 8-7
2025-05-08 22:32:46,751 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:46,753 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1446007996
2025-05-08 22:32:46,753 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:46,753 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:46,759 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 7210-7068
2025-05-08 22:32:46,759 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=8, account_id=173907991) of 250
2025-05-08 22:32:46,759 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/173907991/match-history?only_stored_history=true
2025-05-08 22:32:46,760 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:47,020 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/173907991/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:47,026 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:47,027 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      173907991
1      173907991
2      173907991
3      173907991
4      173907991
         ...    
741    173907991
742    173907991
743    173907991
744    173907991
745    173907991
Name: account_id, Length: 746, dtype: int64
2025-05-08 22:32:47,027 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6114
2025-05-08 22:32:47,027 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4124
2025-05-08 22:32:47,027 [DEBUG] [root.generate_player_performance_metrics] match_total: 746
2025-05-08 22:32:47,028 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      173907991
1      173907991
2      173907991
3      173907991
4      173907991
         ...    
741    173907991
742    173907991
743    173907991
744    173907991
745    173907991
Name: account_id, Length: 746, dtype: int64
2025-05-08 22:32:47,028 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:47,033 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:47,034 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:47,034 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:47,034 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:47,034 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:47,042 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 9-8
2025-05-08 22:32:47,042 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:47,044 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 173907991
2025-05-08 22:32:47,044 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:47,044 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:47,051 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 7956-7210
2025-05-08 22:32:47,051 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=9, account_id=55126821) of 250
2025-05-08 22:32:47,052 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/55126821/match-history?only_stored_history=true
2025-05-08 22:32:47,052 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:47,565 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/55126821/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:47,570 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:47,571 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      55126821
1      55126821
2      55126821
3      55126821
4      55126821
         ...   
865    55126821
866    55126821
867    55126821
868    55126821
869    55126821
Name: account_id, Length: 870, dtype: int64
2025-05-08 22:32:47,571 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6794
2025-05-08 22:32:47,571 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5728
2025-05-08 22:32:47,571 [DEBUG] [root.generate_player_performance_metrics] match_total: 870
2025-05-08 22:32:47,572 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      55126821
1      55126821
2      55126821
3      55126821
4      55126821
         ...   
865    55126821
866    55126821
867    55126821
868    55126821
869    55126821
Name: account_id, Length: 870, dtype: int64
2025-05-08 22:32:47,572 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:47,576 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:47,578 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:47,579 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:47,579 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:47,579 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:47,585 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 10-9
2025-05-08 22:32:47,586 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:47,588 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 55126821
2025-05-08 22:32:47,588 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:47,588 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:47,596 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 8826-7956
2025-05-08 22:32:47,596 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 4.34seconds. Processed 10 of 250 players
2025-05-08 22:32:47,596 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=10, account_id=1837991471) of 250
2025-05-08 22:32:47,596 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1837991471/match-history?only_stored_history=true
2025-05-08 22:32:47,596 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:47,951 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1837991471/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:47,956 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:47,957 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1837991471
1      1837991471
2      1837991471
3      1837991471
4      1837991471
          ...    
710    1837991471
711    1837991471
712    1837991471
713    1837991471
714    1837991471
Name: account_id, Length: 715, dtype: int64
2025-05-08 22:32:47,957 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7593
2025-05-08 22:32:47,957 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3843
2025-05-08 22:32:47,957 [DEBUG] [root.generate_player_performance_metrics] match_total: 715
2025-05-08 22:32:47,958 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1837991471
1      1837991471
2      1837991471
3      1837991471
4      1837991471
          ...    
710    1837991471
711    1837991471
712    1837991471
713    1837991471
714    1837991471
Name: account_id, Length: 715, dtype: int64
2025-05-08 22:32:47,958 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:47,963 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:47,964 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:47,964 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:47,964 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:47,964 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:47,972 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 11-10
2025-05-08 22:32:47,972 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:47,974 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1837991471
2025-05-08 22:32:47,974 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:47,974 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:47,982 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 9541-8826
2025-05-08 22:32:47,982 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=11, account_id=1869783455) of 250
2025-05-08 22:32:47,982 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1869783455/match-history?only_stored_history=true
2025-05-08 22:32:47,983 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:48,424 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1869783455/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:48,426 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:48,426 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1869783455
1      1869783455
2      1869783455
3      1869783455
4      1869783455
          ...    
235    1869783455
236    1869783455
237    1869783455
238    1869783455
239    1869783455
Name: account_id, Length: 240, dtype: int64
2025-05-08 22:32:48,427 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2401
2025-05-08 22:32:48,427 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1227
2025-05-08 22:32:48,427 [DEBUG] [root.generate_player_performance_metrics] match_total: 240
2025-05-08 22:32:48,429 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1869783455
1      1869783455
2      1869783455
3      1869783455
4      1869783455
          ...    
235    1869783455
236    1869783455
237    1869783455
238    1869783455
239    1869783455
Name: account_id, Length: 240, dtype: int64
2025-05-08 22:32:48,429 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:48,433 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:48,435 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:48,435 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:48,435 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:48,435 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:48,442 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 12-11
2025-05-08 22:32:48,442 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:48,444 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1869783455
2025-05-08 22:32:48,444 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:48,444 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:48,450 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 9781-9541
2025-05-08 22:32:48,450 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=12, account_id=442403321) of 250
2025-05-08 22:32:48,450 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/442403321/match-history?only_stored_history=true
2025-05-08 22:32:48,451 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:48,932 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/442403321/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:48,936 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:48,937 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      442403321
1      442403321
2      442403321
3      442403321
4      442403321
         ...    
569    442403321
570    442403321
571    442403321
572    442403321
573    442403321
Name: account_id, Length: 574, dtype: int64
2025-05-08 22:32:48,937 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5567
2025-05-08 22:32:48,937 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2832
2025-05-08 22:32:48,937 [DEBUG] [root.generate_player_performance_metrics] match_total: 574
2025-05-08 22:32:48,938 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      442403321
1      442403321
2      442403321
3      442403321
4      442403321
         ...    
569    442403321
570    442403321
571    442403321
572    442403321
573    442403321
Name: account_id, Length: 574, dtype: int64
2025-05-08 22:32:48,938 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:48,943 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:48,945 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:48,945 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:48,945 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'start_time', 'match_result', 'objectives_mask_team1', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'match_id', 'hero_id', 'match_duration_s', 'match_mode', 'team_abandoned', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:48,945 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:48,953 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 13-12
2025-05-08 22:32:48,953 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:48,955 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 442403321
2025-05-08 22:32:48,955 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'won', 'player_team', 'player_assists', 'game_mode', 'objectives_mask_team1', 'match_result', 'abandoned_time_s', 'player_deaths', 'hero_level', 'denies', 'hero_id', 'match_duration_s', 'p_loss_pct_6', 'match_mode', 'team_abandoned', 'p_win_pct_6', 'player_kills', 'last_hits', 'objectives_mask_team0', 'net_worth'}
2025-05-08 22:32:48,955 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:48,963 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 10355-9781
2025-05-08 22:32:48,963 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=13, account_id=866626250) of 250
2025-05-08 22:32:48,963 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/866626250/match-history?only_stored_history=true
2025-05-08 22:32:48,963 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:52,840 [INFO] [root.reset_all_tables] Resetting all tables
2025-05-08 22:32:52,864 [INFO] [root.create_all_tables] Creating all tables
2025-05-08 22:32:52,889 [INFO] [root.create_all_tables] Resulting tables: {'player_rolling_stats', 'hero_trends', 'player_trends', 'player_hero_trends', 'player_matches', 'matches'}
2025-05-08 22:32:52,889 [INFO] [root.create_all_tables] All tables created: {'player_trends', 'player_hero_trends', 'player_matches', 'matches', 'player_rolling_stats', 'hero_trends'}
2025-05-08 22:32:52,889 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Fetching data
2025-05-08 22:32:52,889 [DEBUG] [root.bulk_fetch_matches] 
*day:0 min =1 max = 0
2025-05-08 22:32:52,891 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:53,730 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746671572&max_unix_timestamp=1746757972&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:53,839 [DEBUG] [root.bulk_fetch_matches] 
*day:1 min =2 max = 1
2025-05-08 22:32:53,839 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:54,329 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746585173&max_unix_timestamp=1746671573&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:54,428 [DEBUG] [root.bulk_fetch_matches] 
*day:2 min =3 max = 2
2025-05-08 22:32:54,428 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:55,120 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746498774&max_unix_timestamp=1746585174&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:55,208 [DEBUG] [root.bulk_fetch_matches] 
*day:3 min =4 max = 3
2025-05-08 22:32:55,209 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:55,779 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746412375&max_unix_timestamp=1746498775&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:55,853 [DEBUG] [root.bulk_fetch_matches] 
*day:4 min =5 max = 4
2025-05-08 22:32:55,854 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:56,575 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/matches/metadata?include_player_info=true&min_unix_timestamp=1746325975&max_unix_timestamp=1746412375&min_average_badge=100&limit=5000 HTTP/1.1" 200 None
2025-05-08 22:32:56,656 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data fetched
2025-05-08 22:32:56,656 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Normalizing data
2025-05-08 22:32:56,656 [INFO] [root.normalize_bulk_matches] Normalizing bulk match data
2025-05-08 22:32:56,656 [INFO] [root.normalize_bulk_matches] Processing day #0 with 242 matches
2025-05-08 22:32:56,658 [INFO] [root.normalize_bulk_matches] Processing day #1 with 169 matches
2025-05-08 22:32:56,659 [INFO] [root.normalize_bulk_matches] Processing day #2 with 192 matches
2025-05-08 22:32:56,660 [INFO] [root.normalize_bulk_matches] Processing day #3 with 186 matches
2025-05-08 22:32:56,660 [INFO] [root.normalize_bulk_matches] Processing day #4 with 179 matches
2025-05-08 22:32:56,675 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data normalized
2025-05-08 22:32:56,675 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Loading data into database
2025-05-08 22:32:56,675 [INFO] [root.save_bulk_matches_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:56,735 [INFO] [root.save_bulk_matches_to_db] Bulk load complete.
2025-05-08 22:32:56,735 [INFO] [root.run_etl_bulk_matches] *INFO* ETL: Data loaded into database
2025-05-08 22:32:56,737 [INFO] [root.run_etl_hero_trends] starting run_etl_hero_trends ETL without critical errors.
2025-05-08 22:32:56,737 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 7 days
2025-05-08 22:32:56,737 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?7&100


2025-05-08 22:32:56,737 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:56,781 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?7&100 HTTP/1.1" 200 None
2025-05-08 22:32:56,781 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:32:56,782 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:32:56,782 [INFO] [root.build_hero_trends] Setting trend window: start=1747362776, end=1746757976, window_days=7
2025-05-08 22:32:56,785 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_deaths', 'total_player_damage', 'losses', 'total_denies', 'total_creep_damage', 'players', 'total_boss_damage', 'total_shots_hit', 'total_shots_missed', 'total_assists', 'total_neutral_damage', 'total_kills', 'total_max_health', 'matches', 'total_net_worth', 'total_player_damage_taken', 'total_last_hits', 'wins'}
2025-05-08 22:32:56,785 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:56,793 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 26-0
2025-05-08 22:32:56,793 [INFO] [root.run_etl_hero_trends] *INFO* ETL: Fetching hero trends for 30 days
2025-05-08 22:32:56,793 [INFO] [root.fetch_hero_trends] 

Getting hero_data from full url: https://api.deadlock-api.com/v1/analytics/hero-stats?30&100


2025-05-08 22:32:56,794 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:56,838 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/analytics/hero-stats?30&100 HTTP/1.1" 200 None
2025-05-08 22:32:56,839 [INFO] [root.fetch_hero_trends] hero data found!
2025-05-08 22:32:56,840 [INFO] [root.build_hero_trends] Transforming hero trends data
2025-05-08 22:32:56,840 [INFO] [root.build_hero_trends] Setting trend window: start=1749349976, end=1746757976, window_days=30
2025-05-08 22:32:56,842 [INFO] [root.save_hero_trends_to_db] Extra columns in hero_trends, extras: {'total_deaths', 'total_player_damage', 'losses', 'total_denies', 'total_creep_damage', 'players', 'total_boss_damage', 'total_shots_hit', 'total_shots_missed', 'total_assists', 'total_neutral_damage', 'total_kills', 'total_max_health', 'matches', 'total_net_worth', 'total_player_damage_taken', 'total_last_hits', 'wins'}
2025-05-08 22:32:56,842 [INFO] [root.save_hero_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:56,847 [INFO] [root.save_hero_trends_to_db] Bulk load complete. rows inserted: 52-26
2025-05-08 22:32:56,848 [INFO] [root.run_etl_hero_trends] completed 7d and 30d hero trends ETL without critical errors.
2025-05-08 22:32:56,848 [INFO] [root.run_etl_player_hero_match_trends] Starting function tests
2025-05-08 22:32:56,849 [INFO] [root.pull_trend_players_from_db] Pulled 250 players to trend
2025-05-08 22:32:56,849 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 0.00seconds. Processed 0 of 250 players
2025-05-08 22:32:56,849 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=0, account_id=158752514) of 250
2025-05-08 22:32:56,849 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/158752514/match-history?only_stored_history=true
2025-05-08 22:32:56,850 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:57,292 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/158752514/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:57,298 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:57,299 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      158752514
1      158752514
2      158752514
3      158752514
4      158752514
         ...    
886    158752514
887    158752514
888    158752514
889    158752514
890    158752514
Name: account_id, Length: 891, dtype: int64
2025-05-08 22:32:57,299 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7280
2025-05-08 22:32:57,299 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5425
2025-05-08 22:32:57,299 [DEBUG] [root.generate_player_performance_metrics] match_total: 891
2025-05-08 22:32:57,300 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      158752514
1      158752514
2      158752514
3      158752514
4      158752514
         ...    
886    158752514
887    158752514
888    158752514
889    158752514
890    158752514
Name: account_id, Length: 891, dtype: int64
2025-05-08 22:32:57,300 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:57,306 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:57,308 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:57,308 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:57,308 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:32:57,308 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:57,316 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 1-0
2025-05-08 22:32:57,316 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:57,318 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 158752514
2025-05-08 22:32:57,318 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:32:57,318 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:57,326 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 891-0
2025-05-08 22:32:57,326 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=1, account_id=97506421) of 250
2025-05-08 22:32:57,326 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/97506421/match-history?only_stored_history=true
2025-05-08 22:32:57,327 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:57,602 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/97506421/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:57,691 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:57,693 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       97506421
1       97506421
2       97506421
3       97506421
4       97506421
          ...   
1318    97506421
1319    97506421
1320    97506421
1321    97506421
1322    97506421
Name: account_id, Length: 1323, dtype: int64
2025-05-08 22:32:57,694 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12113
2025-05-08 22:32:57,694 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7121
2025-05-08 22:32:57,694 [DEBUG] [root.generate_player_performance_metrics] match_total: 1323
2025-05-08 22:32:57,695 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       97506421
1       97506421
2       97506421
3       97506421
4       97506421
          ...   
1318    97506421
1319    97506421
1320    97506421
1321    97506421
1322    97506421
Name: account_id, Length: 1323, dtype: int64
2025-05-08 22:32:57,695 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:57,700 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:57,701 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:57,701 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:57,701 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:32:57,701 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:57,709 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 2-1
2025-05-08 22:32:57,709 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:57,711 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 97506421
2025-05-08 22:32:57,711 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:32:57,712 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:57,722 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 2214-891
2025-05-08 22:32:57,722 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=2, account_id=1558594524) of 250
2025-05-08 22:32:57,722 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1558594524/match-history?only_stored_history=true
2025-05-08 22:32:57,723 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:58,154 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1558594524/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:58,157 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:58,158 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1558594524
1      1558594524
2      1558594524
3      1558594524
4      1558594524
          ...    
491    1558594524
492    1558594524
493    1558594524
494    1558594524
495    1558594524
Name: account_id, Length: 496, dtype: int64
2025-05-08 22:32:58,158 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3410
2025-05-08 22:32:58,158 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3134
2025-05-08 22:32:58,158 [DEBUG] [root.generate_player_performance_metrics] match_total: 496
2025-05-08 22:32:58,159 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1558594524
1      1558594524
2      1558594524
3      1558594524
4      1558594524
          ...    
491    1558594524
492    1558594524
493    1558594524
494    1558594524
495    1558594524
Name: account_id, Length: 496, dtype: int64
2025-05-08 22:32:58,159 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:58,164 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:58,165 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:58,165 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:58,165 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:32:58,166 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:58,173 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 3-2
2025-05-08 22:32:58,173 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:58,175 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1558594524
2025-05-08 22:32:58,175 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:32:58,175 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:58,182 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 2710-2214
2025-05-08 22:32:58,182 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=3, account_id=1146769754) of 250
2025-05-08 22:32:58,182 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1146769754/match-history?only_stored_history=true
2025-05-08 22:32:58,183 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:58,733 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1146769754/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:58,745 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:58,745 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1146769754
1       1146769754
2       1146769754
3       1146769754
4       1146769754
           ...    
1494    1146769754
1495    1146769754
1496    1146769754
1497    1146769754
1498    1146769754
Name: account_id, Length: 1499, dtype: int64
2025-05-08 22:32:58,746 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12227
2025-05-08 22:32:58,746 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7700
2025-05-08 22:32:58,746 [DEBUG] [root.generate_player_performance_metrics] match_total: 1499
2025-05-08 22:32:58,747 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1146769754
1       1146769754
2       1146769754
3       1146769754
4       1146769754
           ...    
1494    1146769754
1495    1146769754
1496    1146769754
1497    1146769754
1498    1146769754
Name: account_id, Length: 1499, dtype: int64
2025-05-08 22:32:58,747 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:58,751 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:58,753 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:58,753 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:58,753 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:32:58,753 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:58,761 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 4-3
2025-05-08 22:32:58,761 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:58,764 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1146769754
2025-05-08 22:32:58,764 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:32:58,764 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:58,776 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 4209-2710
2025-05-08 22:32:58,776 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=4, account_id=1032223691) of 250
2025-05-08 22:32:58,776 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1032223691/match-history?only_stored_history=true
2025-05-08 22:32:58,776 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:59,254 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1032223691/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:59,261 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:59,262 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1032223691
1       1032223691
2       1032223691
3       1032223691
4       1032223691
           ...    
999     1032223691
1000    1032223691
1001    1032223691
1002    1032223691
1003    1032223691
Name: account_id, Length: 1004, dtype: int64
2025-05-08 22:32:59,262 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10856
2025-05-08 22:32:59,262 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5410
2025-05-08 22:32:59,262 [DEBUG] [root.generate_player_performance_metrics] match_total: 1004
2025-05-08 22:32:59,263 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1032223691
1       1032223691
2       1032223691
3       1032223691
4       1032223691
           ...    
999     1032223691
1000    1032223691
1001    1032223691
1002    1032223691
1003    1032223691
Name: account_id, Length: 1004, dtype: int64
2025-05-08 22:32:59,263 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:59,268 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:59,269 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:59,269 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:59,269 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:32:59,269 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:59,276 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 5-4
2025-05-08 22:32:59,276 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:59,279 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1032223691
2025-05-08 22:32:59,280 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:32:59,280 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:59,289 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 5213-4209
2025-05-08 22:32:59,289 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=5, account_id=358780740) of 250
2025-05-08 22:32:59,289 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/358780740/match-history?only_stored_history=true
2025-05-08 22:32:59,289 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:59,548 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/358780740/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:59,562 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:59,562 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       358780740
1       358780740
2       358780740
3       358780740
4       358780740
          ...    
1202    358780740
1203    358780740
1204    358780740
1205    358780740
1206    358780740
Name: account_id, Length: 1207, dtype: int64
2025-05-08 22:32:59,563 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11527
2025-05-08 22:32:59,563 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7983
2025-05-08 22:32:59,563 [DEBUG] [root.generate_player_performance_metrics] match_total: 1207
2025-05-08 22:32:59,564 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       358780740
1       358780740
2       358780740
3       358780740
4       358780740
          ...    
1202    358780740
1203    358780740
1204    358780740
1205    358780740
1206    358780740
Name: account_id, Length: 1207, dtype: int64
2025-05-08 22:32:59,564 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:59,568 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:59,569 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:59,570 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:59,570 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:32:59,570 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:59,579 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 6-5
2025-05-08 22:32:59,579 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:59,581 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 358780740
2025-05-08 22:32:59,581 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:32:59,581 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:59,591 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 6420-5213
2025-05-08 22:32:59,591 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=6, account_id=381952778) of 250
2025-05-08 22:32:59,591 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/381952778/match-history?only_stored_history=true
2025-05-08 22:32:59,591 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:32:59,867 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/381952778/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:32:59,897 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:32:59,898 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       381952778
1       381952778
2       381952778
3       381952778
4       381952778
          ...    
1054    381952778
1055    381952778
1056    381952778
1057    381952778
1058    381952778
Name: account_id, Length: 1059, dtype: int64
2025-05-08 22:32:59,898 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8588
2025-05-08 22:32:59,898 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6679
2025-05-08 22:32:59,898 [DEBUG] [root.generate_player_performance_metrics] match_total: 1059
2025-05-08 22:32:59,899 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       381952778
1       381952778
2       381952778
3       381952778
4       381952778
          ...    
1054    381952778
1055    381952778
1056    381952778
1057    381952778
1058    381952778
Name: account_id, Length: 1059, dtype: int64
2025-05-08 22:32:59,899 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:32:59,904 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:32:59,905 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:59,905 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:32:59,906 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:32:59,906 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:59,914 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 7-6
2025-05-08 22:32:59,914 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:32:59,916 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 381952778
2025-05-08 22:32:59,916 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:32:59,916 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:32:59,925 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 7479-6420
2025-05-08 22:32:59,925 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=7, account_id=1685634485) of 250
2025-05-08 22:32:59,925 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1685634485/match-history?only_stored_history=true
2025-05-08 22:32:59,926 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:00,168 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1685634485/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:00,172 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:00,173 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1685634485
1      1685634485
2      1685634485
3      1685634485
4      1685634485
          ...    
177    1685634485
178    1685634485
179    1685634485
180    1685634485
181    1685634485
Name: account_id, Length: 182, dtype: int64
2025-05-08 22:33:00,173 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1320
2025-05-08 22:33:00,173 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1018
2025-05-08 22:33:00,173 [DEBUG] [root.generate_player_performance_metrics] match_total: 182
2025-05-08 22:33:00,174 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1685634485
1      1685634485
2      1685634485
3      1685634485
4      1685634485
          ...    
177    1685634485
178    1685634485
179    1685634485
180    1685634485
181    1685634485
Name: account_id, Length: 182, dtype: int64
2025-05-08 22:33:00,174 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:00,178 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:00,179 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:00,180 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:00,180 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:00,180 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:00,188 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 8-7
2025-05-08 22:33:00,188 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:00,190 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1685634485
2025-05-08 22:33:00,190 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:00,190 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:00,196 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 7661-7479
2025-05-08 22:33:00,196 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=8, account_id=150454049) of 250
2025-05-08 22:33:00,196 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/150454049/match-history?only_stored_history=true
2025-05-08 22:33:00,196 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:00,492 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/150454049/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:00,515 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:00,515 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      150454049
1      150454049
2      150454049
3      150454049
4      150454049
         ...    
744    150454049
745    150454049
746    150454049
747    150454049
748    150454049
Name: account_id, Length: 749, dtype: int64
2025-05-08 22:33:00,515 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6480
2025-05-08 22:33:00,516 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4210
2025-05-08 22:33:00,516 [DEBUG] [root.generate_player_performance_metrics] match_total: 749
2025-05-08 22:33:00,516 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      150454049
1      150454049
2      150454049
3      150454049
4      150454049
         ...    
744    150454049
745    150454049
746    150454049
747    150454049
748    150454049
Name: account_id, Length: 749, dtype: int64
2025-05-08 22:33:00,516 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:00,521 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:00,522 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:00,522 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:00,522 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:00,523 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:00,529 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 9-8
2025-05-08 22:33:00,529 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:00,531 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 150454049
2025-05-08 22:33:00,531 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:00,532 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:00,539 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 8410-7661
2025-05-08 22:33:00,539 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=9, account_id=172423864) of 250
2025-05-08 22:33:00,539 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/172423864/match-history?only_stored_history=true
2025-05-08 22:33:00,539 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:01,040 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/172423864/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:01,112 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:01,112 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       172423864
1       172423864
2       172423864
3       172423864
4       172423864
          ...    
1112    172423864
1113    172423864
1114    172423864
1115    172423864
1116    172423864
Name: account_id, Length: 1117, dtype: int64
2025-05-08 22:33:01,113 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6677
2025-05-08 22:33:01,113 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5684
2025-05-08 22:33:01,113 [DEBUG] [root.generate_player_performance_metrics] match_total: 1117
2025-05-08 22:33:01,114 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       172423864
1       172423864
2       172423864
3       172423864
4       172423864
          ...    
1112    172423864
1113    172423864
1114    172423864
1115    172423864
1116    172423864
Name: account_id, Length: 1117, dtype: int64
2025-05-08 22:33:01,114 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:01,118 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:01,120 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:01,120 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:01,120 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:01,120 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:01,127 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 10-9
2025-05-08 22:33:01,127 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:01,130 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 172423864
2025-05-08 22:33:01,131 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:01,131 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:01,140 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 9527-8410
2025-05-08 22:33:01,140 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 4.29seconds. Processed 10 of 250 players
2025-05-08 22:33:01,140 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=10, account_id=183362050) of 250
2025-05-08 22:33:01,140 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/183362050/match-history?only_stored_history=true
2025-05-08 22:33:01,141 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:01,419 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/183362050/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:01,428 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:01,429 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      183362050
1      183362050
2      183362050
3      183362050
4      183362050
         ...    
852    183362050
853    183362050
854    183362050
855    183362050
856    183362050
Name: account_id, Length: 857, dtype: int64
2025-05-08 22:33:01,429 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6819
2025-05-08 22:33:01,429 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6221
2025-05-08 22:33:01,429 [DEBUG] [root.generate_player_performance_metrics] match_total: 857
2025-05-08 22:33:01,430 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      183362050
1      183362050
2      183362050
3      183362050
4      183362050
         ...    
852    183362050
853    183362050
854    183362050
855    183362050
856    183362050
Name: account_id, Length: 857, dtype: int64
2025-05-08 22:33:01,430 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:01,435 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:01,437 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:01,437 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:01,437 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:01,437 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:01,445 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 11-10
2025-05-08 22:33:01,445 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:01,447 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 183362050
2025-05-08 22:33:01,447 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:01,447 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:01,455 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 10384-9527
2025-05-08 22:33:01,455 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=11, account_id=344336241) of 250
2025-05-08 22:33:01,456 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/344336241/match-history?only_stored_history=true
2025-05-08 22:33:01,456 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:01,676 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/344336241/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:01,677 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:01,678 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      344336241
1      344336241
2      344336241
3      344336241
4      344336241
         ...    
110    344336241
111    344336241
112    344336241
113    344336241
114    344336241
Name: account_id, Length: 115, dtype: int64
2025-05-08 22:33:01,678 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1448
2025-05-08 22:33:01,678 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 561
2025-05-08 22:33:01,678 [DEBUG] [root.generate_player_performance_metrics] match_total: 115
2025-05-08 22:33:01,679 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      344336241
1      344336241
2      344336241
3      344336241
4      344336241
         ...    
110    344336241
111    344336241
112    344336241
113    344336241
114    344336241
Name: account_id, Length: 115, dtype: int64
2025-05-08 22:33:01,679 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:01,684 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:01,685 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:01,685 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:01,685 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:01,685 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:01,691 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 12-11
2025-05-08 22:33:01,691 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:01,693 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 344336241
2025-05-08 22:33:01,694 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:01,694 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:01,700 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 10499-10384
2025-05-08 22:33:01,700 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=12, account_id=1217082428) of 250
2025-05-08 22:33:01,700 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1217082428/match-history?only_stored_history=true
2025-05-08 22:33:01,701 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:01,946 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1217082428/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:01,954 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:01,955 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1217082428
1      1217082428
2      1217082428
3      1217082428
4      1217082428
          ...    
296    1217082428
297    1217082428
298    1217082428
299    1217082428
300    1217082428
Name: account_id, Length: 301, dtype: int64
2025-05-08 22:33:01,955 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2169
2025-05-08 22:33:01,955 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1594
2025-05-08 22:33:01,955 [DEBUG] [root.generate_player_performance_metrics] match_total: 301
2025-05-08 22:33:01,956 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1217082428
1      1217082428
2      1217082428
3      1217082428
4      1217082428
          ...    
296    1217082428
297    1217082428
298    1217082428
299    1217082428
300    1217082428
Name: account_id, Length: 301, dtype: int64
2025-05-08 22:33:01,956 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:01,961 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:01,962 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:01,963 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:01,963 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:01,963 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:01,968 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 13-12
2025-05-08 22:33:01,969 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:01,971 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1217082428
2025-05-08 22:33:01,971 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:01,971 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:01,977 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 10800-10499
2025-05-08 22:33:01,977 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=13, account_id=1000508210) of 250
2025-05-08 22:33:01,977 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1000508210/match-history?only_stored_history=true
2025-05-08 22:33:01,978 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:02,456 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1000508210/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:02,461 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:02,462 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1000508210
1      1000508210
2      1000508210
3      1000508210
4      1000508210
          ...    
786    1000508210
787    1000508210
788    1000508210
789    1000508210
790    1000508210
Name: account_id, Length: 791, dtype: int64
2025-05-08 22:33:02,462 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5794
2025-05-08 22:33:02,462 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4060
2025-05-08 22:33:02,462 [DEBUG] [root.generate_player_performance_metrics] match_total: 791
2025-05-08 22:33:02,463 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1000508210
1      1000508210
2      1000508210
3      1000508210
4      1000508210
          ...    
786    1000508210
787    1000508210
788    1000508210
789    1000508210
790    1000508210
Name: account_id, Length: 791, dtype: int64
2025-05-08 22:33:02,463 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:02,468 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:02,468 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:02,469 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:02,469 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:02,469 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:02,475 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 14-13
2025-05-08 22:33:02,475 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:02,478 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1000508210
2025-05-08 22:33:02,478 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:02,478 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:02,486 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 11591-10800
2025-05-08 22:33:02,486 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=14, account_id=1729603351) of 250
2025-05-08 22:33:02,486 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1729603351/match-history?only_stored_history=true
2025-05-08 22:33:02,486 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:02,928 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1729603351/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:02,930 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:02,930 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1729603351
1      1729603351
2      1729603351
3      1729603351
4      1729603351
          ...    
164    1729603351
165    1729603351
166    1729603351
167    1729603351
168    1729603351
Name: account_id, Length: 169, dtype: int64
2025-05-08 22:33:02,931 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1642
2025-05-08 22:33:02,931 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 551
2025-05-08 22:33:02,931 [DEBUG] [root.generate_player_performance_metrics] match_total: 169
2025-05-08 22:33:02,931 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1729603351
1      1729603351
2      1729603351
3      1729603351
4      1729603351
          ...    
164    1729603351
165    1729603351
166    1729603351
167    1729603351
168    1729603351
Name: account_id, Length: 169, dtype: int64
2025-05-08 22:33:02,932 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:02,936 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:02,937 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:02,937 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:02,937 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:02,937 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:02,945 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 15-14
2025-05-08 22:33:02,945 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:02,947 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1729603351
2025-05-08 22:33:02,947 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:02,947 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:02,952 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 11760-11591
2025-05-08 22:33:02,952 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=15, account_id=159356881) of 250
2025-05-08 22:33:02,952 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/159356881/match-history?only_stored_history=true
2025-05-08 22:33:02,953 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:03,424 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/159356881/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:03,428 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:03,428 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      159356881
1      159356881
2      159356881
3      159356881
4      159356881
         ...    
647    159356881
648    159356881
649    159356881
650    159356881
651    159356881
Name: account_id, Length: 652, dtype: int64
2025-05-08 22:33:03,428 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6072
2025-05-08 22:33:03,430 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5134
2025-05-08 22:33:03,430 [DEBUG] [root.generate_player_performance_metrics] match_total: 652
2025-05-08 22:33:03,430 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      159356881
1      159356881
2      159356881
3      159356881
4      159356881
         ...    
647    159356881
648    159356881
649    159356881
650    159356881
651    159356881
Name: account_id, Length: 652, dtype: int64
2025-05-08 22:33:03,430 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:03,434 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:03,435 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:03,435 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:03,435 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:03,436 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:03,444 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 16-15
2025-05-08 22:33:03,444 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:03,446 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 159356881
2025-05-08 22:33:03,446 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:03,446 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:03,453 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 12412-11760
2025-05-08 22:33:03,453 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=16, account_id=1532558207) of 250
2025-05-08 22:33:03,453 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1532558207/match-history?only_stored_history=true
2025-05-08 22:33:03,454 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:03,767 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1532558207/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:03,799 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:03,799 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1532558207
1       1532558207
2       1532558207
3       1532558207
4       1532558207
           ...    
1937    1532558207
1938    1532558207
1939    1532558207
1940    1532558207
1941    1532558207
Name: account_id, Length: 1942, dtype: int64
2025-05-08 22:33:03,800 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13183
2025-05-08 22:33:03,800 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9611
2025-05-08 22:33:03,800 [DEBUG] [root.generate_player_performance_metrics] match_total: 1942
2025-05-08 22:33:03,801 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1532558207
1       1532558207
2       1532558207
3       1532558207
4       1532558207
           ...    
1937    1532558207
1938    1532558207
1939    1532558207
1940    1532558207
1941    1532558207
Name: account_id, Length: 1942, dtype: int64
2025-05-08 22:33:03,801 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:03,805 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:03,806 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:03,806 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:03,806 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:03,807 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:03,817 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 17-16
2025-05-08 22:33:03,817 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:03,819 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1532558207
2025-05-08 22:33:03,819 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:03,819 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:03,836 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 14354-12412
2025-05-08 22:33:03,836 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=17, account_id=243706689) of 250
2025-05-08 22:33:03,836 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/243706689/match-history?only_stored_history=true
2025-05-08 22:33:03,837 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:04,094 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/243706689/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:04,122 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:04,122 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      243706689
1      243706689
2      243706689
3      243706689
4      243706689
         ...    
977    243706689
978    243706689
979    243706689
980    243706689
981    243706689
Name: account_id, Length: 982, dtype: int64
2025-05-08 22:33:04,123 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7736
2025-05-08 22:33:04,123 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6243
2025-05-08 22:33:04,123 [DEBUG] [root.generate_player_performance_metrics] match_total: 982
2025-05-08 22:33:04,124 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      243706689
1      243706689
2      243706689
3      243706689
4      243706689
         ...    
977    243706689
978    243706689
979    243706689
980    243706689
981    243706689
Name: account_id, Length: 982, dtype: int64
2025-05-08 22:33:04,124 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:04,128 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:04,129 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:04,130 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:04,130 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:04,130 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:04,137 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 18-17
2025-05-08 22:33:04,137 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:04,139 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 243706689
2025-05-08 22:33:04,139 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:04,139 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:04,148 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 15336-14354
2025-05-08 22:33:04,148 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=18, account_id=1098006019) of 250
2025-05-08 22:33:04,148 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1098006019/match-history?only_stored_history=true
2025-05-08 22:33:04,149 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:04,650 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1098006019/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:04,776 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:04,777 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1098006019
1       1098006019
2       1098006019
3       1098006019
4       1098006019
           ...    
1787    1098006019
1788    1098006019
1789    1098006019
1790    1098006019
1791    1098006019
Name: account_id, Length: 1792, dtype: int64
2025-05-08 22:33:04,777 [DEBUG] [root.generate_player_performance_metrics] total_kills: 17004
2025-05-08 22:33:04,777 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11733
2025-05-08 22:33:04,778 [DEBUG] [root.generate_player_performance_metrics] match_total: 1792
2025-05-08 22:33:04,779 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1098006019
1       1098006019
2       1098006019
3       1098006019
4       1098006019
           ...    
1787    1098006019
1788    1098006019
1789    1098006019
1790    1098006019
1791    1098006019
Name: account_id, Length: 1792, dtype: int64
2025-05-08 22:33:04,779 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:04,784 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:04,785 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:04,785 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:04,785 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:04,785 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:04,793 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 19-18
2025-05-08 22:33:04,793 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:04,796 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1098006019
2025-05-08 22:33:04,796 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:04,796 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:04,811 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 17128-15336
2025-05-08 22:33:04,811 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=19, account_id=99576706) of 250
2025-05-08 22:33:04,811 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/99576706/match-history?only_stored_history=true
2025-05-08 22:33:04,811 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:05,305 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/99576706/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:05,400 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:05,401 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       99576706
1       99576706
2       99576706
3       99576706
4       99576706
          ...   
1949    99576706
1950    99576706
1951    99576706
1952    99576706
1953    99576706
Name: account_id, Length: 1954, dtype: int64
2025-05-08 22:33:05,401 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13744
2025-05-08 22:33:05,401 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10042
2025-05-08 22:33:05,401 [DEBUG] [root.generate_player_performance_metrics] match_total: 1954
2025-05-08 22:33:05,402 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       99576706
1       99576706
2       99576706
3       99576706
4       99576706
          ...   
1949    99576706
1950    99576706
1951    99576706
1952    99576706
1953    99576706
Name: account_id, Length: 1954, dtype: int64
2025-05-08 22:33:05,402 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:05,407 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:05,408 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:05,408 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:05,408 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:05,408 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:05,419 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 20-19
2025-05-08 22:33:05,419 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:05,421 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 99576706
2025-05-08 22:33:05,422 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:05,422 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:05,438 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 19082-17128
2025-05-08 22:33:05,438 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 8.59seconds. Processed 20 of 250 players
2025-05-08 22:33:05,439 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=20, account_id=1141865532) of 250
2025-05-08 22:33:05,439 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1141865532/match-history?only_stored_history=true
2025-05-08 22:33:05,440 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:05,928 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1141865532/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:05,936 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:05,936 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1141865532
1      1141865532
2      1141865532
3      1141865532
4      1141865532
          ...    
291    1141865532
292    1141865532
293    1141865532
294    1141865532
295    1141865532
Name: account_id, Length: 296, dtype: int64
2025-05-08 22:33:05,937 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3060
2025-05-08 22:33:05,937 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2190
2025-05-08 22:33:05,937 [DEBUG] [root.generate_player_performance_metrics] match_total: 296
2025-05-08 22:33:05,938 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1141865532
1      1141865532
2      1141865532
3      1141865532
4      1141865532
          ...    
291    1141865532
292    1141865532
293    1141865532
294    1141865532
295    1141865532
Name: account_id, Length: 296, dtype: int64
2025-05-08 22:33:05,938 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:05,942 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:05,944 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:05,944 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:05,944 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:05,944 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:05,950 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 21-20
2025-05-08 22:33:05,950 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:05,952 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1141865532
2025-05-08 22:33:05,953 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:05,953 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:05,960 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 19378-19082
2025-05-08 22:33:05,960 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=21, account_id=1147931220) of 250
2025-05-08 22:33:05,960 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1147931220/match-history?only_stored_history=true
2025-05-08 22:33:05,960 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:06,227 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1147931220/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:06,232 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:06,233 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1147931220
1      1147931220
2      1147931220
3      1147931220
4      1147931220
          ...    
194    1147931220
195    1147931220
196    1147931220
197    1147931220
198    1147931220
Name: account_id, Length: 199, dtype: int64
2025-05-08 22:33:06,233 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1597
2025-05-08 22:33:06,233 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1262
2025-05-08 22:33:06,233 [DEBUG] [root.generate_player_performance_metrics] match_total: 199
2025-05-08 22:33:06,234 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1147931220
1      1147931220
2      1147931220
3      1147931220
4      1147931220
          ...    
194    1147931220
195    1147931220
196    1147931220
197    1147931220
198    1147931220
Name: account_id, Length: 199, dtype: int64
2025-05-08 22:33:06,234 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:06,239 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:06,240 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:06,240 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:06,240 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:06,240 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:06,248 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 22-21
2025-05-08 22:33:06,248 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:06,250 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1147931220
2025-05-08 22:33:06,250 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:06,250 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:06,256 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 19577-19378
2025-05-08 22:33:06,256 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=22, account_id=842141322) of 250
2025-05-08 22:33:06,256 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/842141322/match-history?only_stored_history=true
2025-05-08 22:33:06,257 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:06,741 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/842141322/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:06,761 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:06,762 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      842141322
1      842141322
2      842141322
3      842141322
4      842141322
         ...    
813    842141322
814    842141322
815    842141322
816    842141322
817    842141322
Name: account_id, Length: 818, dtype: int64
2025-05-08 22:33:06,762 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7642
2025-05-08 22:33:06,762 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5952
2025-05-08 22:33:06,762 [DEBUG] [root.generate_player_performance_metrics] match_total: 818
2025-05-08 22:33:06,763 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      842141322
1      842141322
2      842141322
3      842141322
4      842141322
         ...    
813    842141322
814    842141322
815    842141322
816    842141322
817    842141322
Name: account_id, Length: 818, dtype: int64
2025-05-08 22:33:06,763 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:06,769 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:06,770 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:06,770 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:06,770 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:06,770 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:06,777 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 23-22
2025-05-08 22:33:06,777 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:06,779 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 842141322
2025-05-08 22:33:06,779 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:06,779 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:06,786 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 20395-19577
2025-05-08 22:33:06,788 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=23, account_id=1592121821) of 250
2025-05-08 22:33:06,788 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1592121821/match-history?only_stored_history=true
2025-05-08 22:33:06,788 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:07,369 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1592121821/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:07,459 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:07,460 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1592121821
1       1592121821
2       1592121821
3       1592121821
4       1592121821
           ...    
1636    1592121821
1637    1592121821
1638    1592121821
1639    1592121821
1640    1592121821
Name: account_id, Length: 1641, dtype: int64
2025-05-08 22:33:07,460 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11332
2025-05-08 22:33:07,460 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8284
2025-05-08 22:33:07,460 [DEBUG] [root.generate_player_performance_metrics] match_total: 1641
2025-05-08 22:33:07,461 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1592121821
1       1592121821
2       1592121821
3       1592121821
4       1592121821
           ...    
1636    1592121821
1637    1592121821
1638    1592121821
1639    1592121821
1640    1592121821
Name: account_id, Length: 1641, dtype: int64
2025-05-08 22:33:07,461 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:07,466 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:07,467 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:07,467 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:07,467 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:07,468 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:07,477 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 24-23
2025-05-08 22:33:07,477 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:07,479 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1592121821
2025-05-08 22:33:07,479 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:07,480 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:07,492 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 22036-20395
2025-05-08 22:33:07,492 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=24, account_id=74409621) of 250
2025-05-08 22:33:07,492 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/74409621/match-history?only_stored_history=true
2025-05-08 22:33:07,493 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:07,874 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/74409621/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:07,895 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:07,896 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      74409621
1      74409621
2      74409621
3      74409621
4      74409621
         ...   
711    74409621
712    74409621
713    74409621
714    74409621
715    74409621
Name: account_id, Length: 716, dtype: int64
2025-05-08 22:33:07,896 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6010
2025-05-08 22:33:07,896 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4428
2025-05-08 22:33:07,896 [DEBUG] [root.generate_player_performance_metrics] match_total: 716
2025-05-08 22:33:07,897 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      74409621
1      74409621
2      74409621
3      74409621
4      74409621
         ...   
711    74409621
712    74409621
713    74409621
714    74409621
715    74409621
Name: account_id, Length: 716, dtype: int64
2025-05-08 22:33:07,897 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:07,901 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:07,902 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:07,903 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:07,903 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:07,903 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:07,912 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 25-24
2025-05-08 22:33:07,912 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:07,914 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 74409621
2025-05-08 22:33:07,914 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:07,914 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:07,922 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 22752-22036
2025-05-08 22:33:07,922 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=25, account_id=89408055) of 250
2025-05-08 22:33:07,922 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/89408055/match-history?only_stored_history=true
2025-05-08 22:33:07,922 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:08,491 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/89408055/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:08,495 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:08,496 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      89408055
1      89408055
2      89408055
3      89408055
4      89408055
         ...   
583    89408055
584    89408055
585    89408055
586    89408055
587    89408055
Name: account_id, Length: 588, dtype: int64
2025-05-08 22:33:08,496 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3654
2025-05-08 22:33:08,496 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4465
2025-05-08 22:33:08,496 [DEBUG] [root.generate_player_performance_metrics] match_total: 588
2025-05-08 22:33:08,497 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      89408055
1      89408055
2      89408055
3      89408055
4      89408055
         ...   
583    89408055
584    89408055
585    89408055
586    89408055
587    89408055
Name: account_id, Length: 588, dtype: int64
2025-05-08 22:33:08,497 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:08,502 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:08,503 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:08,504 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:08,504 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:08,504 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:08,511 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 26-25
2025-05-08 22:33:08,511 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:08,513 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 89408055
2025-05-08 22:33:08,513 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:08,513 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:08,521 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 23340-22752
2025-05-08 22:33:08,521 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=26, account_id=1869028605) of 250
2025-05-08 22:33:08,521 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1869028605/match-history?only_stored_history=true
2025-05-08 22:33:08,521 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:09,038 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1869028605/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:09,041 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:09,041 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1869028605
1      1869028605
2      1869028605
3      1869028605
4      1869028605
          ...    
262    1869028605
263    1869028605
264    1869028605
265    1869028605
266    1869028605
Name: account_id, Length: 267, dtype: int64
2025-05-08 22:33:09,042 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2159
2025-05-08 22:33:09,042 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2114
2025-05-08 22:33:09,042 [DEBUG] [root.generate_player_performance_metrics] match_total: 267
2025-05-08 22:33:09,043 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1869028605
1      1869028605
2      1869028605
3      1869028605
4      1869028605
          ...    
262    1869028605
263    1869028605
264    1869028605
265    1869028605
266    1869028605
Name: account_id, Length: 267, dtype: int64
2025-05-08 22:33:09,043 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:09,047 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:09,048 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:09,048 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:09,048 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:09,048 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:09,056 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 27-26
2025-05-08 22:33:09,056 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:09,057 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1869028605
2025-05-08 22:33:09,058 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:09,058 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:09,064 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 23607-23340
2025-05-08 22:33:09,064 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=27, account_id=104859703) of 250
2025-05-08 22:33:09,064 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/104859703/match-history?only_stored_history=true
2025-05-08 22:33:09,065 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:09,500 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/104859703/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:09,516 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:09,516 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      104859703
1      104859703
2      104859703
3      104859703
4      104859703
         ...    
587    104859703
588    104859703
589    104859703
590    104859703
591    104859703
Name: account_id, Length: 592, dtype: int64
2025-05-08 22:33:09,517 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4119
2025-05-08 22:33:09,517 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3795
2025-05-08 22:33:09,517 [DEBUG] [root.generate_player_performance_metrics] match_total: 592
2025-05-08 22:33:09,518 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      104859703
1      104859703
2      104859703
3      104859703
4      104859703
         ...    
587    104859703
588    104859703
589    104859703
590    104859703
591    104859703
Name: account_id, Length: 592, dtype: int64
2025-05-08 22:33:09,518 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:09,522 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:09,524 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:09,524 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:09,524 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:09,524 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:09,531 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 28-27
2025-05-08 22:33:09,531 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:09,533 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 104859703
2025-05-08 22:33:09,533 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:09,533 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:09,540 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 24199-23607
2025-05-08 22:33:09,540 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=28, account_id=951692856) of 250
2025-05-08 22:33:09,540 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/951692856/match-history?only_stored_history=true
2025-05-08 22:33:09,540 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:10,171 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/951692856/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:10,175 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:10,176 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      951692856
1      951692856
2      951692856
3      951692856
4      951692856
         ...    
689    951692856
690    951692856
691    951692856
692    951692856
693    951692856
Name: account_id, Length: 694, dtype: int64
2025-05-08 22:33:10,176 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6678
2025-05-08 22:33:10,176 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3153
2025-05-08 22:33:10,176 [DEBUG] [root.generate_player_performance_metrics] match_total: 694
2025-05-08 22:33:10,177 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      951692856
1      951692856
2      951692856
3      951692856
4      951692856
         ...    
689    951692856
690    951692856
691    951692856
692    951692856
693    951692856
Name: account_id, Length: 694, dtype: int64
2025-05-08 22:33:10,177 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:10,182 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:10,183 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:10,183 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:10,183 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:10,183 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:10,191 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 29-28
2025-05-08 22:33:10,191 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:10,193 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 951692856
2025-05-08 22:33:10,193 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:10,193 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:10,201 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 24893-24199
2025-05-08 22:33:10,201 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=29, account_id=1361339717) of 250
2025-05-08 22:33:10,201 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1361339717/match-history?only_stored_history=true
2025-05-08 22:33:10,202 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:10,854 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1361339717/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:10,862 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:10,862 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1361339717
1       1361339717
2       1361339717
3       1361339717
4       1361339717
           ...    
1241    1361339717
1242    1361339717
1243    1361339717
1244    1361339717
1245    1361339717
Name: account_id, Length: 1246, dtype: int64
2025-05-08 22:33:10,863 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9819
2025-05-08 22:33:10,863 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8490
2025-05-08 22:33:10,863 [DEBUG] [root.generate_player_performance_metrics] match_total: 1246
2025-05-08 22:33:10,863 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1361339717
1       1361339717
2       1361339717
3       1361339717
4       1361339717
           ...    
1241    1361339717
1242    1361339717
1243    1361339717
1244    1361339717
1245    1361339717
Name: account_id, Length: 1246, dtype: int64
2025-05-08 22:33:10,864 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:10,868 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:10,869 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:10,869 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:10,869 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:10,869 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:10,878 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 30-29
2025-05-08 22:33:10,878 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:10,880 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1361339717
2025-05-08 22:33:10,880 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:10,880 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:10,891 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 26139-24893
2025-05-08 22:33:10,891 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 14.04seconds. Processed 30 of 250 players
2025-05-08 22:33:10,891 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=30, account_id=196965175) of 250
2025-05-08 22:33:10,891 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/196965175/match-history?only_stored_history=true
2025-05-08 22:33:10,892 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:11,406 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/196965175/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:11,491 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:11,491 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       196965175
1       196965175
2       196965175
3       196965175
4       196965175
          ...    
1500    196965175
1501    196965175
1502    196965175
1503    196965175
1504    196965175
Name: account_id, Length: 1505, dtype: int64
2025-05-08 22:33:11,492 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11642
2025-05-08 22:33:11,492 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11406
2025-05-08 22:33:11,492 [DEBUG] [root.generate_player_performance_metrics] match_total: 1505
2025-05-08 22:33:11,493 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       196965175
1       196965175
2       196965175
3       196965175
4       196965175
          ...    
1500    196965175
1501    196965175
1502    196965175
1503    196965175
1504    196965175
Name: account_id, Length: 1505, dtype: int64
2025-05-08 22:33:11,493 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:11,499 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:11,500 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:11,500 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:11,500 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:11,500 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:11,508 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 31-30
2025-05-08 22:33:11,508 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:11,511 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 196965175
2025-05-08 22:33:11,511 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:11,511 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:11,523 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 27644-26139
2025-05-08 22:33:11,523 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=31, account_id=147382596) of 250
2025-05-08 22:33:11,523 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/147382596/match-history?only_stored_history=true
2025-05-08 22:33:11,523 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:11,827 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/147382596/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:11,916 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:11,917 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       147382596
1       147382596
2       147382596
3       147382596
4       147382596
          ...    
1278    147382596
1279    147382596
1280    147382596
1281    147382596
1282    147382596
Name: account_id, Length: 1283, dtype: int64
2025-05-08 22:33:11,917 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10932
2025-05-08 22:33:11,917 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6494
2025-05-08 22:33:11,917 [DEBUG] [root.generate_player_performance_metrics] match_total: 1283
2025-05-08 22:33:11,919 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       147382596
1       147382596
2       147382596
3       147382596
4       147382596
          ...    
1278    147382596
1279    147382596
1280    147382596
1281    147382596
1282    147382596
Name: account_id, Length: 1283, dtype: int64
2025-05-08 22:33:11,919 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:11,924 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:11,925 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:11,925 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:11,925 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:11,925 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:11,934 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 32-31
2025-05-08 22:33:11,934 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:11,936 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 147382596
2025-05-08 22:33:11,937 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:11,937 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:11,947 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 28927-27644
2025-05-08 22:33:11,947 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=32, account_id=1877805508) of 250
2025-05-08 22:33:11,947 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1877805508/match-history?only_stored_history=true
2025-05-08 22:33:11,948 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:12,383 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1877805508/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:12,384 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:12,385 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1877805508
1     1877805508
2     1877805508
3     1877805508
4     1877805508
         ...    
57    1877805508
58    1877805508
59    1877805508
60    1877805508
61    1877805508
Name: account_id, Length: 62, dtype: int64
2025-05-08 22:33:12,385 [DEBUG] [root.generate_player_performance_metrics] total_kills: 623
2025-05-08 22:33:12,385 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 450
2025-05-08 22:33:12,385 [DEBUG] [root.generate_player_performance_metrics] match_total: 62
2025-05-08 22:33:12,386 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1877805508
1     1877805508
2     1877805508
3     1877805508
4     1877805508
         ...    
57    1877805508
58    1877805508
59    1877805508
60    1877805508
61    1877805508
Name: account_id, Length: 62, dtype: int64
2025-05-08 22:33:12,386 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:12,390 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:12,391 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:12,392 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:12,392 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:12,392 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:12,399 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 33-32
2025-05-08 22:33:12,399 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:12,401 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1877805508
2025-05-08 22:33:12,401 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:12,401 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:12,407 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 28989-28927
2025-05-08 22:33:12,407 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=33, account_id=46150512) of 250
2025-05-08 22:33:12,407 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/46150512/match-history?only_stored_history=true
2025-05-08 22:33:12,408 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:13,119 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/46150512/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:13,196 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:13,197 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       46150512
1       46150512
2       46150512
3       46150512
4       46150512
          ...   
1334    46150512
1335    46150512
1336    46150512
1337    46150512
1338    46150512
Name: account_id, Length: 1339, dtype: int64
2025-05-08 22:33:13,197 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10081
2025-05-08 22:33:13,197 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10785
2025-05-08 22:33:13,197 [DEBUG] [root.generate_player_performance_metrics] match_total: 1339
2025-05-08 22:33:13,198 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       46150512
1       46150512
2       46150512
3       46150512
4       46150512
          ...   
1334    46150512
1335    46150512
1336    46150512
1337    46150512
1338    46150512
Name: account_id, Length: 1339, dtype: int64
2025-05-08 22:33:13,198 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:13,203 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:13,204 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:13,204 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:13,204 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:13,205 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:13,213 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 34-33
2025-05-08 22:33:13,213 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:13,216 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 46150512
2025-05-08 22:33:13,216 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:13,216 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:13,228 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 30328-28989
2025-05-08 22:33:13,228 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=34, account_id=122953761) of 250
2025-05-08 22:33:13,228 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/122953761/match-history?only_stored_history=true
2025-05-08 22:33:13,228 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:13,837 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/122953761/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:13,942 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:13,943 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       122953761
1       122953761
2       122953761
3       122953761
4       122953761
          ...    
1537    122953761
1538    122953761
1539    122953761
1540    122953761
1541    122953761
Name: account_id, Length: 1542, dtype: int64
2025-05-08 22:33:13,943 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8463
2025-05-08 22:33:13,943 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9219
2025-05-08 22:33:13,943 [DEBUG] [root.generate_player_performance_metrics] match_total: 1542
2025-05-08 22:33:13,944 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       122953761
1       122953761
2       122953761
3       122953761
4       122953761
          ...    
1537    122953761
1538    122953761
1539    122953761
1540    122953761
1541    122953761
Name: account_id, Length: 1542, dtype: int64
2025-05-08 22:33:13,944 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:13,949 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:13,950 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:13,950 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:13,950 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:13,950 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:13,961 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 35-34
2025-05-08 22:33:13,961 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:13,963 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 122953761
2025-05-08 22:33:13,963 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:13,964 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:13,976 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 31870-30328
2025-05-08 22:33:13,976 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=35, account_id=228763294) of 250
2025-05-08 22:33:13,976 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/228763294/match-history?only_stored_history=true
2025-05-08 22:33:13,977 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:14,520 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/228763294/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:14,530 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:14,530 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      228763294
1      228763294
2      228763294
3      228763294
4      228763294
         ...    
433    228763294
434    228763294
435    228763294
436    228763294
437    228763294
Name: account_id, Length: 438, dtype: int64
2025-05-08 22:33:14,531 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3088
2025-05-08 22:33:14,531 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3277
2025-05-08 22:33:14,531 [DEBUG] [root.generate_player_performance_metrics] match_total: 438
2025-05-08 22:33:14,532 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      228763294
1      228763294
2      228763294
3      228763294
4      228763294
         ...    
433    228763294
434    228763294
435    228763294
436    228763294
437    228763294
Name: account_id, Length: 438, dtype: int64
2025-05-08 22:33:14,532 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:14,537 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:14,538 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:14,538 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:14,538 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:14,538 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:14,545 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 36-35
2025-05-08 22:33:14,545 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:14,547 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 228763294
2025-05-08 22:33:14,547 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:14,547 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:14,554 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 32308-31870
2025-05-08 22:33:14,554 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=36, account_id=407786402) of 250
2025-05-08 22:33:14,554 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/407786402/match-history?only_stored_history=true
2025-05-08 22:33:14,555 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:15,164 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/407786402/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:15,170 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:15,171 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      407786402
1      407786402
2      407786402
3      407786402
4      407786402
         ...    
942    407786402
943    407786402
944    407786402
945    407786402
946    407786402
Name: account_id, Length: 947, dtype: int64
2025-05-08 22:33:15,171 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10078
2025-05-08 22:33:15,171 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4901
2025-05-08 22:33:15,171 [DEBUG] [root.generate_player_performance_metrics] match_total: 947
2025-05-08 22:33:15,172 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      407786402
1      407786402
2      407786402
3      407786402
4      407786402
         ...    
942    407786402
943    407786402
944    407786402
945    407786402
946    407786402
Name: account_id, Length: 947, dtype: int64
2025-05-08 22:33:15,172 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:15,177 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:15,177 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:15,177 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:15,177 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:15,177 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:15,186 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 37-36
2025-05-08 22:33:15,186 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:15,188 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 407786402
2025-05-08 22:33:15,188 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:15,188 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:15,197 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 33255-32308
2025-05-08 22:33:15,197 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=37, account_id=1005165764) of 250
2025-05-08 22:33:15,197 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1005165764/match-history?only_stored_history=true
2025-05-08 22:33:15,197 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:15,719 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1005165764/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:15,723 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:15,724 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1005165764
1      1005165764
2      1005165764
3      1005165764
4      1005165764
          ...    
593    1005165764
594    1005165764
595    1005165764
596    1005165764
597    1005165764
Name: account_id, Length: 598, dtype: int64
2025-05-08 22:33:15,724 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4742
2025-05-08 22:33:15,724 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2831
2025-05-08 22:33:15,724 [DEBUG] [root.generate_player_performance_metrics] match_total: 598
2025-05-08 22:33:15,725 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1005165764
1      1005165764
2      1005165764
3      1005165764
4      1005165764
          ...    
593    1005165764
594    1005165764
595    1005165764
596    1005165764
597    1005165764
Name: account_id, Length: 598, dtype: int64
2025-05-08 22:33:15,725 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:15,730 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:15,731 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:15,731 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:15,731 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:15,731 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:15,738 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 38-37
2025-05-08 22:33:15,738 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:15,740 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1005165764
2025-05-08 22:33:15,740 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:15,741 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:15,748 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 33853-33255
2025-05-08 22:33:15,748 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=38, account_id=136199577) of 250
2025-05-08 22:33:15,748 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/136199577/match-history?only_stored_history=true
2025-05-08 22:33:15,748 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:16,208 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/136199577/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:16,217 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:16,217 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       136199577
1       136199577
2       136199577
3       136199577
4       136199577
          ...    
1305    136199577
1306    136199577
1307    136199577
1308    136199577
1309    136199577
Name: account_id, Length: 1310, dtype: int64
2025-05-08 22:33:16,218 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9660
2025-05-08 22:33:16,218 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8998
2025-05-08 22:33:16,218 [DEBUG] [root.generate_player_performance_metrics] match_total: 1310
2025-05-08 22:33:16,219 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       136199577
1       136199577
2       136199577
3       136199577
4       136199577
          ...    
1305    136199577
1306    136199577
1307    136199577
1308    136199577
1309    136199577
Name: account_id, Length: 1310, dtype: int64
2025-05-08 22:33:16,219 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:16,223 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:16,225 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:16,225 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:16,225 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:16,225 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:16,234 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 39-38
2025-05-08 22:33:16,234 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:16,236 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 136199577
2025-05-08 22:33:16,236 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:16,236 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:16,247 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 35163-33853
2025-05-08 22:33:16,247 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=39, account_id=172309032) of 250
2025-05-08 22:33:16,247 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/172309032/match-history?only_stored_history=true
2025-05-08 22:33:16,248 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:16,862 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/172309032/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:16,936 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:16,937 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       172309032
1       172309032
2       172309032
3       172309032
4       172309032
          ...    
1275    172309032
1276    172309032
1277    172309032
1278    172309032
1279    172309032
Name: account_id, Length: 1280, dtype: int64
2025-05-08 22:33:16,937 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6535
2025-05-08 22:33:16,937 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8157
2025-05-08 22:33:16,937 [DEBUG] [root.generate_player_performance_metrics] match_total: 1280
2025-05-08 22:33:16,938 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       172309032
1       172309032
2       172309032
3       172309032
4       172309032
          ...    
1275    172309032
1276    172309032
1277    172309032
1278    172309032
1279    172309032
Name: account_id, Length: 1280, dtype: int64
2025-05-08 22:33:16,938 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:16,943 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:16,944 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:16,944 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:16,944 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:16,944 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:16,952 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 40-39
2025-05-08 22:33:16,952 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:16,954 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 172309032
2025-05-08 22:33:16,954 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:16,954 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:16,965 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 36443-35163
2025-05-08 22:33:16,965 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 20.12seconds. Processed 40 of 250 players
2025-05-08 22:33:16,966 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=40, account_id=51991843) of 250
2025-05-08 22:33:16,966 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/51991843/match-history?only_stored_history=true
2025-05-08 22:33:16,966 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:17,522 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/51991843/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:17,612 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:17,614 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       51991843
1       51991843
2       51991843
3       51991843
4       51991843
          ...   
1097    51991843
1098    51991843
1099    51991843
1100    51991843
1101    51991843
Name: account_id, Length: 1102, dtype: int64
2025-05-08 22:33:17,614 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9583
2025-05-08 22:33:17,614 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5030
2025-05-08 22:33:17,614 [DEBUG] [root.generate_player_performance_metrics] match_total: 1102
2025-05-08 22:33:17,615 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       51991843
1       51991843
2       51991843
3       51991843
4       51991843
          ...   
1097    51991843
1098    51991843
1099    51991843
1100    51991843
1101    51991843
Name: account_id, Length: 1102, dtype: int64
2025-05-08 22:33:17,615 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:17,619 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:17,621 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:17,621 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:17,621 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:17,621 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:17,628 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 41-40
2025-05-08 22:33:17,628 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:17,630 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 51991843
2025-05-08 22:33:17,631 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:17,631 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:17,641 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 37545-36443
2025-05-08 22:33:17,641 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=41, account_id=98750316) of 250
2025-05-08 22:33:17,641 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/98750316/match-history?only_stored_history=true
2025-05-08 22:33:17,642 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:18,001 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/98750316/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:18,013 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:18,013 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       98750316
1       98750316
2       98750316
3       98750316
4       98750316
          ...   
1026    98750316
1027    98750316
1028    98750316
1029    98750316
1030    98750316
Name: account_id, Length: 1031, dtype: int64
2025-05-08 22:33:18,013 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7832
2025-05-08 22:33:18,013 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7795
2025-05-08 22:33:18,013 [DEBUG] [root.generate_player_performance_metrics] match_total: 1031
2025-05-08 22:33:18,014 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       98750316
1       98750316
2       98750316
3       98750316
4       98750316
          ...   
1026    98750316
1027    98750316
1028    98750316
1029    98750316
1030    98750316
Name: account_id, Length: 1031, dtype: int64
2025-05-08 22:33:18,014 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:18,019 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:18,020 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:18,020 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:18,020 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:18,020 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:18,027 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 42-41
2025-05-08 22:33:18,027 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:18,029 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 98750316
2025-05-08 22:33:18,029 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:18,029 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:18,038 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 38576-37545
2025-05-08 22:33:18,040 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=42, account_id=1068873718) of 250
2025-05-08 22:33:18,040 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1068873718/match-history?only_stored_history=true
2025-05-08 22:33:18,040 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:18,362 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1068873718/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:18,455 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:18,455 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1068873718
1       1068873718
2       1068873718
3       1068873718
4       1068873718
           ...    
1338    1068873718
1339    1068873718
1340    1068873718
1341    1068873718
1342    1068873718
Name: account_id, Length: 1343, dtype: int64
2025-05-08 22:33:18,456 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12506
2025-05-08 22:33:18,456 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7759
2025-05-08 22:33:18,456 [DEBUG] [root.generate_player_performance_metrics] match_total: 1343
2025-05-08 22:33:18,457 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1068873718
1       1068873718
2       1068873718
3       1068873718
4       1068873718
           ...    
1338    1068873718
1339    1068873718
1340    1068873718
1341    1068873718
1342    1068873718
Name: account_id, Length: 1343, dtype: int64
2025-05-08 22:33:18,457 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:18,463 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:18,464 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:18,464 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:18,464 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:18,464 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:18,473 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 43-42
2025-05-08 22:33:18,473 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:18,476 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1068873718
2025-05-08 22:33:18,476 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:18,477 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:18,487 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 39919-38576
2025-05-08 22:33:18,488 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=43, account_id=1056765148) of 250
2025-05-08 22:33:18,488 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1056765148/match-history?only_stored_history=true
2025-05-08 22:33:18,488 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:19,013 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1056765148/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:19,084 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:19,085 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1056765148
1       1056765148
2       1056765148
3       1056765148
4       1056765148
           ...    
1278    1056765148
1279    1056765148
1280    1056765148
1281    1056765148
1282    1056765148
Name: account_id, Length: 1283, dtype: int64
2025-05-08 22:33:19,085 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10325
2025-05-08 22:33:19,085 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10467
2025-05-08 22:33:19,085 [DEBUG] [root.generate_player_performance_metrics] match_total: 1283
2025-05-08 22:33:19,086 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1056765148
1       1056765148
2       1056765148
3       1056765148
4       1056765148
           ...    
1278    1056765148
1279    1056765148
1280    1056765148
1281    1056765148
1282    1056765148
Name: account_id, Length: 1283, dtype: int64
2025-05-08 22:33:19,086 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:19,092 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:19,093 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:19,093 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:19,093 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:19,093 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:19,102 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 44-43
2025-05-08 22:33:19,102 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:19,105 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1056765148
2025-05-08 22:33:19,105 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:19,105 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:19,116 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 41202-39919
2025-05-08 22:33:19,117 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=44, account_id=1652220580) of 250
2025-05-08 22:33:19,117 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1652220580/match-history?only_stored_history=true
2025-05-08 22:33:19,117 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:19,631 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1652220580/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:19,633 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:19,633 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1652220580
1      1652220580
2      1652220580
3      1652220580
4      1652220580
          ...    
116    1652220580
117    1652220580
118    1652220580
119    1652220580
120    1652220580
Name: account_id, Length: 121, dtype: int64
2025-05-08 22:33:19,634 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1340
2025-05-08 22:33:19,634 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 642
2025-05-08 22:33:19,634 [DEBUG] [root.generate_player_performance_metrics] match_total: 121
2025-05-08 22:33:19,635 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1652220580
1      1652220580
2      1652220580
3      1652220580
4      1652220580
          ...    
116    1652220580
117    1652220580
118    1652220580
119    1652220580
120    1652220580
Name: account_id, Length: 121, dtype: int64
2025-05-08 22:33:19,635 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:19,639 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:19,641 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:19,641 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:19,641 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:19,641 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:19,648 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 45-44
2025-05-08 22:33:19,648 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:19,650 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1652220580
2025-05-08 22:33:19,650 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:19,650 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:19,656 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 41323-41202
2025-05-08 22:33:19,656 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=45, account_id=90617397) of 250
2025-05-08 22:33:19,656 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/90617397/match-history?only_stored_history=true
2025-05-08 22:33:19,656 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:20,271 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/90617397/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:20,277 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:20,277 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      90617397
1      90617397
2      90617397
3      90617397
4      90617397
         ...   
858    90617397
859    90617397
860    90617397
861    90617397
862    90617397
Name: account_id, Length: 863, dtype: int64
2025-05-08 22:33:20,278 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8217
2025-05-08 22:33:20,278 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6122
2025-05-08 22:33:20,278 [DEBUG] [root.generate_player_performance_metrics] match_total: 863
2025-05-08 22:33:20,279 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      90617397
1      90617397
2      90617397
3      90617397
4      90617397
         ...   
858    90617397
859    90617397
860    90617397
861    90617397
862    90617397
Name: account_id, Length: 863, dtype: int64
2025-05-08 22:33:20,279 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:20,283 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:20,284 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:20,284 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:20,284 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:20,284 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:20,293 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 46-45
2025-05-08 22:33:20,294 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:20,296 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 90617397
2025-05-08 22:33:20,296 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:20,296 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:20,306 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 42186-41323
2025-05-08 22:33:20,306 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=46, account_id=110088215) of 250
2025-05-08 22:33:20,306 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/110088215/match-history?only_stored_history=true
2025-05-08 22:33:20,307 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:20,848 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/110088215/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:20,937 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:20,938 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       110088215
1       110088215
2       110088215
3       110088215
4       110088215
          ...    
1353    110088215
1354    110088215
1355    110088215
1356    110088215
1357    110088215
Name: account_id, Length: 1358, dtype: int64
2025-05-08 22:33:20,938 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11806
2025-05-08 22:33:20,938 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8183
2025-05-08 22:33:20,938 [DEBUG] [root.generate_player_performance_metrics] match_total: 1358
2025-05-08 22:33:20,939 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       110088215
1       110088215
2       110088215
3       110088215
4       110088215
          ...    
1353    110088215
1354    110088215
1355    110088215
1356    110088215
1357    110088215
Name: account_id, Length: 1358, dtype: int64
2025-05-08 22:33:20,939 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:20,944 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:20,945 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:20,945 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:20,945 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:20,945 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:20,953 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 47-46
2025-05-08 22:33:20,953 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:20,955 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 110088215
2025-05-08 22:33:20,956 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:20,956 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:20,967 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 43544-42186
2025-05-08 22:33:20,967 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=47, account_id=102794784) of 250
2025-05-08 22:33:20,967 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/102794784/match-history?only_stored_history=true
2025-05-08 22:33:20,967 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:21,474 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/102794784/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:21,480 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:21,481 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      102794784
1      102794784
2      102794784
3      102794784
4      102794784
         ...    
862    102794784
863    102794784
864    102794784
865    102794784
866    102794784
Name: account_id, Length: 867, dtype: int64
2025-05-08 22:33:21,481 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5999
2025-05-08 22:33:21,481 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5955
2025-05-08 22:33:21,481 [DEBUG] [root.generate_player_performance_metrics] match_total: 867
2025-05-08 22:33:21,482 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      102794784
1      102794784
2      102794784
3      102794784
4      102794784
         ...    
862    102794784
863    102794784
864    102794784
865    102794784
866    102794784
Name: account_id, Length: 867, dtype: int64
2025-05-08 22:33:21,482 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:21,487 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:21,488 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:21,488 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:21,488 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:21,488 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:21,497 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 48-47
2025-05-08 22:33:21,497 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:21,499 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 102794784
2025-05-08 22:33:21,500 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:21,500 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:21,508 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 44411-43544
2025-05-08 22:33:21,508 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=48, account_id=1043233109) of 250
2025-05-08 22:33:21,508 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1043233109/match-history?only_stored_history=true
2025-05-08 22:33:21,508 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:22,127 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1043233109/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:22,347 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:22,348 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1043233109
1       1043233109
2       1043233109
3       1043233109
4       1043233109
           ...    
1149    1043233109
1150    1043233109
1151    1043233109
1152    1043233109
1153    1043233109
Name: account_id, Length: 1154, dtype: int64
2025-05-08 22:33:22,348 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9121
2025-05-08 22:33:22,349 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8327
2025-05-08 22:33:22,349 [DEBUG] [root.generate_player_performance_metrics] match_total: 1154
2025-05-08 22:33:22,350 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1043233109
1       1043233109
2       1043233109
3       1043233109
4       1043233109
           ...    
1149    1043233109
1150    1043233109
1151    1043233109
1152    1043233109
1153    1043233109
Name: account_id, Length: 1154, dtype: int64
2025-05-08 22:33:22,350 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:22,355 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:22,356 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:22,356 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:22,356 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:22,357 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:22,364 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 49-48
2025-05-08 22:33:22,364 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:22,366 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1043233109
2025-05-08 22:33:22,367 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:22,367 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:22,377 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 45565-44411
2025-05-08 22:33:22,377 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=49, account_id=1110599051) of 250
2025-05-08 22:33:22,377 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1110599051/match-history?only_stored_history=true
2025-05-08 22:33:22,378 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:22,798 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1110599051/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:22,801 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:22,802 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1110599051
1      1110599051
2      1110599051
3      1110599051
4      1110599051
          ...    
352    1110599051
353    1110599051
354    1110599051
355    1110599051
356    1110599051
Name: account_id, Length: 357, dtype: int64
2025-05-08 22:33:22,802 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2006
2025-05-08 22:33:22,802 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2935
2025-05-08 22:33:22,802 [DEBUG] [root.generate_player_performance_metrics] match_total: 357
2025-05-08 22:33:22,803 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1110599051
1      1110599051
2      1110599051
3      1110599051
4      1110599051
          ...    
352    1110599051
353    1110599051
354    1110599051
355    1110599051
356    1110599051
Name: account_id, Length: 357, dtype: int64
2025-05-08 22:33:22,803 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:22,809 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:22,810 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:22,810 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:22,810 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:22,810 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:22,818 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 50-49
2025-05-08 22:33:22,818 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:22,820 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1110599051
2025-05-08 22:33:22,820 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:22,820 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:22,827 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 45922-45565
2025-05-08 22:33:22,827 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 25.98seconds. Processed 50 of 250 players
2025-05-08 22:33:22,827 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=50, account_id=1115406239) of 250
2025-05-08 22:33:22,827 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1115406239/match-history?only_stored_history=true
2025-05-08 22:33:22,827 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:23,280 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1115406239/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:23,282 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:23,283 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1115406239
1      1115406239
2      1115406239
3      1115406239
4      1115406239
          ...    
199    1115406239
200    1115406239
201    1115406239
202    1115406239
203    1115406239
Name: account_id, Length: 204, dtype: int64
2025-05-08 22:33:23,283 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2060
2025-05-08 22:33:23,283 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1280
2025-05-08 22:33:23,283 [DEBUG] [root.generate_player_performance_metrics] match_total: 204
2025-05-08 22:33:23,284 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1115406239
1      1115406239
2      1115406239
3      1115406239
4      1115406239
          ...    
199    1115406239
200    1115406239
201    1115406239
202    1115406239
203    1115406239
Name: account_id, Length: 204, dtype: int64
2025-05-08 22:33:23,284 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:23,289 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:23,290 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:23,290 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:23,290 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:23,290 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:23,297 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 51-50
2025-05-08 22:33:23,297 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:23,299 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1115406239
2025-05-08 22:33:23,299 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:23,300 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:23,305 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 46126-45922
2025-05-08 22:33:23,305 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=51, account_id=188989241) of 250
2025-05-08 22:33:23,305 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/188989241/match-history?only_stored_history=true
2025-05-08 22:33:23,306 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:23,571 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/188989241/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:23,589 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:23,590 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      188989241
1      188989241
2      188989241
3      188989241
4      188989241
         ...    
552    188989241
553    188989241
554    188989241
555    188989241
556    188989241
Name: account_id, Length: 557, dtype: int64
2025-05-08 22:33:23,590 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5594
2025-05-08 22:33:23,590 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3508
2025-05-08 22:33:23,590 [DEBUG] [root.generate_player_performance_metrics] match_total: 557
2025-05-08 22:33:23,591 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      188989241
1      188989241
2      188989241
3      188989241
4      188989241
         ...    
552    188989241
553    188989241
554    188989241
555    188989241
556    188989241
Name: account_id, Length: 557, dtype: int64
2025-05-08 22:33:23,591 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:23,595 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:23,597 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:23,597 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:23,597 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:23,597 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:23,603 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 52-51
2025-05-08 22:33:23,603 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:23,605 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 188989241
2025-05-08 22:33:23,605 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:23,605 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:23,612 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 46683-46126
2025-05-08 22:33:23,613 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=52, account_id=256280663) of 250
2025-05-08 22:33:23,613 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/256280663/match-history?only_stored_history=true
2025-05-08 22:33:23,613 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:24,070 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/256280663/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:24,075 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:24,075 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      256280663
1      256280663
2      256280663
3      256280663
4      256280663
         ...    
718    256280663
719    256280663
720    256280663
721    256280663
722    256280663
Name: account_id, Length: 723, dtype: int64
2025-05-08 22:33:24,076 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1858
2025-05-08 22:33:24,076 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5529
2025-05-08 22:33:24,076 [DEBUG] [root.generate_player_performance_metrics] match_total: 723
2025-05-08 22:33:24,076 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      256280663
1      256280663
2      256280663
3      256280663
4      256280663
         ...    
718    256280663
719    256280663
720    256280663
721    256280663
722    256280663
Name: account_id, Length: 723, dtype: int64
2025-05-08 22:33:24,077 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:24,082 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:24,083 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:24,083 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:24,083 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:24,083 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:24,091 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 53-52
2025-05-08 22:33:24,091 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:24,093 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 256280663
2025-05-08 22:33:24,093 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:24,093 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:24,101 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 47406-46683
2025-05-08 22:33:24,102 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=53, account_id=40592948) of 250
2025-05-08 22:33:24,102 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/40592948/match-history?only_stored_history=true
2025-05-08 22:33:24,102 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:24,728 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/40592948/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:24,737 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:24,738 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       40592948
1       40592948
2       40592948
3       40592948
4       40592948
          ...   
1467    40592948
1468    40592948
1469    40592948
1470    40592948
1471    40592948
Name: account_id, Length: 1472, dtype: int64
2025-05-08 22:33:24,738 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6149
2025-05-08 22:33:24,738 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9438
2025-05-08 22:33:24,738 [DEBUG] [root.generate_player_performance_metrics] match_total: 1472
2025-05-08 22:33:24,740 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       40592948
1       40592948
2       40592948
3       40592948
4       40592948
          ...   
1467    40592948
1468    40592948
1469    40592948
1470    40592948
1471    40592948
Name: account_id, Length: 1472, dtype: int64
2025-05-08 22:33:24,740 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:24,745 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:24,746 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:24,746 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:24,747 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:24,747 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:24,756 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 54-53
2025-05-08 22:33:24,756 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:24,758 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 40592948
2025-05-08 22:33:24,758 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:24,759 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:24,770 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 48878-47406
2025-05-08 22:33:24,770 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=54, account_id=131280259) of 250
2025-05-08 22:33:24,770 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/131280259/match-history?only_stored_history=true
2025-05-08 22:33:24,770 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:25,070 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/131280259/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:25,085 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:25,086 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      131280259
1      131280259
2      131280259
3      131280259
4      131280259
         ...    
592    131280259
593    131280259
594    131280259
595    131280259
596    131280259
Name: account_id, Length: 597, dtype: int64
2025-05-08 22:33:25,087 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6078
2025-05-08 22:33:25,087 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3513
2025-05-08 22:33:25,087 [DEBUG] [root.generate_player_performance_metrics] match_total: 597
2025-05-08 22:33:25,088 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      131280259
1      131280259
2      131280259
3      131280259
4      131280259
         ...    
592    131280259
593    131280259
594    131280259
595    131280259
596    131280259
Name: account_id, Length: 597, dtype: int64
2025-05-08 22:33:25,088 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:25,092 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:25,094 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:25,094 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:25,094 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:25,094 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:25,101 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 55-54
2025-05-08 22:33:25,101 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:25,103 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 131280259
2025-05-08 22:33:25,103 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:25,103 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:25,110 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 49475-48878
2025-05-08 22:33:25,110 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=55, account_id=1858447541) of 250
2025-05-08 22:33:25,110 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1858447541/match-history?only_stored_history=true
2025-05-08 22:33:25,111 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:25,368 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1858447541/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:25,369 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:25,369 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1858447541
1     1858447541
2     1858447541
3     1858447541
4     1858447541
         ...    
88    1858447541
89    1858447541
90    1858447541
91    1858447541
92    1858447541
Name: account_id, Length: 93, dtype: int64
2025-05-08 22:33:25,370 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1207
2025-05-08 22:33:25,370 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 402
2025-05-08 22:33:25,370 [DEBUG] [root.generate_player_performance_metrics] match_total: 93
2025-05-08 22:33:25,371 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1858447541
1     1858447541
2     1858447541
3     1858447541
4     1858447541
         ...    
88    1858447541
89    1858447541
90    1858447541
91    1858447541
92    1858447541
Name: account_id, Length: 93, dtype: int64
2025-05-08 22:33:25,371 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:25,375 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:25,376 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:25,376 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:25,376 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:25,376 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:25,383 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 56-55
2025-05-08 22:33:25,383 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:25,385 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1858447541
2025-05-08 22:33:25,385 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:25,385 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:25,391 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 49568-49475
2025-05-08 22:33:25,391 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=56, account_id=97533101) of 250
2025-05-08 22:33:25,391 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/97533101/match-history?only_stored_history=true
2025-05-08 22:33:25,391 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:25,987 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/97533101/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:26,037 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:26,038 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       97533101
1       97533101
2       97533101
3       97533101
4       97533101
          ...   
2768    97533101
2769    97533101
2770    97533101
2771    97533101
2772    97533101
Name: account_id, Length: 2773, dtype: int64
2025-05-08 22:33:26,038 [DEBUG] [root.generate_player_performance_metrics] total_kills: 28528
2025-05-08 22:33:26,039 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 16355
2025-05-08 22:33:26,039 [DEBUG] [root.generate_player_performance_metrics] match_total: 2773
2025-05-08 22:33:26,040 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       97533101
1       97533101
2       97533101
3       97533101
4       97533101
          ...   
2768    97533101
2769    97533101
2770    97533101
2771    97533101
2772    97533101
Name: account_id, Length: 2773, dtype: int64
2025-05-08 22:33:26,040 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:26,045 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:26,046 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:26,046 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:26,046 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:26,046 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:26,056 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 57-56
2025-05-08 22:33:26,056 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:26,058 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 97533101
2025-05-08 22:33:26,059 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:26,059 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:26,078 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 52341-49568
2025-05-08 22:33:26,078 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=57, account_id=384653741) of 250
2025-05-08 22:33:26,078 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/384653741/match-history?only_stored_history=true
2025-05-08 22:33:26,079 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:26,530 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/384653741/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:26,623 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:26,623 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       384653741
1       384653741
2       384653741
3       384653741
4       384653741
          ...    
1182    384653741
1183    384653741
1184    384653741
1185    384653741
1186    384653741
Name: account_id, Length: 1187, dtype: int64
2025-05-08 22:33:26,624 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7626
2025-05-08 22:33:26,624 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6502
2025-05-08 22:33:26,624 [DEBUG] [root.generate_player_performance_metrics] match_total: 1187
2025-05-08 22:33:26,625 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       384653741
1       384653741
2       384653741
3       384653741
4       384653741
          ...    
1182    384653741
1183    384653741
1184    384653741
1185    384653741
1186    384653741
Name: account_id, Length: 1187, dtype: int64
2025-05-08 22:33:26,625 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:26,630 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:26,631 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:26,631 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:26,631 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:26,632 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:26,639 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 58-57
2025-05-08 22:33:26,639 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:26,641 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 384653741
2025-05-08 22:33:26,642 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:26,642 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:26,652 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 53528-52341
2025-05-08 22:33:26,652 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=58, account_id=870581152) of 250
2025-05-08 22:33:26,652 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/870581152/match-history?only_stored_history=true
2025-05-08 22:33:26,653 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:26,948 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/870581152/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:26,992 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:26,993 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       870581152
1       870581152
2       870581152
3       870581152
4       870581152
          ...    
1397    870581152
1398    870581152
1399    870581152
1400    870581152
1401    870581152
Name: account_id, Length: 1402, dtype: int64
2025-05-08 22:33:26,993 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12301
2025-05-08 22:33:26,993 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9023
2025-05-08 22:33:26,993 [DEBUG] [root.generate_player_performance_metrics] match_total: 1402
2025-05-08 22:33:26,994 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       870581152
1       870581152
2       870581152
3       870581152
4       870581152
          ...    
1397    870581152
1398    870581152
1399    870581152
1400    870581152
1401    870581152
Name: account_id, Length: 1402, dtype: int64
2025-05-08 22:33:26,994 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:26,999 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:26,999 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:27,000 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:27,000 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:27,000 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:27,008 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 59-58
2025-05-08 22:33:27,008 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:27,011 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 870581152
2025-05-08 22:33:27,011 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:27,011 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:27,023 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 54930-53528
2025-05-08 22:33:27,023 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=59, account_id=1144439143) of 250
2025-05-08 22:33:27,023 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1144439143/match-history?only_stored_history=true
2025-05-08 22:33:27,024 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:27,322 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1144439143/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:27,343 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:27,343 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1144439143
1       1144439143
2       1144439143
3       1144439143
4       1144439143
           ...    
1721    1144439143
1722    1144439143
1723    1144439143
1724    1144439143
1725    1144439143
Name: account_id, Length: 1726, dtype: int64
2025-05-08 22:33:27,344 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11303
2025-05-08 22:33:27,344 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10655
2025-05-08 22:33:27,344 [DEBUG] [root.generate_player_performance_metrics] match_total: 1726
2025-05-08 22:33:27,345 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1144439143
1       1144439143
2       1144439143
3       1144439143
4       1144439143
           ...    
1721    1144439143
1722    1144439143
1723    1144439143
1724    1144439143
1725    1144439143
Name: account_id, Length: 1726, dtype: int64
2025-05-08 22:33:27,345 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:27,350 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:27,351 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:27,351 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:27,351 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:27,351 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:27,361 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 60-59
2025-05-08 22:33:27,361 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:27,363 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1144439143
2025-05-08 22:33:27,363 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:27,363 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:27,377 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 56656-54930
2025-05-08 22:33:27,377 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 30.53seconds. Processed 60 of 250 players
2025-05-08 22:33:27,377 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=60, account_id=1055638874) of 250
2025-05-08 22:33:27,377 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1055638874/match-history?only_stored_history=true
2025-05-08 22:33:27,378 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:27,865 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1055638874/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:27,883 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:27,884 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1055638874
1      1055638874
2      1055638874
3      1055638874
4      1055638874
          ...    
711    1055638874
712    1055638874
713    1055638874
714    1055638874
715    1055638874
Name: account_id, Length: 716, dtype: int64
2025-05-08 22:33:27,884 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6151
2025-05-08 22:33:27,884 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3662
2025-05-08 22:33:27,884 [DEBUG] [root.generate_player_performance_metrics] match_total: 716
2025-05-08 22:33:27,885 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1055638874
1      1055638874
2      1055638874
3      1055638874
4      1055638874
          ...    
711    1055638874
712    1055638874
713    1055638874
714    1055638874
715    1055638874
Name: account_id, Length: 716, dtype: int64
2025-05-08 22:33:27,885 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:27,889 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:27,891 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:27,891 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:27,891 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:27,891 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:27,897 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 61-60
2025-05-08 22:33:27,898 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:27,900 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1055638874
2025-05-08 22:33:27,900 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:27,900 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:27,908 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 57372-56656
2025-05-08 22:33:27,908 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=61, account_id=1211340519) of 250
2025-05-08 22:33:27,908 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1211340519/match-history?only_stored_history=true
2025-05-08 22:33:27,908 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:28,231 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1211340519/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:28,257 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:28,258 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1211340519
1      1211340519
2      1211340519
3      1211340519
4      1211340519
          ...    
850    1211340519
851    1211340519
852    1211340519
853    1211340519
854    1211340519
Name: account_id, Length: 855, dtype: int64
2025-05-08 22:33:28,258 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7363
2025-05-08 22:33:28,258 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5848
2025-05-08 22:33:28,258 [DEBUG] [root.generate_player_performance_metrics] match_total: 855
2025-05-08 22:33:28,259 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1211340519
1      1211340519
2      1211340519
3      1211340519
4      1211340519
          ...    
850    1211340519
851    1211340519
852    1211340519
853    1211340519
854    1211340519
Name: account_id, Length: 855, dtype: int64
2025-05-08 22:33:28,259 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:28,263 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:28,265 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:28,265 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:28,265 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:28,265 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:28,273 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 62-61
2025-05-08 22:33:28,273 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:28,275 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1211340519
2025-05-08 22:33:28,275 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:28,275 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:28,284 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 58227-57372
2025-05-08 22:33:28,284 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=62, account_id=116510665) of 250
2025-05-08 22:33:28,284 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/116510665/match-history?only_stored_history=true
2025-05-08 22:33:28,285 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:28,744 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/116510665/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:28,748 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:28,749 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      116510665
1      116510665
2      116510665
3      116510665
4      116510665
         ...    
797    116510665
798    116510665
799    116510665
800    116510665
801    116510665
Name: account_id, Length: 802, dtype: int64
2025-05-08 22:33:28,749 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5708
2025-05-08 22:33:28,749 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4039
2025-05-08 22:33:28,749 [DEBUG] [root.generate_player_performance_metrics] match_total: 802
2025-05-08 22:33:28,750 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      116510665
1      116510665
2      116510665
3      116510665
4      116510665
         ...    
797    116510665
798    116510665
799    116510665
800    116510665
801    116510665
Name: account_id, Length: 802, dtype: int64
2025-05-08 22:33:28,750 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:28,755 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:28,756 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:28,756 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:28,756 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:28,756 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:28,764 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 63-62
2025-05-08 22:33:28,764 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:28,767 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 116510665
2025-05-08 22:33:28,767 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:28,767 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:28,775 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 59029-58227
2025-05-08 22:33:28,775 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=63, account_id=1146516873) of 250
2025-05-08 22:33:28,775 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1146516873/match-history?only_stored_history=true
2025-05-08 22:33:28,775 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:29,034 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1146516873/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:29,050 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:29,051 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1146516873
1       1146516873
2       1146516873
3       1146516873
4       1146516873
           ...    
1351    1146516873
1352    1146516873
1353    1146516873
1354    1146516873
1355    1146516873
Name: account_id, Length: 1356, dtype: int64
2025-05-08 22:33:29,051 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10496
2025-05-08 22:33:29,051 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 12103
2025-05-08 22:33:29,051 [DEBUG] [root.generate_player_performance_metrics] match_total: 1356
2025-05-08 22:33:29,052 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1146516873
1       1146516873
2       1146516873
3       1146516873
4       1146516873
           ...    
1351    1146516873
1352    1146516873
1353    1146516873
1354    1146516873
1355    1146516873
Name: account_id, Length: 1356, dtype: int64
2025-05-08 22:33:29,052 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:29,057 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:29,059 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:29,059 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:29,059 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:29,059 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:29,066 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 64-63
2025-05-08 22:33:29,066 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:29,068 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1146516873
2025-05-08 22:33:29,069 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:29,069 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:29,084 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 60385-59029
2025-05-08 22:33:29,084 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=64, account_id=199890420) of 250
2025-05-08 22:33:29,084 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/199890420/match-history?only_stored_history=true
2025-05-08 22:33:29,085 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:29,360 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/199890420/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:29,365 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:29,365 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      199890420
1      199890420
2      199890420
3      199890420
4      199890420
         ...    
764    199890420
765    199890420
766    199890420
767    199890420
768    199890420
Name: account_id, Length: 769, dtype: int64
2025-05-08 22:33:29,366 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6492
2025-05-08 22:33:29,366 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3395
2025-05-08 22:33:29,366 [DEBUG] [root.generate_player_performance_metrics] match_total: 769
2025-05-08 22:33:29,367 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      199890420
1      199890420
2      199890420
3      199890420
4      199890420
         ...    
764    199890420
765    199890420
766    199890420
767    199890420
768    199890420
Name: account_id, Length: 769, dtype: int64
2025-05-08 22:33:29,367 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:29,372 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:29,373 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:29,373 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:29,373 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:29,373 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:29,383 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 65-64
2025-05-08 22:33:29,383 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:29,385 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 199890420
2025-05-08 22:33:29,386 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:29,386 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:29,394 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 61154-60385
2025-05-08 22:33:29,394 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=65, account_id=361289487) of 250
2025-05-08 22:33:29,395 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/361289487/match-history?only_stored_history=true
2025-05-08 22:33:29,395 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:29,662 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/361289487/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:29,754 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:29,755 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       361289487
1       361289487
2       361289487
3       361289487
4       361289487
          ...    
1429    361289487
1430    361289487
1431    361289487
1432    361289487
1433    361289487
Name: account_id, Length: 1434, dtype: int64
2025-05-08 22:33:29,755 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10903
2025-05-08 22:33:29,755 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9575
2025-05-08 22:33:29,755 [DEBUG] [root.generate_player_performance_metrics] match_total: 1434
2025-05-08 22:33:29,756 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       361289487
1       361289487
2       361289487
3       361289487
4       361289487
          ...    
1429    361289487
1430    361289487
1431    361289487
1432    361289487
1433    361289487
Name: account_id, Length: 1434, dtype: int64
2025-05-08 22:33:29,756 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:29,760 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:29,761 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:29,761 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:29,761 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:29,762 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:29,773 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 66-65
2025-05-08 22:33:29,773 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:29,776 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 361289487
2025-05-08 22:33:29,776 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:29,776 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:29,789 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 62588-61154
2025-05-08 22:33:29,789 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=66, account_id=1533574581) of 250
2025-05-08 22:33:29,789 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1533574581/match-history?only_stored_history=true
2025-05-08 22:33:29,790 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:30,169 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1533574581/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:30,171 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:30,171 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1533574581
1     1533574581
2     1533574581
3     1533574581
4     1533574581
5     1533574581
6     1533574581
7     1533574581
8     1533574581
9     1533574581
10    1533574581
11    1533574581
12    1533574581
13    1533574581
14    1533574581
15    1533574581
16    1533574581
17    1533574581
18    1533574581
19    1533574581
20    1533574581
21    1533574581
22    1533574581
23    1533574581
24    1533574581
25    1533574581
26    1533574581
27    1533574581
28    1533574581
29    1533574581
Name: account_id, dtype: int64
2025-05-08 22:33:30,171 [DEBUG] [root.generate_player_performance_metrics] total_kills: 415
2025-05-08 22:33:30,171 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 190
2025-05-08 22:33:30,171 [DEBUG] [root.generate_player_performance_metrics] match_total: 30
2025-05-08 22:33:30,172 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1533574581
1     1533574581
2     1533574581
3     1533574581
4     1533574581
5     1533574581
6     1533574581
7     1533574581
8     1533574581
9     1533574581
10    1533574581
11    1533574581
12    1533574581
13    1533574581
14    1533574581
15    1533574581
16    1533574581
17    1533574581
18    1533574581
19    1533574581
20    1533574581
21    1533574581
22    1533574581
23    1533574581
24    1533574581
25    1533574581
26    1533574581
27    1533574581
28    1533574581
29    1533574581
Name: account_id, dtype: int64
2025-05-08 22:33:30,172 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:30,177 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:30,178 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:30,178 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:30,178 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:30,179 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:30,188 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 67-66
2025-05-08 22:33:30,188 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:30,190 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1533574581
2025-05-08 22:33:30,190 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:30,190 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:30,199 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 62618-62588
2025-05-08 22:33:30,200 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=67, account_id=44035503) of 250
2025-05-08 22:33:30,200 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/44035503/match-history?only_stored_history=true
2025-05-08 22:33:30,200 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:30,632 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/44035503/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:30,635 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:30,636 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      44035503
1      44035503
2      44035503
3      44035503
4      44035503
         ...   
287    44035503
288    44035503
289    44035503
290    44035503
291    44035503
Name: account_id, Length: 292, dtype: int64
2025-05-08 22:33:30,636 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3073
2025-05-08 22:33:30,636 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1816
2025-05-08 22:33:30,636 [DEBUG] [root.generate_player_performance_metrics] match_total: 292
2025-05-08 22:33:30,637 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      44035503
1      44035503
2      44035503
3      44035503
4      44035503
         ...   
287    44035503
288    44035503
289    44035503
290    44035503
291    44035503
Name: account_id, Length: 292, dtype: int64
2025-05-08 22:33:30,637 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:30,641 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:30,642 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:30,642 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:30,642 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:30,642 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:30,650 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 68-67
2025-05-08 22:33:30,650 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:30,652 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 44035503
2025-05-08 22:33:30,652 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:30,653 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:30,659 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 62910-62618
2025-05-08 22:33:30,659 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=68, account_id=123133518) of 250
2025-05-08 22:33:30,659 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/123133518/match-history?only_stored_history=true
2025-05-08 22:33:30,659 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:31,176 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/123133518/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:31,183 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:31,184 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       123133518
1       123133518
2       123133518
3       123133518
4       123133518
          ...    
1021    123133518
1022    123133518
1023    123133518
1024    123133518
1025    123133518
Name: account_id, Length: 1026, dtype: int64
2025-05-08 22:33:31,184 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9273
2025-05-08 22:33:31,184 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6423
2025-05-08 22:33:31,184 [DEBUG] [root.generate_player_performance_metrics] match_total: 1026
2025-05-08 22:33:31,185 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       123133518
1       123133518
2       123133518
3       123133518
4       123133518
          ...    
1021    123133518
1022    123133518
1023    123133518
1024    123133518
1025    123133518
Name: account_id, Length: 1026, dtype: int64
2025-05-08 22:33:31,185 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:31,189 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:31,191 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:31,191 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:31,191 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:31,191 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:31,199 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 69-68
2025-05-08 22:33:31,199 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:31,201 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 123133518
2025-05-08 22:33:31,202 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:31,202 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:31,211 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 63936-62910
2025-05-08 22:33:31,211 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=69, account_id=114943410) of 250
2025-05-08 22:33:31,211 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/114943410/match-history?only_stored_history=true
2025-05-08 22:33:31,211 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:31,450 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/114943410/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:31,467 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:31,468 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       114943410
1       114943410
2       114943410
3       114943410
4       114943410
          ...    
1382    114943410
1383    114943410
1384    114943410
1385    114943410
1386    114943410
Name: account_id, Length: 1387, dtype: int64
2025-05-08 22:33:31,468 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14887
2025-05-08 22:33:31,468 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7557
2025-05-08 22:33:31,468 [DEBUG] [root.generate_player_performance_metrics] match_total: 1387
2025-05-08 22:33:31,469 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       114943410
1       114943410
2       114943410
3       114943410
4       114943410
          ...    
1382    114943410
1383    114943410
1384    114943410
1385    114943410
1386    114943410
Name: account_id, Length: 1387, dtype: int64
2025-05-08 22:33:31,469 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:31,474 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:31,475 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:31,475 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:31,475 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:31,475 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:31,484 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 70-69
2025-05-08 22:33:31,484 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:31,486 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 114943410
2025-05-08 22:33:31,486 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:31,487 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:31,499 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 65323-63936
2025-05-08 22:33:31,499 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 34.65seconds. Processed 70 of 250 players
2025-05-08 22:33:31,499 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=70, account_id=403751180) of 250
2025-05-08 22:33:31,499 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/403751180/match-history?only_stored_history=true
2025-05-08 22:33:31,499 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:31,959 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/403751180/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:31,965 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:31,966 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       403751180
1       403751180
2       403751180
3       403751180
4       403751180
          ...    
1031    403751180
1032    403751180
1033    403751180
1034    403751180
1035    403751180
Name: account_id, Length: 1036, dtype: int64
2025-05-08 22:33:31,966 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9523
2025-05-08 22:33:31,966 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7028
2025-05-08 22:33:31,966 [DEBUG] [root.generate_player_performance_metrics] match_total: 1036
2025-05-08 22:33:31,967 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       403751180
1       403751180
2       403751180
3       403751180
4       403751180
          ...    
1031    403751180
1032    403751180
1033    403751180
1034    403751180
1035    403751180
Name: account_id, Length: 1036, dtype: int64
2025-05-08 22:33:31,967 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:31,972 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:31,973 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:31,973 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:31,973 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:31,973 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:31,980 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 71-70
2025-05-08 22:33:31,980 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:31,983 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 403751180
2025-05-08 22:33:31,983 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:31,983 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:31,992 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 66359-65323
2025-05-08 22:33:31,992 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=71, account_id=126997529) of 250
2025-05-08 22:33:31,992 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/126997529/match-history?only_stored_history=true
2025-05-08 22:33:31,993 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:32,474 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/126997529/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:32,481 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:32,482 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       126997529
1       126997529
2       126997529
3       126997529
4       126997529
          ...    
1085    126997529
1086    126997529
1087    126997529
1088    126997529
1089    126997529
Name: account_id, Length: 1090, dtype: int64
2025-05-08 22:33:32,482 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6662
2025-05-08 22:33:32,482 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6585
2025-05-08 22:33:32,482 [DEBUG] [root.generate_player_performance_metrics] match_total: 1090
2025-05-08 22:33:32,483 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       126997529
1       126997529
2       126997529
3       126997529
4       126997529
          ...    
1085    126997529
1086    126997529
1087    126997529
1088    126997529
1089    126997529
Name: account_id, Length: 1090, dtype: int64
2025-05-08 22:33:32,483 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:32,488 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:32,489 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:32,489 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:32,489 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:32,489 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:32,495 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 72-71
2025-05-08 22:33:32,495 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:32,497 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 126997529
2025-05-08 22:33:32,497 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:32,499 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:32,507 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 67449-66359
2025-05-08 22:33:32,507 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=72, account_id=200384026) of 250
2025-05-08 22:33:32,507 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/200384026/match-history?only_stored_history=true
2025-05-08 22:33:32,509 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:33,053 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/200384026/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:33,062 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:33,062 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       200384026
1       200384026
2       200384026
3       200384026
4       200384026
          ...    
1409    200384026
1410    200384026
1411    200384026
1412    200384026
1413    200384026
Name: account_id, Length: 1414, dtype: int64
2025-05-08 22:33:33,063 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11231
2025-05-08 22:33:33,063 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7501
2025-05-08 22:33:33,063 [DEBUG] [root.generate_player_performance_metrics] match_total: 1414
2025-05-08 22:33:33,064 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       200384026
1       200384026
2       200384026
3       200384026
4       200384026
          ...    
1409    200384026
1410    200384026
1411    200384026
1412    200384026
1413    200384026
Name: account_id, Length: 1414, dtype: int64
2025-05-08 22:33:33,064 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:33,069 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:33,070 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:33,070 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:33,070 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:33,070 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:33,077 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 73-72
2025-05-08 22:33:33,077 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:33,079 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 200384026
2025-05-08 22:33:33,079 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:33,079 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:33,092 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 68863-67449
2025-05-08 22:33:33,092 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=73, account_id=1098838109) of 250
2025-05-08 22:33:33,092 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1098838109/match-history?only_stored_history=true
2025-05-08 22:33:33,093 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:33,390 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1098838109/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:33,399 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:33,399 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1098838109
1       1098838109
2       1098838109
3       1098838109
4       1098838109
           ...    
1537    1098838109
1538    1098838109
1539    1098838109
1540    1098838109
1541    1098838109
Name: account_id, Length: 1542, dtype: int64
2025-05-08 22:33:33,400 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8387
2025-05-08 22:33:33,400 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7448
2025-05-08 22:33:33,400 [DEBUG] [root.generate_player_performance_metrics] match_total: 1542
2025-05-08 22:33:33,401 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1098838109
1       1098838109
2       1098838109
3       1098838109
4       1098838109
           ...    
1537    1098838109
1538    1098838109
1539    1098838109
1540    1098838109
1541    1098838109
Name: account_id, Length: 1542, dtype: int64
2025-05-08 22:33:33,401 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:33,405 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:33,407 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:33,407 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:33,407 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:33,407 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:33,415 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 74-73
2025-05-08 22:33:33,415 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:33,417 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1098838109
2025-05-08 22:33:33,418 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:33,418 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:33,431 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 70405-68863
2025-05-08 22:33:33,431 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=74, account_id=107361489) of 250
2025-05-08 22:33:33,431 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/107361489/match-history?only_stored_history=true
2025-05-08 22:33:33,431 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:33,690 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/107361489/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:33,706 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:33,708 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       107361489
1       107361489
2       107361489
3       107361489
4       107361489
          ...    
1444    107361489
1445    107361489
1446    107361489
1447    107361489
1448    107361489
Name: account_id, Length: 1449, dtype: int64
2025-05-08 22:33:33,708 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11383
2025-05-08 22:33:33,708 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10974
2025-05-08 22:33:33,708 [DEBUG] [root.generate_player_performance_metrics] match_total: 1449
2025-05-08 22:33:33,709 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       107361489
1       107361489
2       107361489
3       107361489
4       107361489
          ...    
1444    107361489
1445    107361489
1446    107361489
1447    107361489
1448    107361489
Name: account_id, Length: 1449, dtype: int64
2025-05-08 22:33:33,709 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:33,714 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:33,715 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:33,715 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:33,715 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:33,715 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:33,723 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 75-74
2025-05-08 22:33:33,723 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:33,725 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 107361489
2025-05-08 22:33:33,725 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:33,725 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:33,738 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 71854-70405
2025-05-08 22:33:33,738 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=75, account_id=155554572) of 250
2025-05-08 22:33:33,738 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/155554572/match-history?only_stored_history=true
2025-05-08 22:33:33,739 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:33,991 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/155554572/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:34,004 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:34,005 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      155554572
1      155554572
2      155554572
3      155554572
4      155554572
         ...    
438    155554572
439    155554572
440    155554572
441    155554572
442    155554572
Name: account_id, Length: 443, dtype: int64
2025-05-08 22:33:34,005 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2838
2025-05-08 22:33:34,005 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2506
2025-05-08 22:33:34,005 [DEBUG] [root.generate_player_performance_metrics] match_total: 443
2025-05-08 22:33:34,006 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      155554572
1      155554572
2      155554572
3      155554572
4      155554572
         ...    
438    155554572
439    155554572
440    155554572
441    155554572
442    155554572
Name: account_id, Length: 443, dtype: int64
2025-05-08 22:33:34,006 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:34,011 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:34,012 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:34,012 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:34,012 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:34,012 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:34,020 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 76-75
2025-05-08 22:33:34,020 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:34,022 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 155554572
2025-05-08 22:33:34,022 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:34,022 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:34,029 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 72297-71854
2025-05-08 22:33:34,029 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=76, account_id=786351360) of 250
2025-05-08 22:33:34,029 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/786351360/match-history?only_stored_history=true
2025-05-08 22:33:34,030 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:34,491 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/786351360/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:34,574 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:34,575 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       786351360
1       786351360
2       786351360
3       786351360
4       786351360
          ...    
1587    786351360
1588    786351360
1589    786351360
1590    786351360
1591    786351360
Name: account_id, Length: 1592, dtype: int64
2025-05-08 22:33:34,575 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12583
2025-05-08 22:33:34,575 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 12280
2025-05-08 22:33:34,575 [DEBUG] [root.generate_player_performance_metrics] match_total: 1592
2025-05-08 22:33:34,576 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       786351360
1       786351360
2       786351360
3       786351360
4       786351360
          ...    
1587    786351360
1588    786351360
1589    786351360
1590    786351360
1591    786351360
Name: account_id, Length: 1592, dtype: int64
2025-05-08 22:33:34,576 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:34,581 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:34,582 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:34,582 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:34,582 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:34,582 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:34,590 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 77-76
2025-05-08 22:33:34,590 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:34,592 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 786351360
2025-05-08 22:33:34,593 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:34,593 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:34,605 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 73889-72297
2025-05-08 22:33:34,605 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=77, account_id=197451559) of 250
2025-05-08 22:33:34,605 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/197451559/match-history?only_stored_history=true
2025-05-08 22:33:34,606 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:35,067 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/197451559/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:35,146 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:35,147 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       197451559
1       197451559
2       197451559
3       197451559
4       197451559
          ...    
1509    197451559
1510    197451559
1511    197451559
1512    197451559
1513    197451559
Name: account_id, Length: 1514, dtype: int64
2025-05-08 22:33:35,147 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11065
2025-05-08 22:33:35,147 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11341
2025-05-08 22:33:35,147 [DEBUG] [root.generate_player_performance_metrics] match_total: 1514
2025-05-08 22:33:35,148 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       197451559
1       197451559
2       197451559
3       197451559
4       197451559
          ...    
1509    197451559
1510    197451559
1511    197451559
1512    197451559
1513    197451559
Name: account_id, Length: 1514, dtype: int64
2025-05-08 22:33:35,148 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:35,153 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:35,154 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:35,154 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:35,155 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:35,155 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:35,162 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 78-77
2025-05-08 22:33:35,162 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:35,164 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 197451559
2025-05-08 22:33:35,165 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:35,165 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:35,177 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 75403-73889
2025-05-08 22:33:35,177 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=78, account_id=69551100) of 250
2025-05-08 22:33:35,177 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/69551100/match-history?only_stored_history=true
2025-05-08 22:33:35,178 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:35,709 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/69551100/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:35,715 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:35,716 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       69551100
1       69551100
2       69551100
3       69551100
4       69551100
          ...   
1137    69551100
1138    69551100
1139    69551100
1140    69551100
1141    69551100
Name: account_id, Length: 1142, dtype: int64
2025-05-08 22:33:35,716 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7752
2025-05-08 22:33:35,716 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6851
2025-05-08 22:33:35,716 [DEBUG] [root.generate_player_performance_metrics] match_total: 1142
2025-05-08 22:33:35,717 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       69551100
1       69551100
2       69551100
3       69551100
4       69551100
          ...   
1137    69551100
1138    69551100
1139    69551100
1140    69551100
1141    69551100
Name: account_id, Length: 1142, dtype: int64
2025-05-08 22:33:35,717 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:35,721 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:35,723 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:35,723 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:35,723 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:35,723 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:35,732 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 79-78
2025-05-08 22:33:35,732 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:35,734 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 69551100
2025-05-08 22:33:35,734 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:35,734 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:35,744 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 76545-75403
2025-05-08 22:33:35,744 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=79, account_id=1858865120) of 250
2025-05-08 22:33:35,744 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1858865120/match-history?only_stored_history=true
2025-05-08 22:33:35,745 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:35,983 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1858865120/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:35,985 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:35,985 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1858865120
1      1858865120
2      1858865120
3      1858865120
4      1858865120
          ...    
97     1858865120
98     1858865120
99     1858865120
100    1858865120
101    1858865120
Name: account_id, Length: 102, dtype: int64
2025-05-08 22:33:35,986 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1095
2025-05-08 22:33:35,986 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 601
2025-05-08 22:33:35,986 [DEBUG] [root.generate_player_performance_metrics] match_total: 102
2025-05-08 22:33:35,987 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1858865120
1      1858865120
2      1858865120
3      1858865120
4      1858865120
          ...    
97     1858865120
98     1858865120
99     1858865120
100    1858865120
101    1858865120
Name: account_id, Length: 102, dtype: int64
2025-05-08 22:33:35,987 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:35,991 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:35,992 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:35,992 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:35,992 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:35,992 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:35,998 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 80-79
2025-05-08 22:33:35,998 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:36,000 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1858865120
2025-05-08 22:33:36,000 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:36,000 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:36,006 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 76647-76545
2025-05-08 22:33:36,006 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 39.16seconds. Processed 80 of 250 players
2025-05-08 22:33:36,006 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=80, account_id=1575345996) of 250
2025-05-08 22:33:36,006 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1575345996/match-history?only_stored_history=true
2025-05-08 22:33:36,007 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:36,530 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1575345996/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:36,629 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:36,629 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1575345996
1       1575345996
2       1575345996
3       1575345996
4       1575345996
           ...    
1713    1575345996
1714    1575345996
1715    1575345996
1716    1575345996
1717    1575345996
Name: account_id, Length: 1718, dtype: int64
2025-05-08 22:33:36,630 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12429
2025-05-08 22:33:36,630 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10840
2025-05-08 22:33:36,630 [DEBUG] [root.generate_player_performance_metrics] match_total: 1718
2025-05-08 22:33:36,630 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1575345996
1       1575345996
2       1575345996
3       1575345996
4       1575345996
           ...    
1713    1575345996
1714    1575345996
1715    1575345996
1716    1575345996
1717    1575345996
Name: account_id, Length: 1718, dtype: int64
2025-05-08 22:33:36,630 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:36,636 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:36,637 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:36,637 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:36,637 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:36,637 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:36,645 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 81-80
2025-05-08 22:33:36,645 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:36,648 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1575345996
2025-05-08 22:33:36,648 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:36,648 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:36,661 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 78365-76647
2025-05-08 22:33:36,661 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=81, account_id=158043057) of 250
2025-05-08 22:33:36,661 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/158043057/match-history?only_stored_history=true
2025-05-08 22:33:36,662 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:36,970 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/158043057/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:37,009 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:37,009 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       158043057
1       158043057
2       158043057
3       158043057
4       158043057
          ...    
1215    158043057
1216    158043057
1217    158043057
1218    158043057
1219    158043057
Name: account_id, Length: 1220, dtype: int64
2025-05-08 22:33:37,009 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9672
2025-05-08 22:33:37,010 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7308
2025-05-08 22:33:37,010 [DEBUG] [root.generate_player_performance_metrics] match_total: 1220
2025-05-08 22:33:37,010 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       158043057
1       158043057
2       158043057
3       158043057
4       158043057
          ...    
1215    158043057
1216    158043057
1217    158043057
1218    158043057
1219    158043057
Name: account_id, Length: 1220, dtype: int64
2025-05-08 22:33:37,010 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:37,015 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:37,016 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:37,016 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:37,016 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:37,017 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:37,025 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 82-81
2025-05-08 22:33:37,025 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:37,027 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 158043057
2025-05-08 22:33:37,027 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:37,027 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:37,037 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 79585-78365
2025-05-08 22:33:37,037 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=82, account_id=190858845) of 250
2025-05-08 22:33:37,037 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/190858845/match-history?only_stored_history=true
2025-05-08 22:33:37,037 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:37,297 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/190858845/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:37,314 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:37,314 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      190858845
1      190858845
2      190858845
3      190858845
4      190858845
         ...    
535    190858845
536    190858845
537    190858845
538    190858845
539    190858845
Name: account_id, Length: 540, dtype: int64
2025-05-08 22:33:37,314 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5278
2025-05-08 22:33:37,314 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3001
2025-05-08 22:33:37,315 [DEBUG] [root.generate_player_performance_metrics] match_total: 540
2025-05-08 22:33:37,315 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      190858845
1      190858845
2      190858845
3      190858845
4      190858845
         ...    
535    190858845
536    190858845
537    190858845
538    190858845
539    190858845
Name: account_id, Length: 540, dtype: int64
2025-05-08 22:33:37,315 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:37,320 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:37,322 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:37,322 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:37,322 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:37,322 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:37,329 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 83-82
2025-05-08 22:33:37,329 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:37,331 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 190858845
2025-05-08 22:33:37,331 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:37,331 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:37,338 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 80125-79585
2025-05-08 22:33:37,338 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=83, account_id=1174405729) of 250
2025-05-08 22:33:37,338 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1174405729/match-history?only_stored_history=true
2025-05-08 22:33:37,339 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:37,813 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1174405729/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:37,817 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:37,817 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1174405729
1      1174405729
2      1174405729
3      1174405729
4      1174405729
          ...    
716    1174405729
717    1174405729
718    1174405729
719    1174405729
720    1174405729
Name: account_id, Length: 721, dtype: int64
2025-05-08 22:33:37,817 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6590
2025-05-08 22:33:37,817 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3891
2025-05-08 22:33:37,819 [DEBUG] [root.generate_player_performance_metrics] match_total: 721
2025-05-08 22:33:37,819 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1174405729
1      1174405729
2      1174405729
3      1174405729
4      1174405729
          ...    
716    1174405729
717    1174405729
718    1174405729
719    1174405729
720    1174405729
Name: account_id, Length: 721, dtype: int64
2025-05-08 22:33:37,819 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:37,824 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:37,826 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:37,826 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:37,826 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:37,826 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:37,833 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 84-83
2025-05-08 22:33:37,833 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:37,835 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1174405729
2025-05-08 22:33:37,835 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:37,835 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:37,843 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 80846-80125
2025-05-08 22:33:37,843 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=84, account_id=421970790) of 250
2025-05-08 22:33:37,844 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/421970790/match-history?only_stored_history=true
2025-05-08 22:33:37,844 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:38,300 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/421970790/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:38,303 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:38,304 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      421970790
1      421970790
2      421970790
3      421970790
4      421970790
         ...    
556    421970790
557    421970790
558    421970790
559    421970790
560    421970790
Name: account_id, Length: 561, dtype: int64
2025-05-08 22:33:38,304 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3538
2025-05-08 22:33:38,304 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2986
2025-05-08 22:33:38,304 [DEBUG] [root.generate_player_performance_metrics] match_total: 561
2025-05-08 22:33:38,305 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      421970790
1      421970790
2      421970790
3      421970790
4      421970790
         ...    
556    421970790
557    421970790
558    421970790
559    421970790
560    421970790
Name: account_id, Length: 561, dtype: int64
2025-05-08 22:33:38,305 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:38,310 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:38,311 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:38,311 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:38,311 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:38,311 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:38,317 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 85-84
2025-05-08 22:33:38,318 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:38,319 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 421970790
2025-05-08 22:33:38,319 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:38,320 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:38,326 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 81407-80846
2025-05-08 22:33:38,327 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=85, account_id=354677070) of 250
2025-05-08 22:33:38,327 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/354677070/match-history?only_stored_history=true
2025-05-08 22:33:38,327 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:38,762 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/354677070/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:38,787 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:38,788 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      354677070
1      354677070
2      354677070
3      354677070
4      354677070
         ...    
937    354677070
938    354677070
939    354677070
940    354677070
941    354677070
Name: account_id, Length: 942, dtype: int64
2025-05-08 22:33:38,788 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7593
2025-05-08 22:33:38,788 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6071
2025-05-08 22:33:38,788 [DEBUG] [root.generate_player_performance_metrics] match_total: 942
2025-05-08 22:33:38,789 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      354677070
1      354677070
2      354677070
3      354677070
4      354677070
         ...    
937    354677070
938    354677070
939    354677070
940    354677070
941    354677070
Name: account_id, Length: 942, dtype: int64
2025-05-08 22:33:38,789 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:38,794 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:38,795 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:38,795 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:38,795 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:38,795 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:38,802 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 86-85
2025-05-08 22:33:38,802 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:38,805 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 354677070
2025-05-08 22:33:38,805 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:38,805 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:38,814 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 82349-81407
2025-05-08 22:33:38,814 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=86, account_id=1858973972) of 250
2025-05-08 22:33:38,814 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1858973972/match-history?only_stored_history=true
2025-05-08 22:33:38,814 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:39,219 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1858973972/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:39,221 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:39,222 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1858973972
1      1858973972
2      1858973972
3      1858973972
4      1858973972
          ...    
355    1858973972
356    1858973972
357    1858973972
358    1858973972
359    1858973972
Name: account_id, Length: 360, dtype: int64
2025-05-08 22:33:39,222 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2586
2025-05-08 22:33:39,222 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2111
2025-05-08 22:33:39,222 [DEBUG] [root.generate_player_performance_metrics] match_total: 360
2025-05-08 22:33:39,223 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1858973972
1      1858973972
2      1858973972
3      1858973972
4      1858973972
          ...    
355    1858973972
356    1858973972
357    1858973972
358    1858973972
359    1858973972
Name: account_id, Length: 360, dtype: int64
2025-05-08 22:33:39,223 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:39,228 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:39,229 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:39,229 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:39,229 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:39,229 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:39,237 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 87-86
2025-05-08 22:33:39,237 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:39,239 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1858973972
2025-05-08 22:33:39,239 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:39,239 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:39,245 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 82709-82349
2025-05-08 22:33:39,245 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=87, account_id=247872508) of 250
2025-05-08 22:33:39,245 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/247872508/match-history?only_stored_history=true
2025-05-08 22:33:39,246 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:39,701 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/247872508/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:39,725 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:39,726 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      247872508
1      247872508
2      247872508
3      247872508
4      247872508
         ...    
875    247872508
876    247872508
877    247872508
878    247872508
879    247872508
Name: account_id, Length: 880, dtype: int64
2025-05-08 22:33:39,726 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7796
2025-05-08 22:33:39,726 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6994
2025-05-08 22:33:39,726 [DEBUG] [root.generate_player_performance_metrics] match_total: 880
2025-05-08 22:33:39,727 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      247872508
1      247872508
2      247872508
3      247872508
4      247872508
         ...    
875    247872508
876    247872508
877    247872508
878    247872508
879    247872508
Name: account_id, Length: 880, dtype: int64
2025-05-08 22:33:39,727 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:39,732 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:39,733 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:39,733 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:39,733 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:39,733 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:39,742 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 88-87
2025-05-08 22:33:39,742 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:39,744 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 247872508
2025-05-08 22:33:39,744 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:39,744 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:39,752 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 83589-82709
2025-05-08 22:33:39,752 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=88, account_id=211149547) of 250
2025-05-08 22:33:39,752 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/211149547/match-history?only_stored_history=true
2025-05-08 22:33:39,753 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:40,143 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/211149547/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:40,144 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:40,144 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     211149547
1     211149547
2     211149547
3     211149547
4     211149547
        ...    
79    211149547
80    211149547
81    211149547
82    211149547
83    211149547
Name: account_id, Length: 84, dtype: int64
2025-05-08 22:33:40,145 [DEBUG] [root.generate_player_performance_metrics] total_kills: 644
2025-05-08 22:33:40,145 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 545
2025-05-08 22:33:40,145 [DEBUG] [root.generate_player_performance_metrics] match_total: 84
2025-05-08 22:33:40,146 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     211149547
1     211149547
2     211149547
3     211149547
4     211149547
        ...    
79    211149547
80    211149547
81    211149547
82    211149547
83    211149547
Name: account_id, Length: 84, dtype: int64
2025-05-08 22:33:40,146 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:40,150 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:40,151 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:40,151 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:40,151 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:40,151 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:40,159 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 89-88
2025-05-08 22:33:40,159 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:40,161 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 211149547
2025-05-08 22:33:40,161 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:40,161 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:40,166 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 83673-83589
2025-05-08 22:33:40,166 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=89, account_id=1505986329) of 250
2025-05-08 22:33:40,166 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1505986329/match-history?only_stored_history=true
2025-05-08 22:33:40,167 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:40,653 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1505986329/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:40,661 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:40,662 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1505986329
1      1505986329
2      1505986329
3      1505986329
4      1505986329
          ...    
812    1505986329
813    1505986329
814    1505986329
815    1505986329
816    1505986329
Name: account_id, Length: 817, dtype: int64
2025-05-08 22:33:40,662 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6428
2025-05-08 22:33:40,662 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7536
2025-05-08 22:33:40,662 [DEBUG] [root.generate_player_performance_metrics] match_total: 817
2025-05-08 22:33:40,663 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1505986329
1      1505986329
2      1505986329
3      1505986329
4      1505986329
          ...    
812    1505986329
813    1505986329
814    1505986329
815    1505986329
816    1505986329
Name: account_id, Length: 817, dtype: int64
2025-05-08 22:33:40,663 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:40,668 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:40,670 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:40,670 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:40,670 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:40,670 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:40,676 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 90-89
2025-05-08 22:33:40,677 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:40,679 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1505986329
2025-05-08 22:33:40,680 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:40,680 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:40,688 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 84490-83673
2025-05-08 22:33:40,688 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 43.84seconds. Processed 90 of 250 players
2025-05-08 22:33:40,688 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=90, account_id=157985890) of 250
2025-05-08 22:33:40,688 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/157985890/match-history?only_stored_history=true
2025-05-08 22:33:40,689 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:41,191 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/157985890/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:41,284 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:41,285 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       157985890
1       157985890
2       157985890
3       157985890
4       157985890
          ...    
1970    157985890
1971    157985890
1972    157985890
1973    157985890
1974    157985890
Name: account_id, Length: 1975, dtype: int64
2025-05-08 22:33:41,285 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11942
2025-05-08 22:33:41,285 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 13106
2025-05-08 22:33:41,285 [DEBUG] [root.generate_player_performance_metrics] match_total: 1975
2025-05-08 22:33:41,286 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       157985890
1       157985890
2       157985890
3       157985890
4       157985890
          ...    
1970    157985890
1971    157985890
1972    157985890
1973    157985890
1974    157985890
Name: account_id, Length: 1975, dtype: int64
2025-05-08 22:33:41,286 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:41,291 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:41,293 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:41,293 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:41,293 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:41,293 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:41,303 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 91-90
2025-05-08 22:33:41,303 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:41,305 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 157985890
2025-05-08 22:33:41,306 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:41,306 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:41,322 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 86465-84490
2025-05-08 22:33:41,322 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=91, account_id=169564838) of 250
2025-05-08 22:33:41,322 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/169564838/match-history?only_stored_history=true
2025-05-08 22:33:41,322 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:41,808 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/169564838/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:41,813 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:41,813 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      169564838
1      169564838
2      169564838
3      169564838
4      169564838
         ...    
865    169564838
866    169564838
867    169564838
868    169564838
869    169564838
Name: account_id, Length: 870, dtype: int64
2025-05-08 22:33:41,814 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5397
2025-05-08 22:33:41,814 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3914
2025-05-08 22:33:41,814 [DEBUG] [root.generate_player_performance_metrics] match_total: 870
2025-05-08 22:33:41,815 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      169564838
1      169564838
2      169564838
3      169564838
4      169564838
         ...    
865    169564838
866    169564838
867    169564838
868    169564838
869    169564838
Name: account_id, Length: 870, dtype: int64
2025-05-08 22:33:41,815 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:41,819 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:41,820 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:41,821 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:41,821 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:41,821 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:41,827 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 92-91
2025-05-08 22:33:41,827 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:41,830 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 169564838
2025-05-08 22:33:41,830 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:41,830 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:41,839 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 87335-86465
2025-05-08 22:33:41,839 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=92, account_id=95947783) of 250
2025-05-08 22:33:41,839 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/95947783/match-history?only_stored_history=true
2025-05-08 22:33:41,839 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:42,326 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/95947783/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:42,435 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:42,436 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       95947783
1       95947783
2       95947783
3       95947783
4       95947783
          ...   
1677    95947783
1678    95947783
1679    95947783
1680    95947783
1681    95947783
Name: account_id, Length: 1682, dtype: int64
2025-05-08 22:33:42,436 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13882
2025-05-08 22:33:42,437 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 14377
2025-05-08 22:33:42,437 [DEBUG] [root.generate_player_performance_metrics] match_total: 1682
2025-05-08 22:33:42,437 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       95947783
1       95947783
2       95947783
3       95947783
4       95947783
          ...   
1677    95947783
1678    95947783
1679    95947783
1680    95947783
1681    95947783
Name: account_id, Length: 1682, dtype: int64
2025-05-08 22:33:42,437 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:42,443 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:42,444 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:42,444 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:42,444 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:42,444 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:42,454 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 93-92
2025-05-08 22:33:42,454 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:42,456 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 95947783
2025-05-08 22:33:42,456 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:42,457 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:42,471 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 89017-87335
2025-05-08 22:33:42,471 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=93, account_id=224623791) of 250
2025-05-08 22:33:42,471 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/224623791/match-history?only_stored_history=true
2025-05-08 22:33:42,471 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:42,973 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/224623791/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:43,071 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:43,072 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       224623791
1       224623791
2       224623791
3       224623791
4       224623791
          ...    
1883    224623791
1884    224623791
1885    224623791
1886    224623791
1887    224623791
Name: account_id, Length: 1888, dtype: int64
2025-05-08 22:33:43,072 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14794
2025-05-08 22:33:43,072 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 13318
2025-05-08 22:33:43,072 [DEBUG] [root.generate_player_performance_metrics] match_total: 1888
2025-05-08 22:33:43,073 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       224623791
1       224623791
2       224623791
3       224623791
4       224623791
          ...    
1883    224623791
1884    224623791
1885    224623791
1886    224623791
1887    224623791
Name: account_id, Length: 1888, dtype: int64
2025-05-08 22:33:43,073 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:43,080 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:43,082 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:43,082 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:43,082 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:43,082 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:43,092 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 94-93
2025-05-08 22:33:43,092 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:43,095 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 224623791
2025-05-08 22:33:43,096 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:43,096 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:43,114 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 90905-89017
2025-05-08 22:33:43,114 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=94, account_id=22553901) of 250
2025-05-08 22:33:43,114 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/22553901/match-history?only_stored_history=true
2025-05-08 22:33:43,115 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:43,373 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/22553901/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:43,378 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:43,379 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      22553901
1      22553901
2      22553901
3      22553901
4      22553901
         ...   
738    22553901
739    22553901
740    22553901
741    22553901
742    22553901
Name: account_id, Length: 743, dtype: int64
2025-05-08 22:33:43,379 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6040
2025-05-08 22:33:43,379 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4185
2025-05-08 22:33:43,379 [DEBUG] [root.generate_player_performance_metrics] match_total: 743
2025-05-08 22:33:43,380 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      22553901
1      22553901
2      22553901
3      22553901
4      22553901
         ...   
738    22553901
739    22553901
740    22553901
741    22553901
742    22553901
Name: account_id, Length: 743, dtype: int64
2025-05-08 22:33:43,380 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:43,385 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:43,386 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:43,386 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:43,386 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:43,386 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:43,395 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 95-94
2025-05-08 22:33:43,395 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:43,397 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 22553901
2025-05-08 22:33:43,397 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:43,397 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:43,404 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 91648-90905
2025-05-08 22:33:43,405 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=95, account_id=215382319) of 250
2025-05-08 22:33:43,405 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/215382319/match-history?only_stored_history=true
2025-05-08 22:33:43,405 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:43,662 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/215382319/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:43,692 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:43,693 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       215382319
1       215382319
2       215382319
3       215382319
4       215382319
          ...    
1078    215382319
1079    215382319
1080    215382319
1081    215382319
1082    215382319
Name: account_id, Length: 1083, dtype: int64
2025-05-08 22:33:43,693 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8380
2025-05-08 22:33:43,693 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5663
2025-05-08 22:33:43,693 [DEBUG] [root.generate_player_performance_metrics] match_total: 1083
2025-05-08 22:33:43,694 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       215382319
1       215382319
2       215382319
3       215382319
4       215382319
          ...    
1078    215382319
1079    215382319
1080    215382319
1081    215382319
1082    215382319
Name: account_id, Length: 1083, dtype: int64
2025-05-08 22:33:43,694 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:43,699 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:43,700 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:43,700 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:43,700 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:43,700 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:43,707 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 96-95
2025-05-08 22:33:43,707 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:43,710 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 215382319
2025-05-08 22:33:43,710 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:43,710 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:43,720 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 92731-91648
2025-05-08 22:33:43,720 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=96, account_id=101168500) of 250
2025-05-08 22:33:43,720 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/101168500/match-history?only_stored_history=true
2025-05-08 22:33:43,721 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:44,187 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/101168500/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:44,190 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:44,190 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      101168500
1      101168500
2      101168500
3      101168500
4      101168500
         ...    
381    101168500
382    101168500
383    101168500
384    101168500
385    101168500
Name: account_id, Length: 386, dtype: int64
2025-05-08 22:33:44,191 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3003
2025-05-08 22:33:44,191 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2052
2025-05-08 22:33:44,191 [DEBUG] [root.generate_player_performance_metrics] match_total: 386
2025-05-08 22:33:44,192 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      101168500
1      101168500
2      101168500
3      101168500
4      101168500
         ...    
381    101168500
382    101168500
383    101168500
384    101168500
385    101168500
Name: account_id, Length: 386, dtype: int64
2025-05-08 22:33:44,192 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:44,196 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:44,197 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:44,198 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:44,198 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:44,198 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:44,204 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 97-96
2025-05-08 22:33:44,204 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:44,206 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 101168500
2025-05-08 22:33:44,206 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:44,206 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:44,213 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 93117-92731
2025-05-08 22:33:44,213 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=97, account_id=231942581) of 250
2025-05-08 22:33:44,213 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/231942581/match-history?only_stored_history=true
2025-05-08 22:33:44,213 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:44,746 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/231942581/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:44,753 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:44,754 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       231942581
1       231942581
2       231942581
3       231942581
4       231942581
          ...    
1034    231942581
1035    231942581
1036    231942581
1037    231942581
1038    231942581
Name: account_id, Length: 1039, dtype: int64
2025-05-08 22:33:44,754 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11395
2025-05-08 22:33:44,754 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7909
2025-05-08 22:33:44,754 [DEBUG] [root.generate_player_performance_metrics] match_total: 1039
2025-05-08 22:33:44,755 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       231942581
1       231942581
2       231942581
3       231942581
4       231942581
          ...    
1034    231942581
1035    231942581
1036    231942581
1037    231942581
1038    231942581
Name: account_id, Length: 1039, dtype: int64
2025-05-08 22:33:44,755 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:44,760 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:44,761 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:44,761 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:44,761 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:44,761 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:44,769 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 98-97
2025-05-08 22:33:44,769 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:44,771 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 231942581
2025-05-08 22:33:44,772 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:44,772 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:44,781 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 94156-93117
2025-05-08 22:33:44,781 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=98, account_id=1873712877) of 250
2025-05-08 22:33:44,781 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1873712877/match-history?only_stored_history=true
2025-05-08 22:33:44,781 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:45,164 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1873712877/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:45,165 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:45,166 [DEBUG] [root.generate_player_performance_metrics] stats for player 0    1873712877
1    1873712877
Name: account_id, dtype: int64
2025-05-08 22:33:45,166 [DEBUG] [root.generate_player_performance_metrics] total_kills: 46
2025-05-08 22:33:45,166 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1
2025-05-08 22:33:45,166 [DEBUG] [root.generate_player_performance_metrics] match_total: 2
2025-05-08 22:33:45,167 [WARNING] [root.compute_player_stats] No player stats calculated for player 0    1873712877
1    1873712877
Name: account_id, dtype: int64
2025-05-08 22:33:45,167 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:45,171 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:45,172 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:45,172 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:45,172 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:45,172 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:45,180 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 99-98
2025-05-08 22:33:45,180 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:45,182 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1873712877
2025-05-08 22:33:45,182 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:45,182 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:45,187 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 94158-94156
2025-05-08 22:33:45,187 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=99, account_id=153111731) of 250
2025-05-08 22:33:45,187 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/153111731/match-history?only_stored_history=true
2025-05-08 22:33:45,188 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:45,432 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/153111731/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:45,471 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:45,471 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       153111731
1       153111731
2       153111731
3       153111731
4       153111731
          ...    
1292    153111731
1293    153111731
1294    153111731
1295    153111731
1296    153111731
Name: account_id, Length: 1297, dtype: int64
2025-05-08 22:33:45,471 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10052
2025-05-08 22:33:45,471 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10766
2025-05-08 22:33:45,471 [DEBUG] [root.generate_player_performance_metrics] match_total: 1297
2025-05-08 22:33:45,472 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       153111731
1       153111731
2       153111731
3       153111731
4       153111731
          ...    
1292    153111731
1293    153111731
1294    153111731
1295    153111731
1296    153111731
Name: account_id, Length: 1297, dtype: int64
2025-05-08 22:33:45,472 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:45,477 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:45,478 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:45,478 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:45,478 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:45,479 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:45,486 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 100-99
2025-05-08 22:33:45,486 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:45,488 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 153111731
2025-05-08 22:33:45,488 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:45,489 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:45,499 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 95455-94158
2025-05-08 22:33:45,500 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 48.65seconds. Processed 100 of 250 players
2025-05-08 22:33:45,500 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=100, account_id=117549667) of 250
2025-05-08 22:33:45,500 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/117549667/match-history?only_stored_history=true
2025-05-08 22:33:45,500 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:45,949 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/117549667/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:45,952 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:45,953 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      117549667
1      117549667
2      117549667
3      117549667
4      117549667
         ...    
374    117549667
375    117549667
376    117549667
377    117549667
378    117549667
Name: account_id, Length: 379, dtype: int64
2025-05-08 22:33:45,953 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2937
2025-05-08 22:33:45,953 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2950
2025-05-08 22:33:45,953 [DEBUG] [root.generate_player_performance_metrics] match_total: 379
2025-05-08 22:33:45,954 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      117549667
1      117549667
2      117549667
3      117549667
4      117549667
         ...    
374    117549667
375    117549667
376    117549667
377    117549667
378    117549667
Name: account_id, Length: 379, dtype: int64
2025-05-08 22:33:45,954 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:45,959 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:45,960 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:45,960 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:45,960 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:45,960 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:45,969 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 101-100
2025-05-08 22:33:45,969 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:45,971 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 117549667
2025-05-08 22:33:45,971 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:45,971 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:45,978 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 95834-95455
2025-05-08 22:33:45,978 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=101, account_id=145596499) of 250
2025-05-08 22:33:45,978 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/145596499/match-history?only_stored_history=true
2025-05-08 22:33:45,978 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:46,527 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/145596499/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:46,614 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:46,614 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       145596499
1       145596499
2       145596499
3       145596499
4       145596499
          ...    
1370    145596499
1371    145596499
1372    145596499
1373    145596499
1374    145596499
Name: account_id, Length: 1375, dtype: int64
2025-05-08 22:33:46,615 [DEBUG] [root.generate_player_performance_metrics] total_kills: 16181
2025-05-08 22:33:46,615 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 12746
2025-05-08 22:33:46,615 [DEBUG] [root.generate_player_performance_metrics] match_total: 1375
2025-05-08 22:33:46,616 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       145596499
1       145596499
2       145596499
3       145596499
4       145596499
          ...    
1370    145596499
1371    145596499
1372    145596499
1373    145596499
1374    145596499
Name: account_id, Length: 1375, dtype: int64
2025-05-08 22:33:46,616 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:46,621 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:46,622 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:46,622 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:46,622 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:46,622 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:46,631 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 102-101
2025-05-08 22:33:46,631 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:46,633 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 145596499
2025-05-08 22:33:46,633 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:46,633 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:46,645 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 97209-95834
2025-05-08 22:33:46,645 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=102, account_id=140515667) of 250
2025-05-08 22:33:46,645 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/140515667/match-history?only_stored_history=true
2025-05-08 22:33:46,645 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:47,183 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/140515667/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:47,266 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:47,267 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       140515667
1       140515667
2       140515667
3       140515667
4       140515667
          ...    
1285    140515667
1286    140515667
1287    140515667
1288    140515667
1289    140515667
Name: account_id, Length: 1290, dtype: int64
2025-05-08 22:33:47,267 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12772
2025-05-08 22:33:47,267 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9721
2025-05-08 22:33:47,267 [DEBUG] [root.generate_player_performance_metrics] match_total: 1290
2025-05-08 22:33:47,268 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       140515667
1       140515667
2       140515667
3       140515667
4       140515667
          ...    
1285    140515667
1286    140515667
1287    140515667
1288    140515667
1289    140515667
Name: account_id, Length: 1290, dtype: int64
2025-05-08 22:33:47,268 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:47,272 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:47,273 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:47,273 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:47,274 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:47,274 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:47,283 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 103-102
2025-05-08 22:33:47,283 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:47,285 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 140515667
2025-05-08 22:33:47,285 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:47,285 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:47,297 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 98499-97209
2025-05-08 22:33:47,297 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=103, account_id=127981793) of 250
2025-05-08 22:33:47,297 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/127981793/match-history?only_stored_history=true
2025-05-08 22:33:47,297 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:47,756 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/127981793/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:47,759 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:47,760 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      127981793
1      127981793
2      127981793
3      127981793
4      127981793
         ...    
514    127981793
515    127981793
516    127981793
517    127981793
518    127981793
Name: account_id, Length: 519, dtype: int64
2025-05-08 22:33:47,760 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4468
2025-05-08 22:33:47,760 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3399
2025-05-08 22:33:47,760 [DEBUG] [root.generate_player_performance_metrics] match_total: 519
2025-05-08 22:33:47,761 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      127981793
1      127981793
2      127981793
3      127981793
4      127981793
         ...    
514    127981793
515    127981793
516    127981793
517    127981793
518    127981793
Name: account_id, Length: 519, dtype: int64
2025-05-08 22:33:47,761 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:47,766 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:47,767 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:47,767 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:47,767 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:47,767 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:47,775 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 104-103
2025-05-08 22:33:47,775 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:47,777 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 127981793
2025-05-08 22:33:47,778 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:47,778 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:47,784 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 99018-98499
2025-05-08 22:33:47,784 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=104, account_id=382745192) of 250
2025-05-08 22:33:47,784 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/382745192/match-history?only_stored_history=true
2025-05-08 22:33:47,785 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:48,314 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/382745192/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:48,412 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:48,413 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       382745192
1       382745192
2       382745192
3       382745192
4       382745192
          ...    
1735    382745192
1736    382745192
1737    382745192
1738    382745192
1739    382745192
Name: account_id, Length: 1740, dtype: int64
2025-05-08 22:33:48,413 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14445
2025-05-08 22:33:48,413 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11278
2025-05-08 22:33:48,413 [DEBUG] [root.generate_player_performance_metrics] match_total: 1740
2025-05-08 22:33:48,414 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       382745192
1       382745192
2       382745192
3       382745192
4       382745192
          ...    
1735    382745192
1736    382745192
1737    382745192
1738    382745192
1739    382745192
Name: account_id, Length: 1740, dtype: int64
2025-05-08 22:33:48,414 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:48,419 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:48,420 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:48,420 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:48,420 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:48,420 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:48,429 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 105-104
2025-05-08 22:33:48,429 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:48,432 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 382745192
2025-05-08 22:33:48,432 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:48,432 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:48,446 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 100758-99018
2025-05-08 22:33:48,447 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=105, account_id=1844163183) of 250
2025-05-08 22:33:48,447 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1844163183/match-history?only_stored_history=true
2025-05-08 22:33:48,447 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:48,693 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1844163183/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:48,705 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:48,706 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1844163183
1      1844163183
2      1844163183
3      1844163183
4      1844163183
          ...    
622    1844163183
623    1844163183
624    1844163183
625    1844163183
626    1844163183
Name: account_id, Length: 627, dtype: int64
2025-05-08 22:33:48,706 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5885
2025-05-08 22:33:48,706 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4157
2025-05-08 22:33:48,706 [DEBUG] [root.generate_player_performance_metrics] match_total: 627
2025-05-08 22:33:48,707 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1844163183
1      1844163183
2      1844163183
3      1844163183
4      1844163183
          ...    
622    1844163183
623    1844163183
624    1844163183
625    1844163183
626    1844163183
Name: account_id, Length: 627, dtype: int64
2025-05-08 22:33:48,707 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:48,711 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:48,713 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:48,713 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:48,713 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:48,713 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:48,721 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 106-105
2025-05-08 22:33:48,721 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:48,723 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1844163183
2025-05-08 22:33:48,723 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:48,723 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:48,731 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 101385-100758
2025-05-08 22:33:48,731 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=106, account_id=90210159) of 250
2025-05-08 22:33:48,731 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/90210159/match-history?only_stored_history=true
2025-05-08 22:33:48,731 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:49,198 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/90210159/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:49,228 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:49,228 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       90210159
1       90210159
2       90210159
3       90210159
4       90210159
          ...   
1030    90210159
1031    90210159
1032    90210159
1033    90210159
1034    90210159
Name: account_id, Length: 1035, dtype: int64
2025-05-08 22:33:49,229 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8737
2025-05-08 22:33:49,229 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6043
2025-05-08 22:33:49,229 [DEBUG] [root.generate_player_performance_metrics] match_total: 1035
2025-05-08 22:33:49,230 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       90210159
1       90210159
2       90210159
3       90210159
4       90210159
          ...   
1030    90210159
1031    90210159
1032    90210159
1033    90210159
1034    90210159
Name: account_id, Length: 1035, dtype: int64
2025-05-08 22:33:49,230 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:49,235 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:49,236 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:49,236 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:49,236 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:49,236 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:49,245 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 107-106
2025-05-08 22:33:49,245 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:49,247 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 90210159
2025-05-08 22:33:49,247 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:49,247 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:49,256 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 102420-101385
2025-05-08 22:33:49,256 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=107, account_id=457054657) of 250
2025-05-08 22:33:49,256 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/457054657/match-history?only_stored_history=true
2025-05-08 22:33:49,256 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:49,503 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/457054657/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:49,506 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:49,507 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      457054657
1      457054657
2      457054657
3      457054657
4      457054657
         ...    
410    457054657
411    457054657
412    457054657
413    457054657
414    457054657
Name: account_id, Length: 415, dtype: int64
2025-05-08 22:33:49,507 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2810
2025-05-08 22:33:49,507 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2349
2025-05-08 22:33:49,507 [DEBUG] [root.generate_player_performance_metrics] match_total: 415
2025-05-08 22:33:49,508 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      457054657
1      457054657
2      457054657
3      457054657
4      457054657
         ...    
410    457054657
411    457054657
412    457054657
413    457054657
414    457054657
Name: account_id, Length: 415, dtype: int64
2025-05-08 22:33:49,508 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:49,512 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:49,514 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:49,514 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:49,514 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:49,514 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:49,520 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 108-107
2025-05-08 22:33:49,520 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:49,522 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 457054657
2025-05-08 22:33:49,522 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:49,522 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:49,529 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 102835-102420
2025-05-08 22:33:49,529 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=108, account_id=146532432) of 250
2025-05-08 22:33:49,529 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/146532432/match-history?only_stored_history=true
2025-05-08 22:33:49,530 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:49,806 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/146532432/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:49,844 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:49,845 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       146532432
1       146532432
2       146532432
3       146532432
4       146532432
          ...    
1279    146532432
1280    146532432
1281    146532432
1282    146532432
1283    146532432
Name: account_id, Length: 1284, dtype: int64
2025-05-08 22:33:49,845 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10020
2025-05-08 22:33:49,845 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9109
2025-05-08 22:33:49,845 [DEBUG] [root.generate_player_performance_metrics] match_total: 1284
2025-05-08 22:33:49,846 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       146532432
1       146532432
2       146532432
3       146532432
4       146532432
          ...    
1279    146532432
1280    146532432
1281    146532432
1282    146532432
1283    146532432
Name: account_id, Length: 1284, dtype: int64
2025-05-08 22:33:49,846 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:49,852 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:49,853 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:49,853 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:49,853 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:49,854 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:49,862 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 109-108
2025-05-08 22:33:49,862 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:49,864 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 146532432
2025-05-08 22:33:49,864 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:49,865 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:49,876 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 104119-102835
2025-05-08 22:33:49,876 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=109, account_id=82120368) of 250
2025-05-08 22:33:49,876 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/82120368/match-history?only_stored_history=true
2025-05-08 22:33:49,877 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:50,113 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/82120368/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:50,132 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:50,133 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       82120368
1       82120368
2       82120368
3       82120368
4       82120368
          ...   
1679    82120368
1680    82120368
1681    82120368
1682    82120368
1683    82120368
Name: account_id, Length: 1684, dtype: int64
2025-05-08 22:33:50,133 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12660
2025-05-08 22:33:50,133 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 13478
2025-05-08 22:33:50,133 [DEBUG] [root.generate_player_performance_metrics] match_total: 1684
2025-05-08 22:33:50,134 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       82120368
1       82120368
2       82120368
3       82120368
4       82120368
          ...   
1679    82120368
1680    82120368
1681    82120368
1682    82120368
1683    82120368
Name: account_id, Length: 1684, dtype: int64
2025-05-08 22:33:50,134 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:50,139 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:50,140 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:50,140 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:50,140 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:50,140 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:50,149 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 110-109
2025-05-08 22:33:50,150 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:50,152 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 82120368
2025-05-08 22:33:50,152 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:50,152 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:50,167 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 105803-104119
2025-05-08 22:33:50,167 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 53.32seconds. Processed 110 of 250 players
2025-05-08 22:33:50,167 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=110, account_id=253492067) of 250
2025-05-08 22:33:50,167 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/253492067/match-history?only_stored_history=true
2025-05-08 22:33:50,169 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:50,457 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/253492067/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:50,497 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:50,498 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       253492067
1       253492067
2       253492067
3       253492067
4       253492067
          ...    
1258    253492067
1259    253492067
1260    253492067
1261    253492067
1262    253492067
Name: account_id, Length: 1263, dtype: int64
2025-05-08 22:33:50,498 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8615
2025-05-08 22:33:50,498 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8381
2025-05-08 22:33:50,498 [DEBUG] [root.generate_player_performance_metrics] match_total: 1263
2025-05-08 22:33:50,499 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       253492067
1       253492067
2       253492067
3       253492067
4       253492067
          ...    
1258    253492067
1259    253492067
1260    253492067
1261    253492067
1262    253492067
Name: account_id, Length: 1263, dtype: int64
2025-05-08 22:33:50,499 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:50,503 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:50,504 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:50,505 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:50,505 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:50,505 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:50,513 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 111-110
2025-05-08 22:33:50,513 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:50,515 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 253492067
2025-05-08 22:33:50,515 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:50,515 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:50,526 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 107066-105803
2025-05-08 22:33:50,526 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=111, account_id=1555010968) of 250
2025-05-08 22:33:50,526 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1555010968/match-history?only_stored_history=true
2025-05-08 22:33:50,527 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:50,938 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1555010968/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:50,940 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:50,941 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1555010968
1      1555010968
2      1555010968
3      1555010968
4      1555010968
          ...    
140    1555010968
141    1555010968
142    1555010968
143    1555010968
144    1555010968
Name: account_id, Length: 145, dtype: int64
2025-05-08 22:33:50,941 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1684
2025-05-08 22:33:50,941 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 690
2025-05-08 22:33:50,941 [DEBUG] [root.generate_player_performance_metrics] match_total: 145
2025-05-08 22:33:50,942 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1555010968
1      1555010968
2      1555010968
3      1555010968
4      1555010968
          ...    
140    1555010968
141    1555010968
142    1555010968
143    1555010968
144    1555010968
Name: account_id, Length: 145, dtype: int64
2025-05-08 22:33:50,942 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:50,947 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:50,948 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:50,948 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:50,948 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:50,948 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:50,954 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 112-111
2025-05-08 22:33:50,954 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:50,956 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1555010968
2025-05-08 22:33:50,956 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:50,957 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:50,962 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 107211-107066
2025-05-08 22:33:50,962 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=112, account_id=292759720) of 250
2025-05-08 22:33:50,962 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/292759720/match-history?only_stored_history=true
2025-05-08 22:33:50,963 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:51,183 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/292759720/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:51,184 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:51,185 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     292759720
1     292759720
2     292759720
3     292759720
4     292759720
5     292759720
6     292759720
7     292759720
8     292759720
9     292759720
10    292759720
11    292759720
12    292759720
13    292759720
14    292759720
15    292759720
16    292759720
17    292759720
18    292759720
19    292759720
20    292759720
21    292759720
22    292759720
23    292759720
24    292759720
25    292759720
26    292759720
27    292759720
28    292759720
29    292759720
30    292759720
31    292759720
32    292759720
33    292759720
34    292759720
35    292759720
36    292759720
37    292759720
38    292759720
39    292759720
40    292759720
41    292759720
42    292759720
43    292759720
44    292759720
45    292759720
46    292759720
47    292759720
Name: account_id, dtype: int64
2025-05-08 22:33:51,185 [DEBUG] [root.generate_player_performance_metrics] total_kills: 649
2025-05-08 22:33:51,185 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 166
2025-05-08 22:33:51,185 [DEBUG] [root.generate_player_performance_metrics] match_total: 48
2025-05-08 22:33:51,186 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     292759720
1     292759720
2     292759720
3     292759720
4     292759720
5     292759720
6     292759720
7     292759720
8     292759720
9     292759720
10    292759720
11    292759720
12    292759720
13    292759720
14    292759720
15    292759720
16    292759720
17    292759720
18    292759720
19    292759720
20    292759720
21    292759720
22    292759720
23    292759720
24    292759720
25    292759720
26    292759720
27    292759720
28    292759720
29    292759720
30    292759720
31    292759720
32    292759720
33    292759720
34    292759720
35    292759720
36    292759720
37    292759720
38    292759720
39    292759720
40    292759720
41    292759720
42    292759720
43    292759720
44    292759720
45    292759720
46    292759720
47    292759720
Name: account_id, dtype: int64
2025-05-08 22:33:51,186 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:51,190 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:51,192 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:51,192 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:51,192 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:51,192 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:51,200 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 113-112
2025-05-08 22:33:51,200 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:51,202 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 292759720
2025-05-08 22:33:51,202 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:51,203 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:51,208 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 107259-107211
2025-05-08 22:33:51,208 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=113, account_id=1133487370) of 250
2025-05-08 22:33:51,208 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1133487370/match-history?only_stored_history=true
2025-05-08 22:33:51,209 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:51,509 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1133487370/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:51,543 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:51,544 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1133487370
1       1133487370
2       1133487370
3       1133487370
4       1133487370
           ...    
1106    1133487370
1107    1133487370
1108    1133487370
1109    1133487370
1110    1133487370
Name: account_id, Length: 1111, dtype: int64
2025-05-08 22:33:51,544 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7756
2025-05-08 22:33:51,544 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6164
2025-05-08 22:33:51,544 [DEBUG] [root.generate_player_performance_metrics] match_total: 1111
2025-05-08 22:33:51,545 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1133487370
1       1133487370
2       1133487370
3       1133487370
4       1133487370
           ...    
1106    1133487370
1107    1133487370
1108    1133487370
1109    1133487370
1110    1133487370
Name: account_id, Length: 1111, dtype: int64
2025-05-08 22:33:51,545 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:51,550 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:51,551 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:51,551 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:51,551 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:51,551 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:51,560 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 114-113
2025-05-08 22:33:51,560 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:51,562 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1133487370
2025-05-08 22:33:51,562 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:51,562 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:51,572 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 108370-107259
2025-05-08 22:33:51,572 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=114, account_id=36607982) of 250
2025-05-08 22:33:51,572 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/36607982/match-history?only_stored_history=true
2025-05-08 22:33:51,573 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:52,066 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/36607982/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:52,197 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:52,198 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       36607982
1       36607982
2       36607982
3       36607982
4       36607982
          ...   
2320    36607982
2321    36607982
2322    36607982
2323    36607982
2324    36607982
Name: account_id, Length: 2325, dtype: int64
2025-05-08 22:33:52,198 [DEBUG] [root.generate_player_performance_metrics] total_kills: 16076
2025-05-08 22:33:52,198 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 14971
2025-05-08 22:33:52,198 [DEBUG] [root.generate_player_performance_metrics] match_total: 2325
2025-05-08 22:33:52,198 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       36607982
1       36607982
2       36607982
3       36607982
4       36607982
          ...   
2320    36607982
2321    36607982
2322    36607982
2323    36607982
2324    36607982
Name: account_id, Length: 2325, dtype: int64
2025-05-08 22:33:52,198 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:52,204 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:52,205 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:52,205 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:52,205 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:52,205 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:52,213 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 115-114
2025-05-08 22:33:52,213 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:52,217 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 36607982
2025-05-08 22:33:52,218 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:52,218 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:52,235 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 110695-108370
2025-05-08 22:33:52,235 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=115, account_id=1849131735) of 250
2025-05-08 22:33:52,235 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1849131735/match-history?only_stored_history=true
2025-05-08 22:33:52,235 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:52,686 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1849131735/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:52,690 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:52,691 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1849131735
1      1849131735
2      1849131735
3      1849131735
4      1849131735
          ...    
635    1849131735
636    1849131735
637    1849131735
638    1849131735
639    1849131735
Name: account_id, Length: 640, dtype: int64
2025-05-08 22:33:52,691 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5851
2025-05-08 22:33:52,691 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4194
2025-05-08 22:33:52,691 [DEBUG] [root.generate_player_performance_metrics] match_total: 640
2025-05-08 22:33:52,692 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1849131735
1      1849131735
2      1849131735
3      1849131735
4      1849131735
          ...    
635    1849131735
636    1849131735
637    1849131735
638    1849131735
639    1849131735
Name: account_id, Length: 640, dtype: int64
2025-05-08 22:33:52,692 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:52,697 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:52,698 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:52,698 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:52,698 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:52,698 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:52,706 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 116-115
2025-05-08 22:33:52,707 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:52,708 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1849131735
2025-05-08 22:33:52,709 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:52,709 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:52,717 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 111335-110695
2025-05-08 22:33:52,717 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=116, account_id=1694632809) of 250
2025-05-08 22:33:52,717 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1694632809/match-history?only_stored_history=true
2025-05-08 22:33:52,717 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:52,993 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1694632809/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:53,001 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:53,001 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1694632809
1      1694632809
2      1694632809
3      1694632809
4      1694632809
          ...    
798    1694632809
799    1694632809
800    1694632809
801    1694632809
802    1694632809
Name: account_id, Length: 803, dtype: int64
2025-05-08 22:33:53,001 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7132
2025-05-08 22:33:53,002 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3736
2025-05-08 22:33:53,002 [DEBUG] [root.generate_player_performance_metrics] match_total: 803
2025-05-08 22:33:53,002 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1694632809
1      1694632809
2      1694632809
3      1694632809
4      1694632809
          ...    
798    1694632809
799    1694632809
800    1694632809
801    1694632809
802    1694632809
Name: account_id, Length: 803, dtype: int64
2025-05-08 22:33:53,002 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:53,007 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:53,008 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:53,008 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:53,009 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:53,009 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:53,017 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 117-116
2025-05-08 22:33:53,017 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:53,019 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1694632809
2025-05-08 22:33:53,019 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:53,019 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:53,027 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 112138-111335
2025-05-08 22:33:53,027 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=117, account_id=113995654) of 250
2025-05-08 22:33:53,027 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/113995654/match-history?only_stored_history=true
2025-05-08 22:33:53,028 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:53,478 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/113995654/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:53,481 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:53,481 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      113995654
1      113995654
2      113995654
3      113995654
4      113995654
         ...    
336    113995654
337    113995654
338    113995654
339    113995654
340    113995654
Name: account_id, Length: 341, dtype: int64
2025-05-08 22:33:53,482 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2517
2025-05-08 22:33:53,482 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2471
2025-05-08 22:33:53,482 [DEBUG] [root.generate_player_performance_metrics] match_total: 341
2025-05-08 22:33:53,483 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      113995654
1      113995654
2      113995654
3      113995654
4      113995654
         ...    
336    113995654
337    113995654
338    113995654
339    113995654
340    113995654
Name: account_id, Length: 341, dtype: int64
2025-05-08 22:33:53,483 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:53,487 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:53,489 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:53,489 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:53,489 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:53,489 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:53,497 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 118-117
2025-05-08 22:33:53,497 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:53,499 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 113995654
2025-05-08 22:33:53,499 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:53,499 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:53,506 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 112479-112138
2025-05-08 22:33:53,506 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=118, account_id=1099225700) of 250
2025-05-08 22:33:53,506 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1099225700/match-history?only_stored_history=true
2025-05-08 22:33:53,506 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:53,893 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1099225700/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:53,894 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:53,895 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1099225700
1     1099225700
2     1099225700
3     1099225700
4     1099225700
         ...    
64    1099225700
65    1099225700
66    1099225700
67    1099225700
68    1099225700
Name: account_id, Length: 69, dtype: int64
2025-05-08 22:33:53,895 [DEBUG] [root.generate_player_performance_metrics] total_kills: 879
2025-05-08 22:33:53,895 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 273
2025-05-08 22:33:53,895 [DEBUG] [root.generate_player_performance_metrics] match_total: 69
2025-05-08 22:33:53,896 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1099225700
1     1099225700
2     1099225700
3     1099225700
4     1099225700
         ...    
64    1099225700
65    1099225700
66    1099225700
67    1099225700
68    1099225700
Name: account_id, Length: 69, dtype: int64
2025-05-08 22:33:53,896 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:53,900 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:53,901 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:53,902 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:53,902 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:53,902 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:53,909 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 119-118
2025-05-08 22:33:53,909 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:53,911 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1099225700
2025-05-08 22:33:53,912 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:53,912 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:53,917 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 112548-112479
2025-05-08 22:33:53,917 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=119, account_id=334493656) of 250
2025-05-08 22:33:53,917 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/334493656/match-history?only_stored_history=true
2025-05-08 22:33:53,918 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:54,225 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/334493656/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:54,245 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:54,246 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       334493656
1       334493656
2       334493656
3       334493656
4       334493656
          ...    
1307    334493656
1308    334493656
1309    334493656
1310    334493656
1311    334493656
Name: account_id, Length: 1312, dtype: int64
2025-05-08 22:33:54,246 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13141
2025-05-08 22:33:54,247 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10219
2025-05-08 22:33:54,247 [DEBUG] [root.generate_player_performance_metrics] match_total: 1312
2025-05-08 22:33:54,247 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       334493656
1       334493656
2       334493656
3       334493656
4       334493656
          ...    
1307    334493656
1308    334493656
1309    334493656
1310    334493656
1311    334493656
Name: account_id, Length: 1312, dtype: int64
2025-05-08 22:33:54,247 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:54,253 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:54,254 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:54,254 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:54,254 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:54,254 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:54,262 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 120-119
2025-05-08 22:33:54,263 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:54,265 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 334493656
2025-05-08 22:33:54,265 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:54,265 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:54,276 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 113860-112548
2025-05-08 22:33:54,276 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 57.43seconds. Processed 120 of 250 players
2025-05-08 22:33:54,276 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=120, account_id=207697416) of 250
2025-05-08 22:33:54,276 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/207697416/match-history?only_stored_history=true
2025-05-08 22:33:54,277 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:54,747 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/207697416/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:54,836 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:54,837 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       207697416
1       207697416
2       207697416
3       207697416
4       207697416
          ...    
1282    207697416
1283    207697416
1284    207697416
1285    207697416
1286    207697416
Name: account_id, Length: 1287, dtype: int64
2025-05-08 22:33:54,837 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7955
2025-05-08 22:33:54,837 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9681
2025-05-08 22:33:54,837 [DEBUG] [root.generate_player_performance_metrics] match_total: 1287
2025-05-08 22:33:54,838 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       207697416
1       207697416
2       207697416
3       207697416
4       207697416
          ...    
1282    207697416
1283    207697416
1284    207697416
1285    207697416
1286    207697416
Name: account_id, Length: 1287, dtype: int64
2025-05-08 22:33:54,838 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:54,842 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:54,844 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:54,844 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:54,844 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:54,844 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:54,853 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 121-120
2025-05-08 22:33:54,853 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:54,855 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 207697416
2025-05-08 22:33:54,855 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:54,855 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:54,866 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 115147-113860
2025-05-08 22:33:54,866 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=121, account_id=936546405) of 250
2025-05-08 22:33:54,866 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/936546405/match-history?only_stored_history=true
2025-05-08 22:33:54,866 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:55,293 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/936546405/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:55,320 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:55,320 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      936546405
1      936546405
2      936546405
3      936546405
4      936546405
         ...    
970    936546405
971    936546405
972    936546405
973    936546405
974    936546405
Name: account_id, Length: 975, dtype: int64
2025-05-08 22:33:55,321 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4821
2025-05-08 22:33:55,321 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6223
2025-05-08 22:33:55,321 [DEBUG] [root.generate_player_performance_metrics] match_total: 975
2025-05-08 22:33:55,322 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      936546405
1      936546405
2      936546405
3      936546405
4      936546405
         ...    
970    936546405
971    936546405
972    936546405
973    936546405
974    936546405
Name: account_id, Length: 975, dtype: int64
2025-05-08 22:33:55,322 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:55,327 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:55,328 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:55,328 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:55,328 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:55,328 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:55,337 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 122-121
2025-05-08 22:33:55,337 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:55,338 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 936546405
2025-05-08 22:33:55,339 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:55,339 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:55,348 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 116122-115147
2025-05-08 22:33:55,348 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=122, account_id=1054961641) of 250
2025-05-08 22:33:55,348 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1054961641/match-history?only_stored_history=true
2025-05-08 22:33:55,348 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:55,624 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1054961641/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:55,717 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:55,717 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1054961641
1       1054961641
2       1054961641
3       1054961641
4       1054961641
           ...    
1484    1054961641
1485    1054961641
1486    1054961641
1487    1054961641
1488    1054961641
Name: account_id, Length: 1489, dtype: int64
2025-05-08 22:33:55,718 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13610
2025-05-08 22:33:55,718 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11483
2025-05-08 22:33:55,718 [DEBUG] [root.generate_player_performance_metrics] match_total: 1489
2025-05-08 22:33:55,719 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1054961641
1       1054961641
2       1054961641
3       1054961641
4       1054961641
           ...    
1484    1054961641
1485    1054961641
1486    1054961641
1487    1054961641
1488    1054961641
Name: account_id, Length: 1489, dtype: int64
2025-05-08 22:33:55,719 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:55,723 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:55,725 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:55,725 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:55,725 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:55,725 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:55,733 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 123-122
2025-05-08 22:33:55,733 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:55,736 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1054961641
2025-05-08 22:33:55,737 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:55,737 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:55,749 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 117611-116122
2025-05-08 22:33:55,749 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=123, account_id=304863023) of 250
2025-05-08 22:33:55,749 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/304863023/match-history?only_stored_history=true
2025-05-08 22:33:55,749 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:56,208 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/304863023/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:56,214 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:56,214 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      304863023
1      304863023
2      304863023
3      304863023
4      304863023
         ...    
875    304863023
876    304863023
877    304863023
878    304863023
879    304863023
Name: account_id, Length: 880, dtype: int64
2025-05-08 22:33:56,214 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7822
2025-05-08 22:33:56,215 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4836
2025-05-08 22:33:56,215 [DEBUG] [root.generate_player_performance_metrics] match_total: 880
2025-05-08 22:33:56,215 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      304863023
1      304863023
2      304863023
3      304863023
4      304863023
         ...    
875    304863023
876    304863023
877    304863023
878    304863023
879    304863023
Name: account_id, Length: 880, dtype: int64
2025-05-08 22:33:56,215 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:56,221 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:56,222 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:56,222 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:56,222 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:56,222 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:56,229 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 124-123
2025-05-08 22:33:56,229 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:56,231 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 304863023
2025-05-08 22:33:56,232 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:56,232 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:56,241 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 118491-117611
2025-05-08 22:33:56,241 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=124, account_id=341658282) of 250
2025-05-08 22:33:56,241 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/341658282/match-history?only_stored_history=true
2025-05-08 22:33:56,242 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:56,675 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/341658282/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:56,678 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:56,678 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      341658282
1      341658282
2      341658282
3      341658282
4      341658282
         ...    
273    341658282
274    341658282
275    341658282
276    341658282
277    341658282
Name: account_id, Length: 278, dtype: int64
2025-05-08 22:33:56,678 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2604
2025-05-08 22:33:56,679 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2090
2025-05-08 22:33:56,679 [DEBUG] [root.generate_player_performance_metrics] match_total: 278
2025-05-08 22:33:56,679 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      341658282
1      341658282
2      341658282
3      341658282
4      341658282
         ...    
273    341658282
274    341658282
275    341658282
276    341658282
277    341658282
Name: account_id, Length: 278, dtype: int64
2025-05-08 22:33:56,679 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:56,684 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:56,685 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:56,686 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:56,686 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:56,686 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:56,693 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 125-124
2025-05-08 22:33:56,693 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:56,695 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 341658282
2025-05-08 22:33:56,695 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:56,695 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:56,701 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 118769-118491
2025-05-08 22:33:56,701 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=125, account_id=1845164969) of 250
2025-05-08 22:33:56,701 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1845164969/match-history?only_stored_history=true
2025-05-08 22:33:56,701 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:57,121 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1845164969/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:57,134 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:57,135 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1845164969
1      1845164969
2      1845164969
3      1845164969
4      1845164969
          ...    
385    1845164969
386    1845164969
387    1845164969
388    1845164969
389    1845164969
Name: account_id, Length: 390, dtype: int64
2025-05-08 22:33:57,135 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3915
2025-05-08 22:33:57,135 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1804
2025-05-08 22:33:57,135 [DEBUG] [root.generate_player_performance_metrics] match_total: 390
2025-05-08 22:33:57,137 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1845164969
1      1845164969
2      1845164969
3      1845164969
4      1845164969
          ...    
385    1845164969
386    1845164969
387    1845164969
388    1845164969
389    1845164969
Name: account_id, Length: 390, dtype: int64
2025-05-08 22:33:57,137 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:57,141 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:57,142 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:57,142 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:57,142 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:57,142 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:57,149 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 126-125
2025-05-08 22:33:57,150 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:57,152 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1845164969
2025-05-08 22:33:57,152 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:57,152 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:57,158 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 119159-118769
2025-05-08 22:33:57,158 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=126, account_id=1032931992) of 250
2025-05-08 22:33:57,158 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1032931992/match-history?only_stored_history=true
2025-05-08 22:33:57,159 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:57,447 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1032931992/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:57,463 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:57,464 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1032931992
1       1032931992
2       1032931992
3       1032931992
4       1032931992
           ...    
1274    1032931992
1275    1032931992
1276    1032931992
1277    1032931992
1278    1032931992
Name: account_id, Length: 1279, dtype: int64
2025-05-08 22:33:57,464 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9167
2025-05-08 22:33:57,464 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8566
2025-05-08 22:33:57,464 [DEBUG] [root.generate_player_performance_metrics] match_total: 1279
2025-05-08 22:33:57,465 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1032931992
1       1032931992
2       1032931992
3       1032931992
4       1032931992
           ...    
1274    1032931992
1275    1032931992
1276    1032931992
1277    1032931992
1278    1032931992
Name: account_id, Length: 1279, dtype: int64
2025-05-08 22:33:57,465 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:57,470 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:57,471 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:57,471 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:57,471 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:57,471 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:57,480 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 127-126
2025-05-08 22:33:57,480 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:57,482 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1032931992
2025-05-08 22:33:57,483 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:57,483 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:57,493 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 120438-119159
2025-05-08 22:33:57,493 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=127, account_id=34634349) of 250
2025-05-08 22:33:57,493 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/34634349/match-history?only_stored_history=true
2025-05-08 22:33:57,494 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:57,816 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/34634349/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:57,919 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:57,920 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       34634349
1       34634349
2       34634349
3       34634349
4       34634349
          ...   
1797    34634349
1798    34634349
1799    34634349
1800    34634349
1801    34634349
Name: account_id, Length: 1802, dtype: int64
2025-05-08 22:33:57,920 [DEBUG] [root.generate_player_performance_metrics] total_kills: 15835
2025-05-08 22:33:57,920 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 12026
2025-05-08 22:33:57,920 [DEBUG] [root.generate_player_performance_metrics] match_total: 1802
2025-05-08 22:33:57,921 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       34634349
1       34634349
2       34634349
3       34634349
4       34634349
          ...   
1797    34634349
1798    34634349
1799    34634349
1800    34634349
1801    34634349
Name: account_id, Length: 1802, dtype: int64
2025-05-08 22:33:57,921 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:57,926 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:57,927 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:57,927 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:57,927 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:57,927 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:57,935 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 128-127
2025-05-08 22:33:57,935 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:57,938 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 34634349
2025-05-08 22:33:57,938 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:57,938 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:57,954 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 122240-120438
2025-05-08 22:33:57,954 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=128, account_id=123031) of 250
2025-05-08 22:33:57,954 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/123031/match-history?only_stored_history=true
2025-05-08 22:33:57,955 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:58,259 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/123031/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:58,375 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:58,376 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       123031
1       123031
2       123031
3       123031
4       123031
         ...  
1804    123031
1805    123031
1806    123031
1807    123031
1808    123031
Name: account_id, Length: 1809, dtype: int64
2025-05-08 22:33:58,376 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13941
2025-05-08 22:33:58,376 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8486
2025-05-08 22:33:58,376 [DEBUG] [root.generate_player_performance_metrics] match_total: 1809
2025-05-08 22:33:58,377 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       123031
1       123031
2       123031
3       123031
4       123031
         ...  
1804    123031
1805    123031
1806    123031
1807    123031
1808    123031
Name: account_id, Length: 1809, dtype: int64
2025-05-08 22:33:58,377 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:58,382 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:58,383 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:58,383 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:58,383 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:58,383 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:58,394 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 129-128
2025-05-08 22:33:58,394 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:58,396 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 123031
2025-05-08 22:33:58,396 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:58,397 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:58,412 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 124049-122240
2025-05-08 22:33:58,412 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=129, account_id=114399341) of 250
2025-05-08 22:33:58,412 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/114399341/match-history?only_stored_history=true
2025-05-08 22:33:58,412 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:58,860 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/114399341/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:58,879 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:58,880 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      114399341
1      114399341
2      114399341
3      114399341
4      114399341
         ...    
670    114399341
671    114399341
672    114399341
673    114399341
674    114399341
Name: account_id, Length: 675, dtype: int64
2025-05-08 22:33:58,880 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4996
2025-05-08 22:33:58,880 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3438
2025-05-08 22:33:58,880 [DEBUG] [root.generate_player_performance_metrics] match_total: 675
2025-05-08 22:33:58,881 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      114399341
1      114399341
2      114399341
3      114399341
4      114399341
         ...    
670    114399341
671    114399341
672    114399341
673    114399341
674    114399341
Name: account_id, Length: 675, dtype: int64
2025-05-08 22:33:58,881 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:58,886 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:58,887 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:58,887 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:58,887 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:58,887 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:58,895 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 130-129
2025-05-08 22:33:58,895 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:58,897 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 114399341
2025-05-08 22:33:58,897 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:58,898 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:58,906 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 124724-124049
2025-05-08 22:33:58,906 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 62.06seconds. Processed 130 of 250 players
2025-05-08 22:33:58,906 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=130, account_id=440369400) of 250
2025-05-08 22:33:58,906 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/440369400/match-history?only_stored_history=true
2025-05-08 22:33:58,907 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:59,179 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/440369400/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:59,198 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:59,199 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      440369400
1      440369400
2      440369400
3      440369400
4      440369400
         ...    
670    440369400
671    440369400
672    440369400
673    440369400
674    440369400
Name: account_id, Length: 675, dtype: int64
2025-05-08 22:33:59,199 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4317
2025-05-08 22:33:59,199 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3100
2025-05-08 22:33:59,199 [DEBUG] [root.generate_player_performance_metrics] match_total: 675
2025-05-08 22:33:59,200 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      440369400
1      440369400
2      440369400
3      440369400
4      440369400
         ...    
670    440369400
671    440369400
672    440369400
673    440369400
674    440369400
Name: account_id, Length: 675, dtype: int64
2025-05-08 22:33:59,200 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:59,204 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:59,206 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:59,206 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:59,206 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:59,206 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:59,213 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 131-130
2025-05-08 22:33:59,213 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:59,215 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 440369400
2025-05-08 22:33:59,215 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:59,215 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:59,222 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 125399-124724
2025-05-08 22:33:59,222 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=131, account_id=348208334) of 250
2025-05-08 22:33:59,222 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/348208334/match-history?only_stored_history=true
2025-05-08 22:33:59,223 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:33:59,654 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/348208334/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:33:59,745 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:33:59,745 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       348208334
1       348208334
2       348208334
3       348208334
4       348208334
          ...    
1169    348208334
1170    348208334
1171    348208334
1172    348208334
1173    348208334
Name: account_id, Length: 1174, dtype: int64
2025-05-08 22:33:59,745 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7715
2025-05-08 22:33:59,746 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8282
2025-05-08 22:33:59,746 [DEBUG] [root.generate_player_performance_metrics] match_total: 1174
2025-05-08 22:33:59,746 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       348208334
1       348208334
2       348208334
3       348208334
4       348208334
          ...    
1169    348208334
1170    348208334
1171    348208334
1172    348208334
1173    348208334
Name: account_id, Length: 1174, dtype: int64
2025-05-08 22:33:59,746 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:33:59,751 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:33:59,752 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:59,752 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:33:59,752 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:33:59,752 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:59,759 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 132-131
2025-05-08 22:33:59,760 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:33:59,762 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 348208334
2025-05-08 22:33:59,762 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:33:59,762 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:33:59,773 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 126573-125399
2025-05-08 22:33:59,773 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=132, account_id=69500517) of 250
2025-05-08 22:33:59,773 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/69500517/match-history?only_stored_history=true
2025-05-08 22:33:59,773 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:00,219 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/69500517/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:00,226 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:00,226 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      69500517
1      69500517
2      69500517
3      69500517
4      69500517
         ...   
900    69500517
901    69500517
902    69500517
903    69500517
904    69500517
Name: account_id, Length: 905, dtype: int64
2025-05-08 22:34:00,227 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6389
2025-05-08 22:34:00,227 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5430
2025-05-08 22:34:00,227 [DEBUG] [root.generate_player_performance_metrics] match_total: 905
2025-05-08 22:34:00,228 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      69500517
1      69500517
2      69500517
3      69500517
4      69500517
         ...   
900    69500517
901    69500517
902    69500517
903    69500517
904    69500517
Name: account_id, Length: 905, dtype: int64
2025-05-08 22:34:00,228 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:00,232 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:00,233 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:00,233 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:00,233 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:00,233 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:00,242 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 133-132
2025-05-08 22:34:00,242 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:00,244 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 69500517
2025-05-08 22:34:00,244 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:00,244 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:00,252 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 127478-126573
2025-05-08 22:34:00,252 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=133, account_id=1035277026) of 250
2025-05-08 22:34:00,252 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1035277026/match-history?only_stored_history=true
2025-05-08 22:34:00,253 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:00,818 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1035277026/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:00,825 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:00,826 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1035277026
1       1035277026
2       1035277026
3       1035277026
4       1035277026
           ...    
1117    1035277026
1118    1035277026
1119    1035277026
1120    1035277026
1121    1035277026
Name: account_id, Length: 1122, dtype: int64
2025-05-08 22:34:00,826 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8923
2025-05-08 22:34:00,826 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6333
2025-05-08 22:34:00,826 [DEBUG] [root.generate_player_performance_metrics] match_total: 1122
2025-05-08 22:34:00,827 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1035277026
1       1035277026
2       1035277026
3       1035277026
4       1035277026
           ...    
1117    1035277026
1118    1035277026
1119    1035277026
1120    1035277026
1121    1035277026
Name: account_id, Length: 1122, dtype: int64
2025-05-08 22:34:00,827 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:00,831 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:00,832 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:00,832 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:00,832 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:00,833 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:00,841 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 134-133
2025-05-08 22:34:00,841 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:00,843 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1035277026
2025-05-08 22:34:00,843 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:00,843 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:00,854 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 128600-127478
2025-05-08 22:34:00,854 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=134, account_id=1842419203) of 250
2025-05-08 22:34:00,854 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1842419203/match-history?only_stored_history=true
2025-05-08 22:34:00,854 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:01,237 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1842419203/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:01,248 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:01,248 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1842419203
1      1842419203
2      1842419203
3      1842419203
4      1842419203
          ...    
370    1842419203
371    1842419203
372    1842419203
373    1842419203
374    1842419203
Name: account_id, Length: 375, dtype: int64
2025-05-08 22:34:01,248 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3371
2025-05-08 22:34:01,248 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2499
2025-05-08 22:34:01,248 [DEBUG] [root.generate_player_performance_metrics] match_total: 375
2025-05-08 22:34:01,249 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1842419203
1      1842419203
2      1842419203
3      1842419203
4      1842419203
          ...    
370    1842419203
371    1842419203
372    1842419203
373    1842419203
374    1842419203
Name: account_id, Length: 375, dtype: int64
2025-05-08 22:34:01,249 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:01,254 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:01,255 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:01,255 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:01,255 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:01,255 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:01,262 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 135-134
2025-05-08 22:34:01,262 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:01,264 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1842419203
2025-05-08 22:34:01,264 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:01,264 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:01,270 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 128975-128600
2025-05-08 22:34:01,270 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=135, account_id=56722106) of 250
2025-05-08 22:34:01,270 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/56722106/match-history?only_stored_history=true
2025-05-08 22:34:01,270 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:01,547 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/56722106/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:01,569 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:01,570 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      56722106
1      56722106
2      56722106
3      56722106
4      56722106
         ...   
796    56722106
797    56722106
798    56722106
799    56722106
800    56722106
Name: account_id, Length: 801, dtype: int64
2025-05-08 22:34:01,570 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4317
2025-05-08 22:34:01,570 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4690
2025-05-08 22:34:01,570 [DEBUG] [root.generate_player_performance_metrics] match_total: 801
2025-05-08 22:34:01,571 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      56722106
1      56722106
2      56722106
3      56722106
4      56722106
         ...   
796    56722106
797    56722106
798    56722106
799    56722106
800    56722106
Name: account_id, Length: 801, dtype: int64
2025-05-08 22:34:01,571 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:01,576 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:01,577 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:01,577 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:01,577 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:01,577 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:01,586 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 136-135
2025-05-08 22:34:01,586 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:01,588 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 56722106
2025-05-08 22:34:01,588 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:01,588 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:01,598 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 129776-128975
2025-05-08 22:34:01,598 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=136, account_id=905064383) of 250
2025-05-08 22:34:01,598 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/905064383/match-history?only_stored_history=true
2025-05-08 22:34:01,599 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:01,881 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/905064383/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:01,894 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:01,894 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       905064383
1       905064383
2       905064383
3       905064383
4       905064383
          ...    
1086    905064383
1087    905064383
1088    905064383
1089    905064383
1090    905064383
Name: account_id, Length: 1091, dtype: int64
2025-05-08 22:34:01,895 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9005
2025-05-08 22:34:01,895 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8025
2025-05-08 22:34:01,895 [DEBUG] [root.generate_player_performance_metrics] match_total: 1091
2025-05-08 22:34:01,896 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       905064383
1       905064383
2       905064383
3       905064383
4       905064383
          ...    
1086    905064383
1087    905064383
1088    905064383
1089    905064383
1090    905064383
Name: account_id, Length: 1091, dtype: int64
2025-05-08 22:34:01,896 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:01,900 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:01,901 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:01,901 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:01,901 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:01,901 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:01,910 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 137-136
2025-05-08 22:34:01,910 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:01,912 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 905064383
2025-05-08 22:34:01,912 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:01,912 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:01,923 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 130867-129776
2025-05-08 22:34:01,923 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=137, account_id=903708588) of 250
2025-05-08 22:34:01,923 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/903708588/match-history?only_stored_history=true
2025-05-08 22:34:01,924 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:02,174 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/903708588/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:02,195 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:02,196 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      903708588
1      903708588
2      903708588
3      903708588
4      903708588
         ...    
734    903708588
735    903708588
736    903708588
737    903708588
738    903708588
Name: account_id, Length: 739, dtype: int64
2025-05-08 22:34:02,196 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6509
2025-05-08 22:34:02,196 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4012
2025-05-08 22:34:02,196 [DEBUG] [root.generate_player_performance_metrics] match_total: 739
2025-05-08 22:34:02,197 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      903708588
1      903708588
2      903708588
3      903708588
4      903708588
         ...    
734    903708588
735    903708588
736    903708588
737    903708588
738    903708588
Name: account_id, Length: 739, dtype: int64
2025-05-08 22:34:02,197 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:02,201 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:02,203 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:02,203 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:02,203 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:02,203 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:02,212 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 138-137
2025-05-08 22:34:02,212 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:02,214 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 903708588
2025-05-08 22:34:02,214 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:02,214 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:02,223 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 131606-130867
2025-05-08 22:34:02,223 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=138, account_id=193669272) of 250
2025-05-08 22:34:02,223 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/193669272/match-history?only_stored_history=true
2025-05-08 22:34:02,223 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:02,462 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/193669272/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:02,466 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:02,466 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      193669272
1      193669272
2      193669272
3      193669272
4      193669272
         ...    
97     193669272
98     193669272
99     193669272
100    193669272
101    193669272
Name: account_id, Length: 102, dtype: int64
2025-05-08 22:34:02,467 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1075
2025-05-08 22:34:02,467 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 626
2025-05-08 22:34:02,467 [DEBUG] [root.generate_player_performance_metrics] match_total: 102
2025-05-08 22:34:02,468 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      193669272
1      193669272
2      193669272
3      193669272
4      193669272
         ...    
97     193669272
98     193669272
99     193669272
100    193669272
101    193669272
Name: account_id, Length: 102, dtype: int64
2025-05-08 22:34:02,468 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:02,472 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:02,473 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:02,473 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:02,473 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:02,473 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:02,481 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 139-138
2025-05-08 22:34:02,481 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:02,483 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 193669272
2025-05-08 22:34:02,483 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:02,483 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:02,489 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 131708-131606
2025-05-08 22:34:02,489 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=139, account_id=1728665586) of 250
2025-05-08 22:34:02,489 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1728665586/match-history?only_stored_history=true
2025-05-08 22:34:02,489 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:02,830 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1728665586/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:02,832 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:02,833 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1728665586
1      1728665586
2      1728665586
3      1728665586
4      1728665586
          ...    
145    1728665586
146    1728665586
147    1728665586
148    1728665586
149    1728665586
Name: account_id, Length: 150, dtype: int64
2025-05-08 22:34:02,833 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1873
2025-05-08 22:34:02,833 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 792
2025-05-08 22:34:02,833 [DEBUG] [root.generate_player_performance_metrics] match_total: 150
2025-05-08 22:34:02,834 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1728665586
1      1728665586
2      1728665586
3      1728665586
4      1728665586
          ...    
145    1728665586
146    1728665586
147    1728665586
148    1728665586
149    1728665586
Name: account_id, Length: 150, dtype: int64
2025-05-08 22:34:02,834 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:02,838 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:02,840 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:02,840 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:02,840 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:02,840 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:02,849 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 140-139
2025-05-08 22:34:02,849 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:02,851 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1728665586
2025-05-08 22:34:02,851 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:02,852 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:02,857 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 131858-131708
2025-05-08 22:34:02,857 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 66.01seconds. Processed 140 of 250 players
2025-05-08 22:34:02,857 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=140, account_id=337277980) of 250
2025-05-08 22:34:02,857 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/337277980/match-history?only_stored_history=true
2025-05-08 22:34:02,858 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:03,130 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/337277980/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:03,161 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:03,162 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      337277980
1      337277980
2      337277980
3      337277980
4      337277980
         ...    
988    337277980
989    337277980
990    337277980
991    337277980
992    337277980
Name: account_id, Length: 993, dtype: int64
2025-05-08 22:34:03,162 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9027
2025-05-08 22:34:03,162 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8892
2025-05-08 22:34:03,162 [DEBUG] [root.generate_player_performance_metrics] match_total: 993
2025-05-08 22:34:03,163 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      337277980
1      337277980
2      337277980
3      337277980
4      337277980
         ...    
988    337277980
989    337277980
990    337277980
991    337277980
992    337277980
Name: account_id, Length: 993, dtype: int64
2025-05-08 22:34:03,163 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:03,168 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:03,169 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:03,169 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:03,169 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:03,169 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:03,177 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 141-140
2025-05-08 22:34:03,177 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:03,180 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 337277980
2025-05-08 22:34:03,180 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:03,180 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:03,189 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 132851-131858
2025-05-08 22:34:03,189 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=141, account_id=1476226744) of 250
2025-05-08 22:34:03,189 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1476226744/match-history?only_stored_history=true
2025-05-08 22:34:03,190 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:03,651 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1476226744/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:03,654 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:03,655 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1476226744
1      1476226744
2      1476226744
3      1476226744
4      1476226744
          ...    
272    1476226744
273    1476226744
274    1476226744
275    1476226744
276    1476226744
Name: account_id, Length: 277, dtype: int64
2025-05-08 22:34:03,655 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2271
2025-05-08 22:34:03,655 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1723
2025-05-08 22:34:03,655 [DEBUG] [root.generate_player_performance_metrics] match_total: 277
2025-05-08 22:34:03,656 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1476226744
1      1476226744
2      1476226744
3      1476226744
4      1476226744
          ...    
272    1476226744
273    1476226744
274    1476226744
275    1476226744
276    1476226744
Name: account_id, Length: 277, dtype: int64
2025-05-08 22:34:03,656 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:03,660 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:03,662 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:03,662 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:03,662 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:03,662 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:03,670 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 142-141
2025-05-08 22:34:03,670 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:03,672 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1476226744
2025-05-08 22:34:03,672 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:03,672 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:03,678 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 133128-132851
2025-05-08 22:34:03,678 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=142, account_id=1258344778) of 250
2025-05-08 22:34:03,678 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1258344778/match-history?only_stored_history=true
2025-05-08 22:34:03,679 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:04,143 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1258344778/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:04,147 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:04,148 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1258344778
1      1258344778
2      1258344778
3      1258344778
4      1258344778
          ...    
647    1258344778
648    1258344778
649    1258344778
650    1258344778
651    1258344778
Name: account_id, Length: 652, dtype: int64
2025-05-08 22:34:04,148 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5240
2025-05-08 22:34:04,148 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4601
2025-05-08 22:34:04,148 [DEBUG] [root.generate_player_performance_metrics] match_total: 652
2025-05-08 22:34:04,149 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1258344778
1      1258344778
2      1258344778
3      1258344778
4      1258344778
          ...    
647    1258344778
648    1258344778
649    1258344778
650    1258344778
651    1258344778
Name: account_id, Length: 652, dtype: int64
2025-05-08 22:34:04,149 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:04,154 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:04,156 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:04,156 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:04,156 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:04,156 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:04,165 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 143-142
2025-05-08 22:34:04,166 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:04,168 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1258344778
2025-05-08 22:34:04,168 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:04,168 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:04,177 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 133780-133128
2025-05-08 22:34:04,177 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=143, account_id=28967214) of 250
2025-05-08 22:34:04,177 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/28967214/match-history?only_stored_history=true
2025-05-08 22:34:04,177 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:04,628 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/28967214/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:04,633 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:04,633 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      28967214
1      28967214
2      28967214
3      28967214
4      28967214
         ...   
618    28967214
619    28967214
620    28967214
621    28967214
622    28967214
Name: account_id, Length: 623, dtype: int64
2025-05-08 22:34:04,634 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5269
2025-05-08 22:34:04,634 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4435
2025-05-08 22:34:04,634 [DEBUG] [root.generate_player_performance_metrics] match_total: 623
2025-05-08 22:34:04,635 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      28967214
1      28967214
2      28967214
3      28967214
4      28967214
         ...   
618    28967214
619    28967214
620    28967214
621    28967214
622    28967214
Name: account_id, Length: 623, dtype: int64
2025-05-08 22:34:04,635 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:04,639 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:04,640 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:04,640 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:04,640 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:04,640 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:04,647 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 144-143
2025-05-08 22:34:04,647 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:04,649 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 28967214
2025-05-08 22:34:04,650 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:04,650 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:04,657 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 134403-133780
2025-05-08 22:34:04,657 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=144, account_id=885996028) of 250
2025-05-08 22:34:04,657 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/885996028/match-history?only_stored_history=true
2025-05-08 22:34:04,657 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:04,897 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/885996028/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:04,900 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:04,900 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      885996028
1      885996028
2      885996028
3      885996028
4      885996028
         ...    
183    885996028
184    885996028
185    885996028
186    885996028
187    885996028
Name: account_id, Length: 188, dtype: int64
2025-05-08 22:34:04,900 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1980
2025-05-08 22:34:04,901 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1513
2025-05-08 22:34:04,901 [DEBUG] [root.generate_player_performance_metrics] match_total: 188
2025-05-08 22:34:04,901 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      885996028
1      885996028
2      885996028
3      885996028
4      885996028
         ...    
183    885996028
184    885996028
185    885996028
186    885996028
187    885996028
Name: account_id, Length: 188, dtype: int64
2025-05-08 22:34:04,901 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:04,906 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:04,907 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:04,907 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:04,907 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:04,907 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:04,913 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 145-144
2025-05-08 22:34:04,913 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:04,915 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 885996028
2025-05-08 22:34:04,915 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:04,915 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:04,922 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 134591-134403
2025-05-08 22:34:04,922 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=145, account_id=1437667142) of 250
2025-05-08 22:34:04,922 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1437667142/match-history?only_stored_history=true
2025-05-08 22:34:04,922 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:05,185 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1437667142/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:05,199 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:05,199 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1437667142
1      1437667142
2      1437667142
3      1437667142
4      1437667142
          ...    
524    1437667142
525    1437667142
526    1437667142
527    1437667142
528    1437667142
Name: account_id, Length: 529, dtype: int64
2025-05-08 22:34:05,200 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6374
2025-05-08 22:34:05,200 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2846
2025-05-08 22:34:05,200 [DEBUG] [root.generate_player_performance_metrics] match_total: 529
2025-05-08 22:34:05,201 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1437667142
1      1437667142
2      1437667142
3      1437667142
4      1437667142
          ...    
524    1437667142
525    1437667142
526    1437667142
527    1437667142
528    1437667142
Name: account_id, Length: 529, dtype: int64
2025-05-08 22:34:05,201 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:05,206 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:05,207 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:05,207 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:05,207 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:05,207 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:05,215 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 146-145
2025-05-08 22:34:05,215 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:05,217 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1437667142
2025-05-08 22:34:05,217 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:05,218 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:05,224 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 135120-134591
2025-05-08 22:34:05,224 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=146, account_id=113856713) of 250
2025-05-08 22:34:05,224 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/113856713/match-history?only_stored_history=true
2025-05-08 22:34:05,225 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:05,683 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/113856713/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:05,688 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:05,689 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      113856713
1      113856713
2      113856713
3      113856713
4      113856713
         ...    
852    113856713
853    113856713
854    113856713
855    113856713
856    113856713
Name: account_id, Length: 857, dtype: int64
2025-05-08 22:34:05,689 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5241
2025-05-08 22:34:05,689 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4036
2025-05-08 22:34:05,689 [DEBUG] [root.generate_player_performance_metrics] match_total: 857
2025-05-08 22:34:05,690 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      113856713
1      113856713
2      113856713
3      113856713
4      113856713
         ...    
852    113856713
853    113856713
854    113856713
855    113856713
856    113856713
Name: account_id, Length: 857, dtype: int64
2025-05-08 22:34:05,690 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:05,695 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:05,696 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:05,696 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:05,696 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:05,696 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:05,705 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 147-146
2025-05-08 22:34:05,705 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:05,707 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 113856713
2025-05-08 22:34:05,707 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:05,707 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:05,715 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 135977-135120
2025-05-08 22:34:05,715 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=147, account_id=405142998) of 250
2025-05-08 22:34:05,715 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/405142998/match-history?only_stored_history=true
2025-05-08 22:34:05,716 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:05,952 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/405142998/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:05,953 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:05,954 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     405142998
1     405142998
2     405142998
3     405142998
4     405142998
5     405142998
6     405142998
7     405142998
8     405142998
9     405142998
10    405142998
11    405142998
12    405142998
13    405142998
14    405142998
15    405142998
16    405142998
17    405142998
18    405142998
19    405142998
20    405142998
21    405142998
22    405142998
23    405142998
24    405142998
25    405142998
26    405142998
27    405142998
28    405142998
29    405142998
Name: account_id, dtype: int64
2025-05-08 22:34:05,954 [DEBUG] [root.generate_player_performance_metrics] total_kills: 376
2025-05-08 22:34:05,954 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 111
2025-05-08 22:34:05,954 [DEBUG] [root.generate_player_performance_metrics] match_total: 30
2025-05-08 22:34:05,955 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     405142998
1     405142998
2     405142998
3     405142998
4     405142998
5     405142998
6     405142998
7     405142998
8     405142998
9     405142998
10    405142998
11    405142998
12    405142998
13    405142998
14    405142998
15    405142998
16    405142998
17    405142998
18    405142998
19    405142998
20    405142998
21    405142998
22    405142998
23    405142998
24    405142998
25    405142998
26    405142998
27    405142998
28    405142998
29    405142998
Name: account_id, dtype: int64
2025-05-08 22:34:05,955 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:05,959 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:05,961 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:05,961 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:05,962 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:05,962 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:05,968 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 148-147
2025-05-08 22:34:05,968 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:05,970 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 405142998
2025-05-08 22:34:05,970 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:05,971 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:05,976 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 136007-135977
2025-05-08 22:34:05,976 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=148, account_id=109154975) of 250
2025-05-08 22:34:05,976 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/109154975/match-history?only_stored_history=true
2025-05-08 22:34:05,977 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:06,403 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/109154975/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:06,413 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:06,415 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      109154975
1      109154975
2      109154975
3      109154975
4      109154975
         ...    
414    109154975
415    109154975
416    109154975
417    109154975
418    109154975
Name: account_id, Length: 419, dtype: int64
2025-05-08 22:34:06,415 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3769
2025-05-08 22:34:06,415 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2797
2025-05-08 22:34:06,415 [DEBUG] [root.generate_player_performance_metrics] match_total: 419
2025-05-08 22:34:06,416 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      109154975
1      109154975
2      109154975
3      109154975
4      109154975
         ...    
414    109154975
415    109154975
416    109154975
417    109154975
418    109154975
Name: account_id, Length: 419, dtype: int64
2025-05-08 22:34:06,416 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:06,420 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:06,422 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:06,422 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:06,422 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:06,422 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:06,429 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 149-148
2025-05-08 22:34:06,429 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:06,431 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 109154975
2025-05-08 22:34:06,431 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:06,431 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:06,438 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 136426-136007
2025-05-08 22:34:06,438 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=149, account_id=1839250087) of 250
2025-05-08 22:34:06,438 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1839250087/match-history?only_stored_history=true
2025-05-08 22:34:06,438 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:06,837 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1839250087/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:06,838 [ERROR] [root.fetch_player_match_history] player_match_history is empty in fetch_player_match_history, p_id: 1839250087
2025-05-08 22:34:06,838 [WARNING] [root.run_etl_player_hero_match_trends] No match history found for player 1839250087
2025-05-08 22:34:06,838 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 69.99seconds. Processed 150 of 250 players
2025-05-08 22:34:06,838 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=150, account_id=127339570) of 250
2025-05-08 22:34:06,838 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/127339570/match-history?only_stored_history=true
2025-05-08 22:34:06,838 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:07,302 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/127339570/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:07,307 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:07,308 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      127339570
1      127339570
2      127339570
3      127339570
4      127339570
         ...    
877    127339570
878    127339570
879    127339570
880    127339570
881    127339570
Name: account_id, Length: 882, dtype: int64
2025-05-08 22:34:07,308 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3486
2025-05-08 22:34:07,308 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4409
2025-05-08 22:34:07,308 [DEBUG] [root.generate_player_performance_metrics] match_total: 882
2025-05-08 22:34:07,309 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      127339570
1      127339570
2      127339570
3      127339570
4      127339570
         ...    
877    127339570
878    127339570
879    127339570
880    127339570
881    127339570
Name: account_id, Length: 882, dtype: int64
2025-05-08 22:34:07,309 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:07,314 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:07,315 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:07,315 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:07,315 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:07,315 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:07,323 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 150-149
2025-05-08 22:34:07,323 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:07,325 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 127339570
2025-05-08 22:34:07,325 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:07,325 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:07,334 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 137308-136426
2025-05-08 22:34:07,334 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=151, account_id=95309968) of 250
2025-05-08 22:34:07,334 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/95309968/match-history?only_stored_history=true
2025-05-08 22:34:07,334 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:07,826 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/95309968/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:07,831 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:07,832 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      95309968
1      95309968
2      95309968
3      95309968
4      95309968
         ...   
927    95309968
928    95309968
929    95309968
930    95309968
931    95309968
Name: account_id, Length: 932, dtype: int64
2025-05-08 22:34:07,832 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7278
2025-05-08 22:34:07,832 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5481
2025-05-08 22:34:07,832 [DEBUG] [root.generate_player_performance_metrics] match_total: 932
2025-05-08 22:34:07,833 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      95309968
1      95309968
2      95309968
3      95309968
4      95309968
         ...   
927    95309968
928    95309968
929    95309968
930    95309968
931    95309968
Name: account_id, Length: 932, dtype: int64
2025-05-08 22:34:07,833 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:07,837 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:07,839 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:07,839 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:07,839 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:07,839 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:07,849 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 151-150
2025-05-08 22:34:07,849 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:07,851 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 95309968
2025-05-08 22:34:07,851 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:07,851 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:07,859 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 138240-137308
2025-05-08 22:34:07,859 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=152, account_id=1133201348) of 250
2025-05-08 22:34:07,859 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1133201348/match-history?only_stored_history=true
2025-05-08 22:34:07,860 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:08,142 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1133201348/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:08,171 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:08,172 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1133201348
1      1133201348
2      1133201348
3      1133201348
4      1133201348
          ...    
945    1133201348
946    1133201348
947    1133201348
948    1133201348
949    1133201348
Name: account_id, Length: 950, dtype: int64
2025-05-08 22:34:08,172 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7310
2025-05-08 22:34:08,172 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6064
2025-05-08 22:34:08,172 [DEBUG] [root.generate_player_performance_metrics] match_total: 950
2025-05-08 22:34:08,173 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1133201348
1      1133201348
2      1133201348
3      1133201348
4      1133201348
          ...    
945    1133201348
946    1133201348
947    1133201348
948    1133201348
949    1133201348
Name: account_id, Length: 950, dtype: int64
2025-05-08 22:34:08,173 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:08,178 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:08,179 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:08,179 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:08,179 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:08,179 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:08,186 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 152-151
2025-05-08 22:34:08,186 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:08,188 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1133201348
2025-05-08 22:34:08,188 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:08,188 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:08,198 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 139190-138240
2025-05-08 22:34:08,198 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=153, account_id=279286466) of 250
2025-05-08 22:34:08,198 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/279286466/match-history?only_stored_history=true
2025-05-08 22:34:08,199 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:08,733 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/279286466/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:08,758 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:08,759 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       279286466
1       279286466
2       279286466
3       279286466
4       279286466
          ...    
2037    279286466
2038    279286466
2039    279286466
2040    279286466
2041    279286466
Name: account_id, Length: 2042, dtype: int64
2025-05-08 22:34:08,760 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12312
2025-05-08 22:34:08,760 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8896
2025-05-08 22:34:08,760 [DEBUG] [root.generate_player_performance_metrics] match_total: 2042
2025-05-08 22:34:08,761 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       279286466
1       279286466
2       279286466
3       279286466
4       279286466
          ...    
2037    279286466
2038    279286466
2039    279286466
2040    279286466
2041    279286466
Name: account_id, Length: 2042, dtype: int64
2025-05-08 22:34:08,761 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:08,766 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:08,767 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:08,767 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:08,767 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:08,767 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:08,777 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 153-152
2025-05-08 22:34:08,777 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:08,779 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 279286466
2025-05-08 22:34:08,779 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:08,779 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:08,796 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 141232-139190
2025-05-08 22:34:08,796 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=154, account_id=83326473) of 250
2025-05-08 22:34:08,796 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/83326473/match-history?only_stored_history=true
2025-05-08 22:34:08,796 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:09,045 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/83326473/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:09,079 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:09,079 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       83326473
1       83326473
2       83326473
3       83326473
4       83326473
          ...   
1090    83326473
1091    83326473
1092    83326473
1093    83326473
1094    83326473
Name: account_id, Length: 1095, dtype: int64
2025-05-08 22:34:09,080 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6581
2025-05-08 22:34:09,080 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5742
2025-05-08 22:34:09,080 [DEBUG] [root.generate_player_performance_metrics] match_total: 1095
2025-05-08 22:34:09,080 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       83326473
1       83326473
2       83326473
3       83326473
4       83326473
          ...   
1090    83326473
1091    83326473
1092    83326473
1093    83326473
1094    83326473
Name: account_id, Length: 1095, dtype: int64
2025-05-08 22:34:09,080 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:09,085 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:09,086 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:09,086 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:09,086 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:09,086 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:09,095 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 154-153
2025-05-08 22:34:09,095 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:09,097 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 83326473
2025-05-08 22:34:09,097 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:09,097 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:09,107 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 142327-141232
2025-05-08 22:34:09,107 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=155, account_id=127909624) of 250
2025-05-08 22:34:09,107 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/127909624/match-history?only_stored_history=true
2025-05-08 22:34:09,107 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:09,565 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/127909624/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:09,569 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:09,570 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      127909624
1      127909624
2      127909624
3      127909624
4      127909624
         ...    
774    127909624
775    127909624
776    127909624
777    127909624
778    127909624
Name: account_id, Length: 779, dtype: int64
2025-05-08 22:34:09,570 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8564
2025-05-08 22:34:09,570 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5106
2025-05-08 22:34:09,570 [DEBUG] [root.generate_player_performance_metrics] match_total: 779
2025-05-08 22:34:09,571 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      127909624
1      127909624
2      127909624
3      127909624
4      127909624
         ...    
774    127909624
775    127909624
776    127909624
777    127909624
778    127909624
Name: account_id, Length: 779, dtype: int64
2025-05-08 22:34:09,571 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:09,575 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:09,577 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:09,577 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:09,577 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:09,577 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:09,584 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 155-154
2025-05-08 22:34:09,584 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:09,586 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 127909624
2025-05-08 22:34:09,587 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:09,587 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:09,594 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 143106-142327
2025-05-08 22:34:09,594 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=156, account_id=120420364) of 250
2025-05-08 22:34:09,594 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/120420364/match-history?only_stored_history=true
2025-05-08 22:34:09,595 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:10,067 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/120420364/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:10,071 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:10,072 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      120420364
1      120420364
2      120420364
3      120420364
4      120420364
         ...    
717    120420364
718    120420364
719    120420364
720    120420364
721    120420364
Name: account_id, Length: 722, dtype: int64
2025-05-08 22:34:10,072 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4990
2025-05-08 22:34:10,072 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4277
2025-05-08 22:34:10,072 [DEBUG] [root.generate_player_performance_metrics] match_total: 722
2025-05-08 22:34:10,073 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      120420364
1      120420364
2      120420364
3      120420364
4      120420364
         ...    
717    120420364
718    120420364
719    120420364
720    120420364
721    120420364
Name: account_id, Length: 722, dtype: int64
2025-05-08 22:34:10,073 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:10,078 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:10,080 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:10,080 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:10,080 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:10,080 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:10,087 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 156-155
2025-05-08 22:34:10,087 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:10,089 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 120420364
2025-05-08 22:34:10,089 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:10,089 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:10,097 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 143828-143106
2025-05-08 22:34:10,097 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=157, account_id=55297093) of 250
2025-05-08 22:34:10,097 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/55297093/match-history?only_stored_history=true
2025-05-08 22:34:10,098 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:10,311 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/55297093/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:10,405 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:10,405 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       55297093
1       55297093
2       55297093
3       55297093
4       55297093
          ...   
1410    55297093
1411    55297093
1412    55297093
1413    55297093
1414    55297093
Name: account_id, Length: 1415, dtype: int64
2025-05-08 22:34:10,406 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11265
2025-05-08 22:34:10,406 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9792
2025-05-08 22:34:10,406 [DEBUG] [root.generate_player_performance_metrics] match_total: 1415
2025-05-08 22:34:10,407 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       55297093
1       55297093
2       55297093
3       55297093
4       55297093
          ...   
1410    55297093
1411    55297093
1412    55297093
1413    55297093
1414    55297093
Name: account_id, Length: 1415, dtype: int64
2025-05-08 22:34:10,407 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:10,411 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:10,412 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:10,413 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:10,413 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:10,413 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:10,421 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 157-156
2025-05-08 22:34:10,421 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:10,423 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 55297093
2025-05-08 22:34:10,423 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:10,423 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:10,435 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 145243-143828
2025-05-08 22:34:10,435 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=158, account_id=1082013164) of 250
2025-05-08 22:34:10,435 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1082013164/match-history?only_stored_history=true
2025-05-08 22:34:10,436 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:10,899 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1082013164/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:10,905 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:10,905 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1082013164
1      1082013164
2      1082013164
3      1082013164
4      1082013164
          ...    
791    1082013164
792    1082013164
793    1082013164
794    1082013164
795    1082013164
Name: account_id, Length: 796, dtype: int64
2025-05-08 22:34:10,906 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5996
2025-05-08 22:34:10,906 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4733
2025-05-08 22:34:10,906 [DEBUG] [root.generate_player_performance_metrics] match_total: 796
2025-05-08 22:34:10,907 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1082013164
1      1082013164
2      1082013164
3      1082013164
4      1082013164
          ...    
791    1082013164
792    1082013164
793    1082013164
794    1082013164
795    1082013164
Name: account_id, Length: 796, dtype: int64
2025-05-08 22:34:10,907 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:10,911 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:10,912 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:10,913 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:10,913 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:10,913 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:10,921 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 158-157
2025-05-08 22:34:10,921 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:10,923 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1082013164
2025-05-08 22:34:10,923 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:10,923 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:10,931 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 146039-145243
2025-05-08 22:34:10,931 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=159, account_id=1832739926) of 250
2025-05-08 22:34:10,931 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1832739926/match-history?only_stored_history=true
2025-05-08 22:34:10,931 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:11,367 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1832739926/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:11,368 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:11,369 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1832739926
1     1832739926
2     1832739926
3     1832739926
4     1832739926
         ...    
94    1832739926
95    1832739926
96    1832739926
97    1832739926
98    1832739926
Name: account_id, Length: 99, dtype: int64
2025-05-08 22:34:11,369 [DEBUG] [root.generate_player_performance_metrics] total_kills: 933
2025-05-08 22:34:11,369 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 477
2025-05-08 22:34:11,369 [DEBUG] [root.generate_player_performance_metrics] match_total: 99
2025-05-08 22:34:11,370 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1832739926
1     1832739926
2     1832739926
3     1832739926
4     1832739926
         ...    
94    1832739926
95    1832739926
96    1832739926
97    1832739926
98    1832739926
Name: account_id, Length: 99, dtype: int64
2025-05-08 22:34:11,370 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:11,374 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:11,375 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:11,375 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:11,375 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:11,376 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:11,381 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 159-158
2025-05-08 22:34:11,381 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:11,383 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1832739926
2025-05-08 22:34:11,384 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:11,384 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:11,389 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 146138-146039
2025-05-08 22:34:11,389 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 74.54seconds. Processed 160 of 250 players
2025-05-08 22:34:11,389 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=160, account_id=31434895) of 250
2025-05-08 22:34:11,389 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/31434895/match-history?only_stored_history=true
2025-05-08 22:34:11,391 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:11,992 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/31434895/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:12,017 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:12,018 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       31434895
1       31434895
2       31434895
3       31434895
4       31434895
          ...   
1836    31434895
1837    31434895
1838    31434895
1839    31434895
1840    31434895
Name: account_id, Length: 1841, dtype: int64
2025-05-08 22:34:12,018 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13273
2025-05-08 22:34:12,018 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8101
2025-05-08 22:34:12,018 [DEBUG] [root.generate_player_performance_metrics] match_total: 1841
2025-05-08 22:34:12,019 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       31434895
1       31434895
2       31434895
3       31434895
4       31434895
          ...   
1836    31434895
1837    31434895
1838    31434895
1839    31434895
1840    31434895
Name: account_id, Length: 1841, dtype: int64
2025-05-08 22:34:12,019 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:12,024 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:12,025 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:12,025 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:12,025 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:12,025 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:12,033 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 160-159
2025-05-08 22:34:12,033 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:12,035 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 31434895
2025-05-08 22:34:12,035 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:12,035 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:12,051 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 147979-146138
2025-05-08 22:34:12,051 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=161, account_id=44966879) of 250
2025-05-08 22:34:12,051 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/44966879/match-history?only_stored_history=true
2025-05-08 22:34:12,052 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:12,573 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/44966879/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:12,740 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:12,742 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       44966879
1       44966879
2       44966879
3       44966879
4       44966879
          ...   
3441    44966879
3442    44966879
3443    44966879
3444    44966879
3445    44966879
Name: account_id, Length: 3446, dtype: int64
2025-05-08 22:34:12,742 [DEBUG] [root.generate_player_performance_metrics] total_kills: 21588
2025-05-08 22:34:12,742 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 25188
2025-05-08 22:34:12,742 [DEBUG] [root.generate_player_performance_metrics] match_total: 3446
2025-05-08 22:34:12,743 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       44966879
1       44966879
2       44966879
3       44966879
4       44966879
          ...   
3441    44966879
3442    44966879
3443    44966879
3444    44966879
3445    44966879
Name: account_id, Length: 3446, dtype: int64
2025-05-08 22:34:12,743 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:12,748 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:12,750 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:12,750 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:12,750 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:12,750 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:12,761 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 161-160
2025-05-08 22:34:12,761 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:12,764 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 44966879
2025-05-08 22:34:12,764 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:12,764 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:12,786 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 151425-147979
2025-05-08 22:34:12,787 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=162, account_id=43678288) of 250
2025-05-08 22:34:12,787 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/43678288/match-history?only_stored_history=true
2025-05-08 22:34:12,787 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:13,273 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/43678288/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:13,280 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:13,280 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      43678288
1      43678288
2      43678288
3      43678288
4      43678288
         ...   
660    43678288
661    43678288
662    43678288
663    43678288
664    43678288
Name: account_id, Length: 665, dtype: int64
2025-05-08 22:34:13,281 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5928
2025-05-08 22:34:13,281 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4231
2025-05-08 22:34:13,281 [DEBUG] [root.generate_player_performance_metrics] match_total: 665
2025-05-08 22:34:13,282 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      43678288
1      43678288
2      43678288
3      43678288
4      43678288
         ...   
660    43678288
661    43678288
662    43678288
663    43678288
664    43678288
Name: account_id, Length: 665, dtype: int64
2025-05-08 22:34:13,282 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:13,288 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:13,289 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:13,289 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:13,289 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:13,289 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:13,298 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 162-161
2025-05-08 22:34:13,298 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:13,301 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 43678288
2025-05-08 22:34:13,302 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:13,302 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:13,310 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 152090-151425
2025-05-08 22:34:13,310 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=163, account_id=1672787369) of 250
2025-05-08 22:34:13,310 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1672787369/match-history?only_stored_history=true
2025-05-08 22:34:13,310 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:13,551 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1672787369/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:13,553 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:13,554 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1672787369
1     1672787369
2     1672787369
3     1672787369
4     1672787369
         ...    
72    1672787369
73    1672787369
74    1672787369
75    1672787369
76    1672787369
Name: account_id, Length: 77, dtype: int64
2025-05-08 22:34:13,554 [DEBUG] [root.generate_player_performance_metrics] total_kills: 714
2025-05-08 22:34:13,554 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 447
2025-05-08 22:34:13,554 [DEBUG] [root.generate_player_performance_metrics] match_total: 77
2025-05-08 22:34:13,555 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1672787369
1     1672787369
2     1672787369
3     1672787369
4     1672787369
         ...    
72    1672787369
73    1672787369
74    1672787369
75    1672787369
76    1672787369
Name: account_id, Length: 77, dtype: int64
2025-05-08 22:34:13,555 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:13,559 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:13,560 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:13,560 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:13,561 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:13,561 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:13,568 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 163-162
2025-05-08 22:34:13,568 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:13,570 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1672787369
2025-05-08 22:34:13,570 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:13,570 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:13,576 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 152167-152090
2025-05-08 22:34:13,576 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=164, account_id=864364265) of 250
2025-05-08 22:34:13,576 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/864364265/match-history?only_stored_history=true
2025-05-08 22:34:13,576 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:13,906 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/864364265/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:13,926 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:13,927 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       864364265
1       864364265
2       864364265
3       864364265
4       864364265
          ...    
2026    864364265
2027    864364265
2028    864364265
2029    864364265
2030    864364265
Name: account_id, Length: 2031, dtype: int64
2025-05-08 22:34:13,927 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13875
2025-05-08 22:34:13,927 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 13005
2025-05-08 22:34:13,927 [DEBUG] [root.generate_player_performance_metrics] match_total: 2031
2025-05-08 22:34:13,928 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       864364265
1       864364265
2       864364265
3       864364265
4       864364265
          ...    
2026    864364265
2027    864364265
2028    864364265
2029    864364265
2030    864364265
Name: account_id, Length: 2031, dtype: int64
2025-05-08 22:34:13,928 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:13,933 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:13,935 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:13,935 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:13,935 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:13,935 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:13,946 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 164-163
2025-05-08 22:34:13,946 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:13,949 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 864364265
2025-05-08 22:34:13,949 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:13,949 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:13,973 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 154198-152167
2025-05-08 22:34:13,974 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=165, account_id=195918672) of 250
2025-05-08 22:34:13,974 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/195918672/match-history?only_stored_history=true
2025-05-08 22:34:13,974 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:14,282 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/195918672/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:14,300 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:14,301 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       195918672
1       195918672
2       195918672
3       195918672
4       195918672
          ...    
1555    195918672
1556    195918672
1557    195918672
1558    195918672
1559    195918672
Name: account_id, Length: 1560, dtype: int64
2025-05-08 22:34:14,301 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10106
2025-05-08 22:34:14,301 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9259
2025-05-08 22:34:14,301 [DEBUG] [root.generate_player_performance_metrics] match_total: 1560
2025-05-08 22:34:14,302 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       195918672
1       195918672
2       195918672
3       195918672
4       195918672
          ...    
1555    195918672
1556    195918672
1557    195918672
1558    195918672
1559    195918672
Name: account_id, Length: 1560, dtype: int64
2025-05-08 22:34:14,302 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:14,307 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:14,308 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:14,308 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:14,308 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:14,308 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:14,318 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 165-164
2025-05-08 22:34:14,318 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:14,319 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 195918672
2025-05-08 22:34:14,320 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:14,320 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:14,333 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 155758-154198
2025-05-08 22:34:14,333 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=166, account_id=410560515) of 250
2025-05-08 22:34:14,333 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/410560515/match-history?only_stored_history=true
2025-05-08 22:34:14,334 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:14,587 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/410560515/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:14,588 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:14,589 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     410560515
1     410560515
2     410560515
3     410560515
4     410560515
        ...    
59    410560515
60    410560515
61    410560515
62    410560515
63    410560515
Name: account_id, Length: 64, dtype: int64
2025-05-08 22:34:14,589 [DEBUG] [root.generate_player_performance_metrics] total_kills: 796
2025-05-08 22:34:14,589 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 354
2025-05-08 22:34:14,589 [DEBUG] [root.generate_player_performance_metrics] match_total: 64
2025-05-08 22:34:14,590 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     410560515
1     410560515
2     410560515
3     410560515
4     410560515
        ...    
59    410560515
60    410560515
61    410560515
62    410560515
63    410560515
Name: account_id, Length: 64, dtype: int64
2025-05-08 22:34:14,590 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:14,595 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:14,596 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:14,597 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:14,597 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:14,597 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:14,606 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 166-165
2025-05-08 22:34:14,606 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:14,608 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 410560515
2025-05-08 22:34:14,608 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:14,608 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:14,614 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 155822-155758
2025-05-08 22:34:14,614 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=167, account_id=914798612) of 250
2025-05-08 22:34:14,614 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/914798612/match-history?only_stored_history=true
2025-05-08 22:34:14,614 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:14,910 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/914798612/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:14,925 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:14,926 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      914798612
1      914798612
2      914798612
3      914798612
4      914798612
         ...    
651    914798612
652    914798612
653    914798612
654    914798612
655    914798612
Name: account_id, Length: 656, dtype: int64
2025-05-08 22:34:14,926 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4490
2025-05-08 22:34:14,926 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3679
2025-05-08 22:34:14,926 [DEBUG] [root.generate_player_performance_metrics] match_total: 656
2025-05-08 22:34:14,927 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      914798612
1      914798612
2      914798612
3      914798612
4      914798612
         ...    
651    914798612
652    914798612
653    914798612
654    914798612
655    914798612
Name: account_id, Length: 656, dtype: int64
2025-05-08 22:34:14,927 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:14,932 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:14,933 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:14,933 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:14,933 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:14,934 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:14,942 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 167-166
2025-05-08 22:34:14,942 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:14,944 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 914798612
2025-05-08 22:34:14,944 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:14,944 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:14,952 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 156478-155822
2025-05-08 22:34:14,952 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=168, account_id=1107839157) of 250
2025-05-08 22:34:14,952 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1107839157/match-history?only_stored_history=true
2025-05-08 22:34:14,953 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:15,248 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1107839157/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:15,253 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:15,253 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1107839157
1      1107839157
2      1107839157
3      1107839157
4      1107839157
          ...    
436    1107839157
437    1107839157
438    1107839157
439    1107839157
440    1107839157
Name: account_id, Length: 441, dtype: int64
2025-05-08 22:34:15,254 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3663
2025-05-08 22:34:15,254 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2490
2025-05-08 22:34:15,254 [DEBUG] [root.generate_player_performance_metrics] match_total: 441
2025-05-08 22:34:15,255 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1107839157
1      1107839157
2      1107839157
3      1107839157
4      1107839157
          ...    
436    1107839157
437    1107839157
438    1107839157
439    1107839157
440    1107839157
Name: account_id, Length: 441, dtype: int64
2025-05-08 22:34:15,255 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:15,260 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:15,261 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:15,261 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:15,261 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:15,261 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:15,268 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 168-167
2025-05-08 22:34:15,268 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:15,271 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1107839157
2025-05-08 22:34:15,272 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:15,272 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:15,279 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 156919-156478
2025-05-08 22:34:15,279 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=169, account_id=43197893) of 250
2025-05-08 22:34:15,279 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/43197893/match-history?only_stored_history=true
2025-05-08 22:34:15,279 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:15,792 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/43197893/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:15,882 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:15,882 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       43197893
1       43197893
2       43197893
3       43197893
4       43197893
          ...   
1063    43197893
1064    43197893
1065    43197893
1066    43197893
1067    43197893
Name: account_id, Length: 1068, dtype: int64
2025-05-08 22:34:15,883 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8189
2025-05-08 22:34:15,883 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5938
2025-05-08 22:34:15,883 [DEBUG] [root.generate_player_performance_metrics] match_total: 1068
2025-05-08 22:34:15,884 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       43197893
1       43197893
2       43197893
3       43197893
4       43197893
          ...   
1063    43197893
1064    43197893
1065    43197893
1066    43197893
1067    43197893
Name: account_id, Length: 1068, dtype: int64
2025-05-08 22:34:15,884 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:15,888 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:15,890 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:15,890 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:15,890 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:15,890 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:15,898 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 169-168
2025-05-08 22:34:15,898 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:15,900 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 43197893
2025-05-08 22:34:15,900 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:15,900 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:15,910 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 157987-156919
2025-05-08 22:34:15,910 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 79.06seconds. Processed 170 of 250 players
2025-05-08 22:34:15,910 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=170, account_id=185368295) of 250
2025-05-08 22:34:15,910 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/185368295/match-history?only_stored_history=true
2025-05-08 22:34:15,911 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:16,408 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/185368295/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:16,419 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:16,419 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      185368295
1      185368295
2      185368295
3      185368295
4      185368295
         ...    
980    185368295
981    185368295
982    185368295
983    185368295
984    185368295
Name: account_id, Length: 985, dtype: int64
2025-05-08 22:34:16,420 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7031
2025-05-08 22:34:16,420 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4578
2025-05-08 22:34:16,420 [DEBUG] [root.generate_player_performance_metrics] match_total: 985
2025-05-08 22:34:16,420 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      185368295
1      185368295
2      185368295
3      185368295
4      185368295
         ...    
980    185368295
981    185368295
982    185368295
983    185368295
984    185368295
Name: account_id, Length: 985, dtype: int64
2025-05-08 22:34:16,420 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:16,425 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:16,426 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:16,426 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:16,426 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:16,426 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:16,435 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 170-169
2025-05-08 22:34:16,435 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:16,437 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 185368295
2025-05-08 22:34:16,437 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:16,437 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:16,447 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 158972-157987
2025-05-08 22:34:16,447 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=171, account_id=1052794264) of 250
2025-05-08 22:34:16,447 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1052794264/match-history?only_stored_history=true
2025-05-08 22:34:16,447 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:16,651 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1052794264/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:16,661 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:16,662 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1052794264
1       1052794264
2       1052794264
3       1052794264
4       1052794264
           ...    
1005    1052794264
1006    1052794264
1007    1052794264
1008    1052794264
1009    1052794264
Name: account_id, Length: 1010, dtype: int64
2025-05-08 22:34:16,662 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6487
2025-05-08 22:34:16,662 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6130
2025-05-08 22:34:16,662 [DEBUG] [root.generate_player_performance_metrics] match_total: 1010
2025-05-08 22:34:16,663 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1052794264
1       1052794264
2       1052794264
3       1052794264
4       1052794264
           ...    
1005    1052794264
1006    1052794264
1007    1052794264
1008    1052794264
1009    1052794264
Name: account_id, Length: 1010, dtype: int64
2025-05-08 22:34:16,663 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:16,668 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:16,670 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:16,670 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:16,670 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:16,670 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:16,678 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 171-170
2025-05-08 22:34:16,678 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:16,680 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1052794264
2025-05-08 22:34:16,680 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:16,680 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:16,688 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 159982-158972
2025-05-08 22:34:16,688 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=172, account_id=51854168) of 250
2025-05-08 22:34:16,688 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/51854168/match-history?only_stored_history=true
2025-05-08 22:34:16,690 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:17,137 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/51854168/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:17,152 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:17,153 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      51854168
1      51854168
2      51854168
3      51854168
4      51854168
         ...   
600    51854168
601    51854168
602    51854168
603    51854168
604    51854168
Name: account_id, Length: 605, dtype: int64
2025-05-08 22:34:17,153 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5658
2025-05-08 22:34:17,153 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3090
2025-05-08 22:34:17,153 [DEBUG] [root.generate_player_performance_metrics] match_total: 605
2025-05-08 22:34:17,154 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      51854168
1      51854168
2      51854168
3      51854168
4      51854168
         ...   
600    51854168
601    51854168
602    51854168
603    51854168
604    51854168
Name: account_id, Length: 605, dtype: int64
2025-05-08 22:34:17,154 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:17,158 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:17,160 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:17,160 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:17,161 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:17,161 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:17,168 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 172-171
2025-05-08 22:34:17,168 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:17,170 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 51854168
2025-05-08 22:34:17,171 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:17,171 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:17,178 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 160587-159982
2025-05-08 22:34:17,178 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=173, account_id=84127537) of 250
2025-05-08 22:34:17,178 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/84127537/match-history?only_stored_history=true
2025-05-08 22:34:17,179 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:17,446 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/84127537/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:17,452 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:17,453 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       84127537
1       84127537
2       84127537
3       84127537
4       84127537
          ...   
1005    84127537
1006    84127537
1007    84127537
1008    84127537
1009    84127537
Name: account_id, Length: 1010, dtype: int64
2025-05-08 22:34:17,453 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6349
2025-05-08 22:34:17,453 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9863
2025-05-08 22:34:17,453 [DEBUG] [root.generate_player_performance_metrics] match_total: 1010
2025-05-08 22:34:17,454 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       84127537
1       84127537
2       84127537
3       84127537
4       84127537
          ...   
1005    84127537
1006    84127537
1007    84127537
1008    84127537
1009    84127537
Name: account_id, Length: 1010, dtype: int64
2025-05-08 22:34:17,454 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:17,458 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:17,460 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:17,461 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:17,461 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:17,461 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:17,467 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 173-172
2025-05-08 22:34:17,468 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:17,470 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 84127537
2025-05-08 22:34:17,470 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:17,470 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:17,478 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 161597-160587
2025-05-08 22:34:17,478 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=174, account_id=1837860425) of 250
2025-05-08 22:34:17,478 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1837860425/match-history?only_stored_history=true
2025-05-08 22:34:17,480 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:17,743 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1837860425/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:17,753 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:17,754 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1837860425
1      1837860425
2      1837860425
3      1837860425
4      1837860425
          ...    
345    1837860425
346    1837860425
347    1837860425
348    1837860425
349    1837860425
Name: account_id, Length: 350, dtype: int64
2025-05-08 22:34:17,754 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3768
2025-05-08 22:34:17,754 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2415
2025-05-08 22:34:17,754 [DEBUG] [root.generate_player_performance_metrics] match_total: 350
2025-05-08 22:34:17,755 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1837860425
1      1837860425
2      1837860425
3      1837860425
4      1837860425
          ...    
345    1837860425
346    1837860425
347    1837860425
348    1837860425
349    1837860425
Name: account_id, Length: 350, dtype: int64
2025-05-08 22:34:17,755 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:17,760 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:17,760 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:17,760 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:17,761 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:17,761 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:17,767 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 174-173
2025-05-08 22:34:17,768 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:17,770 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1837860425
2025-05-08 22:34:17,770 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:17,771 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:17,777 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 161947-161597
2025-05-08 22:34:17,777 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=175, account_id=52983576) of 250
2025-05-08 22:34:17,777 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/52983576/match-history?only_stored_history=true
2025-05-08 22:34:17,777 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:18,034 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/52983576/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:18,053 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:18,054 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       52983576
1       52983576
2       52983576
3       52983576
4       52983576
          ...   
1484    52983576
1485    52983576
1486    52983576
1487    52983576
1488    52983576
Name: account_id, Length: 1489, dtype: int64
2025-05-08 22:34:18,055 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10467
2025-05-08 22:34:18,055 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7651
2025-05-08 22:34:18,055 [DEBUG] [root.generate_player_performance_metrics] match_total: 1489
2025-05-08 22:34:18,056 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       52983576
1       52983576
2       52983576
3       52983576
4       52983576
          ...   
1484    52983576
1485    52983576
1486    52983576
1487    52983576
1488    52983576
Name: account_id, Length: 1489, dtype: int64
2025-05-08 22:34:18,056 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:18,060 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:18,061 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:18,062 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:18,062 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:18,062 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:18,072 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 175-174
2025-05-08 22:34:18,072 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:18,075 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 52983576
2025-05-08 22:34:18,075 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:18,075 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:18,087 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 163436-161947
2025-05-08 22:34:18,087 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=176, account_id=222709733) of 250
2025-05-08 22:34:18,087 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/222709733/match-history?only_stored_history=true
2025-05-08 22:34:18,087 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:18,345 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/222709733/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:18,350 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:18,351 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      222709733
1      222709733
2      222709733
3      222709733
4      222709733
         ...    
571    222709733
572    222709733
573    222709733
574    222709733
575    222709733
Name: account_id, Length: 576, dtype: int64
2025-05-08 22:34:18,351 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5766
2025-05-08 22:34:18,351 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2862
2025-05-08 22:34:18,351 [DEBUG] [root.generate_player_performance_metrics] match_total: 576
2025-05-08 22:34:18,352 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      222709733
1      222709733
2      222709733
3      222709733
4      222709733
         ...    
571    222709733
572    222709733
573    222709733
574    222709733
575    222709733
Name: account_id, Length: 576, dtype: int64
2025-05-08 22:34:18,352 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:18,357 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:18,358 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:18,358 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:18,358 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:18,358 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:18,364 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 176-175
2025-05-08 22:34:18,364 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:18,366 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 222709733
2025-05-08 22:34:18,367 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:18,367 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:18,374 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 164012-163436
2025-05-08 22:34:18,374 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=177, account_id=244471627) of 250
2025-05-08 22:34:18,375 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/244471627/match-history?only_stored_history=true
2025-05-08 22:34:18,375 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:18,910 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/244471627/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:18,936 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:18,936 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       244471627
1       244471627
2       244471627
3       244471627
4       244471627
          ...    
1949    244471627
1950    244471627
1951    244471627
1952    244471627
1953    244471627
Name: account_id, Length: 1954, dtype: int64
2025-05-08 22:34:18,936 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14043
2025-05-08 22:34:18,936 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 12443
2025-05-08 22:34:18,936 [DEBUG] [root.generate_player_performance_metrics] match_total: 1954
2025-05-08 22:34:18,937 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       244471627
1       244471627
2       244471627
3       244471627
4       244471627
          ...    
1949    244471627
1950    244471627
1951    244471627
1952    244471627
1953    244471627
Name: account_id, Length: 1954, dtype: int64
2025-05-08 22:34:18,937 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:18,942 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:18,944 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:18,944 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:18,944 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:18,944 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:18,953 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 177-176
2025-05-08 22:34:18,954 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:18,956 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 244471627
2025-05-08 22:34:18,956 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:18,956 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:18,972 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 165966-164012
2025-05-08 22:34:18,972 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=178, account_id=924812291) of 250
2025-05-08 22:34:18,972 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/924812291/match-history?only_stored_history=true
2025-05-08 22:34:18,972 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:19,218 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/924812291/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:19,253 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:19,253 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       924812291
1       924812291
2       924812291
3       924812291
4       924812291
          ...    
1172    924812291
1173    924812291
1174    924812291
1175    924812291
1176    924812291
Name: account_id, Length: 1177, dtype: int64
2025-05-08 22:34:19,254 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11226
2025-05-08 22:34:19,254 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7015
2025-05-08 22:34:19,254 [DEBUG] [root.generate_player_performance_metrics] match_total: 1177
2025-05-08 22:34:19,254 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       924812291
1       924812291
2       924812291
3       924812291
4       924812291
          ...    
1172    924812291
1173    924812291
1174    924812291
1175    924812291
1176    924812291
Name: account_id, Length: 1177, dtype: int64
2025-05-08 22:34:19,255 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:19,260 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:19,261 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:19,261 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:19,261 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:19,261 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:19,270 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 178-177
2025-05-08 22:34:19,270 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:19,273 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 924812291
2025-05-08 22:34:19,273 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:19,273 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:19,284 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 167143-165966
2025-05-08 22:34:19,284 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=179, account_id=1117459701) of 250
2025-05-08 22:34:19,284 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1117459701/match-history?only_stored_history=true
2025-05-08 22:34:19,284 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:19,771 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1117459701/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:19,896 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:19,897 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1117459701
1       1117459701
2       1117459701
3       1117459701
4       1117459701
           ...    
2219    1117459701
2220    1117459701
2221    1117459701
2222    1117459701
2223    1117459701
Name: account_id, Length: 2224, dtype: int64
2025-05-08 22:34:19,897 [DEBUG] [root.generate_player_performance_metrics] total_kills: 15075
2025-05-08 22:34:19,897 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11063
2025-05-08 22:34:19,897 [DEBUG] [root.generate_player_performance_metrics] match_total: 2224
2025-05-08 22:34:19,898 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1117459701
1       1117459701
2       1117459701
3       1117459701
4       1117459701
           ...    
2219    1117459701
2220    1117459701
2221    1117459701
2222    1117459701
2223    1117459701
Name: account_id, Length: 2224, dtype: int64
2025-05-08 22:34:19,898 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:19,903 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:19,905 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:19,905 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:19,905 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:19,905 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:19,915 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 179-178
2025-05-08 22:34:19,915 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:19,917 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1117459701
2025-05-08 22:34:19,918 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:19,918 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:19,936 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 169367-167143
2025-05-08 22:34:19,937 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 83.09seconds. Processed 180 of 250 players
2025-05-08 22:34:19,937 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=180, account_id=104826682) of 250
2025-05-08 22:34:19,937 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/104826682/match-history?only_stored_history=true
2025-05-08 22:34:19,937 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:20,386 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/104826682/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:20,389 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:20,390 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      104826682
1      104826682
2      104826682
3      104826682
4      104826682
         ...    
535    104826682
536    104826682
537    104826682
538    104826682
539    104826682
Name: account_id, Length: 540, dtype: int64
2025-05-08 22:34:20,390 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3393
2025-05-08 22:34:20,390 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2540
2025-05-08 22:34:20,390 [DEBUG] [root.generate_player_performance_metrics] match_total: 540
2025-05-08 22:34:20,391 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      104826682
1      104826682
2      104826682
3      104826682
4      104826682
         ...    
535    104826682
536    104826682
537    104826682
538    104826682
539    104826682
Name: account_id, Length: 540, dtype: int64
2025-05-08 22:34:20,391 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:20,396 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:20,398 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:20,398 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:20,398 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:20,398 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:20,405 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 180-179
2025-05-08 22:34:20,405 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:20,407 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 104826682
2025-05-08 22:34:20,407 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:20,408 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:20,415 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 169907-169367
2025-05-08 22:34:20,415 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=181, account_id=273428056) of 250
2025-05-08 22:34:20,415 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/273428056/match-history?only_stored_history=true
2025-05-08 22:34:20,415 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:20,704 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/273428056/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:20,719 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:20,720 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       273428056
1       273428056
2       273428056
3       273428056
4       273428056
          ...    
1067    273428056
1068    273428056
1069    273428056
1070    273428056
1071    273428056
Name: account_id, Length: 1072, dtype: int64
2025-05-08 22:34:20,720 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7775
2025-05-08 22:34:20,720 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8327
2025-05-08 22:34:20,720 [DEBUG] [root.generate_player_performance_metrics] match_total: 1072
2025-05-08 22:34:20,721 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       273428056
1       273428056
2       273428056
3       273428056
4       273428056
          ...    
1067    273428056
1068    273428056
1069    273428056
1070    273428056
1071    273428056
Name: account_id, Length: 1072, dtype: int64
2025-05-08 22:34:20,721 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:20,726 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:20,727 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:20,727 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:20,727 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:20,727 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:20,736 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 181-180
2025-05-08 22:34:20,736 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:20,738 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 273428056
2025-05-08 22:34:20,738 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:20,738 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:20,747 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 170979-169907
2025-05-08 22:34:20,747 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=182, account_id=44122052) of 250
2025-05-08 22:34:20,747 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/44122052/match-history?only_stored_history=true
2025-05-08 22:34:20,748 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:21,187 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/44122052/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:21,210 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:21,211 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      44122052
1      44122052
2      44122052
3      44122052
4      44122052
         ...   
882    44122052
883    44122052
884    44122052
885    44122052
886    44122052
Name: account_id, Length: 887, dtype: int64
2025-05-08 22:34:21,211 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6681
2025-05-08 22:34:21,211 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4281
2025-05-08 22:34:21,211 [DEBUG] [root.generate_player_performance_metrics] match_total: 887
2025-05-08 22:34:21,212 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      44122052
1      44122052
2      44122052
3      44122052
4      44122052
         ...   
882    44122052
883    44122052
884    44122052
885    44122052
886    44122052
Name: account_id, Length: 887, dtype: int64
2025-05-08 22:34:21,212 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:21,217 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:21,218 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:21,218 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:21,218 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:21,218 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:21,225 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 182-181
2025-05-08 22:34:21,226 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:21,228 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 44122052
2025-05-08 22:34:21,228 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:21,228 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:21,237 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 171866-170979
2025-05-08 22:34:21,237 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=183, account_id=477467839) of 250
2025-05-08 22:34:21,237 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/477467839/match-history?only_stored_history=true
2025-05-08 22:34:21,238 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:21,500 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/477467839/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:21,513 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:21,514 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       477467839
1       477467839
2       477467839
3       477467839
4       477467839
          ...    
1065    477467839
1066    477467839
1067    477467839
1068    477467839
1069    477467839
Name: account_id, Length: 1070, dtype: int64
2025-05-08 22:34:21,514 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7447
2025-05-08 22:34:21,514 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5717
2025-05-08 22:34:21,514 [DEBUG] [root.generate_player_performance_metrics] match_total: 1070
2025-05-08 22:34:21,515 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       477467839
1       477467839
2       477467839
3       477467839
4       477467839
          ...    
1065    477467839
1066    477467839
1067    477467839
1068    477467839
1069    477467839
Name: account_id, Length: 1070, dtype: int64
2025-05-08 22:34:21,515 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:21,521 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:21,522 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:21,522 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:21,522 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:21,522 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:21,530 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 183-182
2025-05-08 22:34:21,530 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:21,533 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 477467839
2025-05-08 22:34:21,533 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:21,533 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:21,542 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 172936-171866
2025-05-08 22:34:21,542 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=184, account_id=1834107935) of 250
2025-05-08 22:34:21,542 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1834107935/match-history?only_stored_history=true
2025-05-08 22:34:21,542 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:22,000 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1834107935/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:22,003 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:22,004 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1834107935
1      1834107935
2      1834107935
3      1834107935
4      1834107935
          ...    
498    1834107935
499    1834107935
500    1834107935
501    1834107935
502    1834107935
Name: account_id, Length: 503, dtype: int64
2025-05-08 22:34:22,004 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4104
2025-05-08 22:34:22,004 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3239
2025-05-08 22:34:22,004 [DEBUG] [root.generate_player_performance_metrics] match_total: 503
2025-05-08 22:34:22,005 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1834107935
1      1834107935
2      1834107935
3      1834107935
4      1834107935
          ...    
498    1834107935
499    1834107935
500    1834107935
501    1834107935
502    1834107935
Name: account_id, Length: 503, dtype: int64
2025-05-08 22:34:22,005 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:22,010 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:22,012 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:22,012 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:22,012 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:22,012 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:22,020 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 184-183
2025-05-08 22:34:22,020 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:22,022 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1834107935
2025-05-08 22:34:22,022 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:22,022 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:22,029 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 173439-172936
2025-05-08 22:34:22,029 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=185, account_id=135620244) of 250
2025-05-08 22:34:22,029 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/135620244/match-history?only_stored_history=true
2025-05-08 22:34:22,030 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:22,459 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/135620244/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:22,532 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:22,533 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       135620244
1       135620244
2       135620244
3       135620244
4       135620244
          ...    
1164    135620244
1165    135620244
1166    135620244
1167    135620244
1168    135620244
Name: account_id, Length: 1169, dtype: int64
2025-05-08 22:34:22,533 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11193
2025-05-08 22:34:22,533 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6556
2025-05-08 22:34:22,533 [DEBUG] [root.generate_player_performance_metrics] match_total: 1169
2025-05-08 22:34:22,534 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       135620244
1       135620244
2       135620244
3       135620244
4       135620244
          ...    
1164    135620244
1165    135620244
1166    135620244
1167    135620244
1168    135620244
Name: account_id, Length: 1169, dtype: int64
2025-05-08 22:34:22,534 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:22,539 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:22,540 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:22,540 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:22,540 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:22,540 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:22,548 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 185-184
2025-05-08 22:34:22,548 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:22,551 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 135620244
2025-05-08 22:34:22,551 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:22,551 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:22,561 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 174608-173439
2025-05-08 22:34:22,561 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=186, account_id=1808067262) of 250
2025-05-08 22:34:22,561 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1808067262/match-history?only_stored_history=true
2025-05-08 22:34:22,562 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:23,017 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1808067262/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:23,020 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:23,020 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1808067262
1      1808067262
2      1808067262
3      1808067262
4      1808067262
          ...    
495    1808067262
496    1808067262
497    1808067262
498    1808067262
499    1808067262
Name: account_id, Length: 500, dtype: int64
2025-05-08 22:34:23,021 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4590
2025-05-08 22:34:23,021 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3612
2025-05-08 22:34:23,021 [DEBUG] [root.generate_player_performance_metrics] match_total: 500
2025-05-08 22:34:23,022 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1808067262
1      1808067262
2      1808067262
3      1808067262
4      1808067262
          ...    
495    1808067262
496    1808067262
497    1808067262
498    1808067262
499    1808067262
Name: account_id, Length: 500, dtype: int64
2025-05-08 22:34:23,022 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:23,026 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:23,028 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:23,028 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:23,028 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:23,028 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:23,036 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 186-185
2025-05-08 22:34:23,036 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:23,038 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1808067262
2025-05-08 22:34:23,038 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:23,038 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:23,045 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 175108-174608
2025-05-08 22:34:23,045 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=187, account_id=1131491949) of 250
2025-05-08 22:34:23,045 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1131491949/match-history?only_stored_history=true
2025-05-08 22:34:23,045 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:23,549 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1131491949/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:23,554 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:23,554 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1131491949
1      1131491949
2      1131491949
3      1131491949
4      1131491949
          ...    
692    1131491949
693    1131491949
694    1131491949
695    1131491949
696    1131491949
Name: account_id, Length: 697, dtype: int64
2025-05-08 22:34:23,555 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6185
2025-05-08 22:34:23,555 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3718
2025-05-08 22:34:23,555 [DEBUG] [root.generate_player_performance_metrics] match_total: 697
2025-05-08 22:34:23,556 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1131491949
1      1131491949
2      1131491949
3      1131491949
4      1131491949
          ...    
692    1131491949
693    1131491949
694    1131491949
695    1131491949
696    1131491949
Name: account_id, Length: 697, dtype: int64
2025-05-08 22:34:23,556 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:23,561 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:23,562 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:23,562 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:23,562 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:23,562 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:23,568 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 187-186
2025-05-08 22:34:23,568 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:23,571 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1131491949
2025-05-08 22:34:23,572 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:23,572 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:23,579 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 175805-175108
2025-05-08 22:34:23,579 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=188, account_id=262925740) of 250
2025-05-08 22:34:23,579 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/262925740/match-history?only_stored_history=true
2025-05-08 22:34:23,580 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:23,997 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/262925740/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:24,015 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:24,016 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      262925740
1      262925740
2      262925740
3      262925740
4      262925740
         ...    
668    262925740
669    262925740
670    262925740
671    262925740
672    262925740
Name: account_id, Length: 673, dtype: int64
2025-05-08 22:34:24,016 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6000
2025-05-08 22:34:24,016 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4634
2025-05-08 22:34:24,016 [DEBUG] [root.generate_player_performance_metrics] match_total: 673
2025-05-08 22:34:24,017 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      262925740
1      262925740
2      262925740
3      262925740
4      262925740
         ...    
668    262925740
669    262925740
670    262925740
671    262925740
672    262925740
Name: account_id, Length: 673, dtype: int64
2025-05-08 22:34:24,017 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:24,022 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:24,023 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:24,023 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:24,023 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:24,023 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:24,031 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 188-187
2025-05-08 22:34:24,031 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:24,033 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 262925740
2025-05-08 22:34:24,034 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:24,034 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:24,041 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 176478-175805
2025-05-08 22:34:24,041 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=189, account_id=242702216) of 250
2025-05-08 22:34:24,041 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/242702216/match-history?only_stored_history=true
2025-05-08 22:34:24,042 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:24,517 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/242702216/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:24,622 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:24,623 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       242702216
1       242702216
2       242702216
3       242702216
4       242702216
          ...    
1351    242702216
1352    242702216
1353    242702216
1354    242702216
1355    242702216
Name: account_id, Length: 1356, dtype: int64
2025-05-08 22:34:24,623 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13634
2025-05-08 22:34:24,623 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6430
2025-05-08 22:34:24,623 [DEBUG] [root.generate_player_performance_metrics] match_total: 1356
2025-05-08 22:34:24,624 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       242702216
1       242702216
2       242702216
3       242702216
4       242702216
          ...    
1351    242702216
1352    242702216
1353    242702216
1354    242702216
1355    242702216
Name: account_id, Length: 1356, dtype: int64
2025-05-08 22:34:24,624 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:24,629 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:24,630 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:24,630 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:24,630 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:24,630 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:24,639 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 189-188
2025-05-08 22:34:24,639 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:24,640 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 242702216
2025-05-08 22:34:24,641 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:24,641 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:24,653 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 177834-176478
2025-05-08 22:34:24,653 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 87.80seconds. Processed 190 of 250 players
2025-05-08 22:34:24,653 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=190, account_id=104599140) of 250
2025-05-08 22:34:24,653 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/104599140/match-history?only_stored_history=true
2025-05-08 22:34:24,654 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:25,131 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/104599140/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:25,212 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:25,213 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       104599140
1       104599140
2       104599140
3       104599140
4       104599140
          ...    
1402    104599140
1403    104599140
1404    104599140
1405    104599140
1406    104599140
Name: account_id, Length: 1407, dtype: int64
2025-05-08 22:34:25,213 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7849
2025-05-08 22:34:25,213 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7452
2025-05-08 22:34:25,213 [DEBUG] [root.generate_player_performance_metrics] match_total: 1407
2025-05-08 22:34:25,214 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       104599140
1       104599140
2       104599140
3       104599140
4       104599140
          ...    
1402    104599140
1403    104599140
1404    104599140
1405    104599140
1406    104599140
Name: account_id, Length: 1407, dtype: int64
2025-05-08 22:34:25,214 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:25,219 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:25,220 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:25,220 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:25,220 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:25,221 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:25,228 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 190-189
2025-05-08 22:34:25,228 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:25,232 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 104599140
2025-05-08 22:34:25,232 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:25,232 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:25,243 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 179241-177834
2025-05-08 22:34:25,243 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=191, account_id=1860786150) of 250
2025-05-08 22:34:25,243 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1860786150/match-history?only_stored_history=true
2025-05-08 22:34:25,244 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:25,723 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1860786150/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:25,725 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:25,726 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1860786150
1      1860786150
2      1860786150
3      1860786150
4      1860786150
          ...    
277    1860786150
278    1860786150
279    1860786150
280    1860786150
281    1860786150
Name: account_id, Length: 282, dtype: int64
2025-05-08 22:34:25,726 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2915
2025-05-08 22:34:25,726 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1649
2025-05-08 22:34:25,726 [DEBUG] [root.generate_player_performance_metrics] match_total: 282
2025-05-08 22:34:25,727 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1860786150
1      1860786150
2      1860786150
3      1860786150
4      1860786150
          ...    
277    1860786150
278    1860786150
279    1860786150
280    1860786150
281    1860786150
Name: account_id, Length: 282, dtype: int64
2025-05-08 22:34:25,727 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:25,732 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:25,733 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:25,733 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:25,733 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:25,733 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:25,741 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 191-190
2025-05-08 22:34:25,741 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:25,743 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1860786150
2025-05-08 22:34:25,743 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:25,743 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:25,749 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 179523-179241
2025-05-08 22:34:25,749 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=192, account_id=295170811) of 250
2025-05-08 22:34:25,749 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/295170811/match-history?only_stored_history=true
2025-05-08 22:34:25,750 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:26,197 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/295170811/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:26,216 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:26,216 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      295170811
1      295170811
2      295170811
3      295170811
4      295170811
         ...    
724    295170811
725    295170811
726    295170811
727    295170811
728    295170811
Name: account_id, Length: 729, dtype: int64
2025-05-08 22:34:26,217 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6943
2025-05-08 22:34:26,217 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3989
2025-05-08 22:34:26,217 [DEBUG] [root.generate_player_performance_metrics] match_total: 729
2025-05-08 22:34:26,218 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      295170811
1      295170811
2      295170811
3      295170811
4      295170811
         ...    
724    295170811
725    295170811
726    295170811
727    295170811
728    295170811
Name: account_id, Length: 729, dtype: int64
2025-05-08 22:34:26,218 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:26,223 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:26,224 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:26,224 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:26,224 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:26,224 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:26,232 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 192-191
2025-05-08 22:34:26,232 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:26,234 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 295170811
2025-05-08 22:34:26,234 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:26,234 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:26,242 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 180252-179523
2025-05-08 22:34:26,242 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=193, account_id=72929955) of 250
2025-05-08 22:34:26,242 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/72929955/match-history?only_stored_history=true
2025-05-08 22:34:26,242 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:26,694 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/72929955/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:26,776 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:26,777 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       72929955
1       72929955
2       72929955
3       72929955
4       72929955
          ...   
1598    72929955
1599    72929955
1600    72929955
1601    72929955
1602    72929955
Name: account_id, Length: 1603, dtype: int64
2025-05-08 22:34:26,777 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13695
2025-05-08 22:34:26,777 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10480
2025-05-08 22:34:26,777 [DEBUG] [root.generate_player_performance_metrics] match_total: 1603
2025-05-08 22:34:26,778 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       72929955
1       72929955
2       72929955
3       72929955
4       72929955
          ...   
1598    72929955
1599    72929955
1600    72929955
1601    72929955
1602    72929955
Name: account_id, Length: 1603, dtype: int64
2025-05-08 22:34:26,778 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:26,783 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:26,785 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:26,785 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:26,785 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:26,785 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:26,795 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 193-192
2025-05-08 22:34:26,795 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:26,797 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 72929955
2025-05-08 22:34:26,797 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:26,797 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:26,810 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 181855-180252
2025-05-08 22:34:26,810 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=194, account_id=1142675197) of 250
2025-05-08 22:34:26,810 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1142675197/match-history?only_stored_history=true
2025-05-08 22:34:26,811 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:27,259 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1142675197/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:27,355 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:27,355 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1142675197
1       1142675197
2       1142675197
3       1142675197
4       1142675197
           ...    
1173    1142675197
1174    1142675197
1175    1142675197
1176    1142675197
1177    1142675197
Name: account_id, Length: 1178, dtype: int64
2025-05-08 22:34:27,356 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10600
2025-05-08 22:34:27,356 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9985
2025-05-08 22:34:27,356 [DEBUG] [root.generate_player_performance_metrics] match_total: 1178
2025-05-08 22:34:27,357 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1142675197
1       1142675197
2       1142675197
3       1142675197
4       1142675197
           ...    
1173    1142675197
1174    1142675197
1175    1142675197
1176    1142675197
1177    1142675197
Name: account_id, Length: 1178, dtype: int64
2025-05-08 22:34:27,357 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:27,361 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:27,363 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:27,363 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:27,363 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:27,363 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:27,371 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 194-193
2025-05-08 22:34:27,371 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:27,373 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1142675197
2025-05-08 22:34:27,373 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:27,373 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:27,383 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 183033-181855
2025-05-08 22:34:27,383 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=195, account_id=899775209) of 250
2025-05-08 22:34:27,383 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/899775209/match-history?only_stored_history=true
2025-05-08 22:34:27,383 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:27,873 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/899775209/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:27,951 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:27,951 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       899775209
1       899775209
2       899775209
3       899775209
4       899775209
          ...    
1320    899775209
1321    899775209
1322    899775209
1323    899775209
1324    899775209
Name: account_id, Length: 1325, dtype: int64
2025-05-08 22:34:27,952 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14858
2025-05-08 22:34:27,952 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11029
2025-05-08 22:34:27,952 [DEBUG] [root.generate_player_performance_metrics] match_total: 1325
2025-05-08 22:34:27,953 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       899775209
1       899775209
2       899775209
3       899775209
4       899775209
          ...    
1320    899775209
1321    899775209
1322    899775209
1323    899775209
1324    899775209
Name: account_id, Length: 1325, dtype: int64
2025-05-08 22:34:27,953 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:27,958 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:27,958 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:27,960 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:27,960 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:27,960 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:27,967 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 195-194
2025-05-08 22:34:27,967 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:27,969 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 899775209
2025-05-08 22:34:27,970 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:27,970 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:27,981 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 184358-183033
2025-05-08 22:34:27,981 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=196, account_id=1841671946) of 250
2025-05-08 22:34:27,981 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1841671946/match-history?only_stored_history=true
2025-05-08 22:34:27,981 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:28,342 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1841671946/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:28,343 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:28,344 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1841671946
1     1841671946
2     1841671946
3     1841671946
4     1841671946
5     1841671946
6     1841671946
7     1841671946
8     1841671946
9     1841671946
10    1841671946
11    1841671946
12    1841671946
13    1841671946
14    1841671946
15    1841671946
16    1841671946
17    1841671946
18    1841671946
19    1841671946
20    1841671946
21    1841671946
22    1841671946
23    1841671946
24    1841671946
25    1841671946
26    1841671946
27    1841671946
28    1841671946
29    1841671946
30    1841671946
31    1841671946
32    1841671946
33    1841671946
34    1841671946
35    1841671946
36    1841671946
37    1841671946
38    1841671946
39    1841671946
40    1841671946
41    1841671946
42    1841671946
43    1841671946
44    1841671946
45    1841671946
46    1841671946
47    1841671946
48    1841671946
49    1841671946
Name: account_id, dtype: int64
2025-05-08 22:34:28,344 [DEBUG] [root.generate_player_performance_metrics] total_kills: 547
2025-05-08 22:34:28,344 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 136
2025-05-08 22:34:28,344 [DEBUG] [root.generate_player_performance_metrics] match_total: 50
2025-05-08 22:34:28,345 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1841671946
1     1841671946
2     1841671946
3     1841671946
4     1841671946
5     1841671946
6     1841671946
7     1841671946
8     1841671946
9     1841671946
10    1841671946
11    1841671946
12    1841671946
13    1841671946
14    1841671946
15    1841671946
16    1841671946
17    1841671946
18    1841671946
19    1841671946
20    1841671946
21    1841671946
22    1841671946
23    1841671946
24    1841671946
25    1841671946
26    1841671946
27    1841671946
28    1841671946
29    1841671946
30    1841671946
31    1841671946
32    1841671946
33    1841671946
34    1841671946
35    1841671946
36    1841671946
37    1841671946
38    1841671946
39    1841671946
40    1841671946
41    1841671946
42    1841671946
43    1841671946
44    1841671946
45    1841671946
46    1841671946
47    1841671946
48    1841671946
49    1841671946
Name: account_id, dtype: int64
2025-05-08 22:34:28,345 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:28,350 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:28,351 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:28,351 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:28,351 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:28,351 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:28,359 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 196-195
2025-05-08 22:34:28,359 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:28,360 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1841671946
2025-05-08 22:34:28,361 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:28,361 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:28,366 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 184408-184358
2025-05-08 22:34:28,366 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=197, account_id=1085254369) of 250
2025-05-08 22:34:28,366 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1085254369/match-history?only_stored_history=true
2025-05-08 22:34:28,367 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:28,858 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1085254369/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:28,864 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:28,865 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1085254369
1      1085254369
2      1085254369
3      1085254369
4      1085254369
          ...    
819    1085254369
820    1085254369
821    1085254369
822    1085254369
823    1085254369
Name: account_id, Length: 824, dtype: int64
2025-05-08 22:34:28,865 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7828
2025-05-08 22:34:28,865 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4380
2025-05-08 22:34:28,865 [DEBUG] [root.generate_player_performance_metrics] match_total: 824
2025-05-08 22:34:28,866 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1085254369
1      1085254369
2      1085254369
3      1085254369
4      1085254369
          ...    
819    1085254369
820    1085254369
821    1085254369
822    1085254369
823    1085254369
Name: account_id, Length: 824, dtype: int64
2025-05-08 22:34:28,866 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:28,870 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:28,872 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:28,872 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:28,872 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:28,872 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:28,880 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 197-196
2025-05-08 22:34:28,880 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:28,882 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1085254369
2025-05-08 22:34:28,883 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:28,883 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:28,891 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 185232-184408
2025-05-08 22:34:28,891 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=198, account_id=852671020) of 250
2025-05-08 22:34:28,891 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/852671020/match-history?only_stored_history=true
2025-05-08 22:34:28,892 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:29,155 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/852671020/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:29,180 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:29,181 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      852671020
1      852671020
2      852671020
3      852671020
4      852671020
         ...    
855    852671020
856    852671020
857    852671020
858    852671020
859    852671020
Name: account_id, Length: 860, dtype: int64
2025-05-08 22:34:29,181 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6042
2025-05-08 22:34:29,181 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3846
2025-05-08 22:34:29,181 [DEBUG] [root.generate_player_performance_metrics] match_total: 860
2025-05-08 22:34:29,182 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      852671020
1      852671020
2      852671020
3      852671020
4      852671020
         ...    
855    852671020
856    852671020
857    852671020
858    852671020
859    852671020
Name: account_id, Length: 860, dtype: int64
2025-05-08 22:34:29,182 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:29,186 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:29,188 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:29,188 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:29,188 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:29,188 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:29,196 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 198-197
2025-05-08 22:34:29,196 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:29,198 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 852671020
2025-05-08 22:34:29,198 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:29,198 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:29,207 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 186092-185232
2025-05-08 22:34:29,207 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=199, account_id=895986795) of 250
2025-05-08 22:34:29,207 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/895986795/match-history?only_stored_history=true
2025-05-08 22:34:29,208 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:29,453 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/895986795/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:29,465 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:29,465 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      895986795
1      895986795
2      895986795
3      895986795
4      895986795
         ...    
444    895986795
445    895986795
446    895986795
447    895986795
448    895986795
Name: account_id, Length: 449, dtype: int64
2025-05-08 22:34:29,466 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3557
2025-05-08 22:34:29,466 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3002
2025-05-08 22:34:29,466 [DEBUG] [root.generate_player_performance_metrics] match_total: 449
2025-05-08 22:34:29,467 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      895986795
1      895986795
2      895986795
3      895986795
4      895986795
         ...    
444    895986795
445    895986795
446    895986795
447    895986795
448    895986795
Name: account_id, Length: 449, dtype: int64
2025-05-08 22:34:29,467 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:29,471 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:29,473 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:29,473 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:29,473 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:29,473 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:29,480 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 199-198
2025-05-08 22:34:29,480 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:29,482 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 895986795
2025-05-08 22:34:29,483 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:29,483 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:29,490 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 186541-186092
2025-05-08 22:34:29,490 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 92.64seconds. Processed 200 of 250 players
2025-05-08 22:34:29,490 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=200, account_id=858332612) of 250
2025-05-08 22:34:29,490 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/858332612/match-history?only_stored_history=true
2025-05-08 22:34:29,491 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:30,055 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/858332612/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:30,159 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:30,159 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       858332612
1       858332612
2       858332612
3       858332612
4       858332612
          ...    
1940    858332612
1941    858332612
1942    858332612
1943    858332612
1944    858332612
Name: account_id, Length: 1945, dtype: int64
2025-05-08 22:34:30,160 [DEBUG] [root.generate_player_performance_metrics] total_kills: 15232
2025-05-08 22:34:30,160 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 12331
2025-05-08 22:34:30,160 [DEBUG] [root.generate_player_performance_metrics] match_total: 1945
2025-05-08 22:34:30,161 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       858332612
1       858332612
2       858332612
3       858332612
4       858332612
          ...    
1940    858332612
1941    858332612
1942    858332612
1943    858332612
1944    858332612
Name: account_id, Length: 1945, dtype: int64
2025-05-08 22:34:30,161 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:30,166 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:30,167 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:30,167 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:30,167 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:30,167 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:30,178 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 200-199
2025-05-08 22:34:30,178 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:30,180 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 858332612
2025-05-08 22:34:30,180 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:30,180 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:30,197 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 188486-186541
2025-05-08 22:34:30,197 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=201, account_id=1850030762) of 250
2025-05-08 22:34:30,197 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1850030762/match-history?only_stored_history=true
2025-05-08 22:34:30,198 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:30,632 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1850030762/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:30,634 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:30,634 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1850030762
1      1850030762
2      1850030762
3      1850030762
4      1850030762
          ...    
156    1850030762
157    1850030762
158    1850030762
159    1850030762
160    1850030762
Name: account_id, Length: 161, dtype: int64
2025-05-08 22:34:30,635 [DEBUG] [root.generate_player_performance_metrics] total_kills: 2142
2025-05-08 22:34:30,635 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 738
2025-05-08 22:34:30,635 [DEBUG] [root.generate_player_performance_metrics] match_total: 161
2025-05-08 22:34:30,635 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1850030762
1      1850030762
2      1850030762
3      1850030762
4      1850030762
          ...    
156    1850030762
157    1850030762
158    1850030762
159    1850030762
160    1850030762
Name: account_id, Length: 161, dtype: int64
2025-05-08 22:34:30,635 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:30,640 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:30,641 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:30,641 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:30,641 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:30,641 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:30,649 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 201-200
2025-05-08 22:34:30,649 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:30,650 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1850030762
2025-05-08 22:34:30,652 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:30,652 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:30,657 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 188647-188486
2025-05-08 22:34:30,657 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=202, account_id=918793338) of 250
2025-05-08 22:34:30,657 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/918793338/match-history?only_stored_history=true
2025-05-08 22:34:30,658 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:31,110 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/918793338/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:31,121 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:31,121 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      918793338
1      918793338
2      918793338
3      918793338
4      918793338
         ...    
403    918793338
404    918793338
405    918793338
406    918793338
407    918793338
Name: account_id, Length: 408, dtype: int64
2025-05-08 22:34:31,121 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3739
2025-05-08 22:34:31,121 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2110
2025-05-08 22:34:31,122 [DEBUG] [root.generate_player_performance_metrics] match_total: 408
2025-05-08 22:34:31,122 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      918793338
1      918793338
2      918793338
3      918793338
4      918793338
         ...    
403    918793338
404    918793338
405    918793338
406    918793338
407    918793338
Name: account_id, Length: 408, dtype: int64
2025-05-08 22:34:31,122 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:31,127 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:31,128 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:31,128 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:31,128 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:31,128 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:31,137 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 202-201
2025-05-08 22:34:31,137 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:31,139 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 918793338
2025-05-08 22:34:31,139 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:31,139 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:31,145 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 189055-188647
2025-05-08 22:34:31,145 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=203, account_id=888288056) of 250
2025-05-08 22:34:31,145 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/888288056/match-history?only_stored_history=true
2025-05-08 22:34:31,145 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:31,453 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/888288056/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:31,460 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:31,461 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       888288056
1       888288056
2       888288056
3       888288056
4       888288056
          ...    
1152    888288056
1153    888288056
1154    888288056
1155    888288056
1156    888288056
Name: account_id, Length: 1157, dtype: int64
2025-05-08 22:34:31,461 [DEBUG] [root.generate_player_performance_metrics] total_kills: 12535
2025-05-08 22:34:31,461 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6147
2025-05-08 22:34:31,461 [DEBUG] [root.generate_player_performance_metrics] match_total: 1157
2025-05-08 22:34:31,462 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       888288056
1       888288056
2       888288056
3       888288056
4       888288056
          ...    
1152    888288056
1153    888288056
1154    888288056
1155    888288056
1156    888288056
Name: account_id, Length: 1157, dtype: int64
2025-05-08 22:34:31,462 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:31,467 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:31,468 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:31,468 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:31,468 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:31,468 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:31,477 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 203-202
2025-05-08 22:34:31,477 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:31,479 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 888288056
2025-05-08 22:34:31,479 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:31,479 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:31,489 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 190212-189055
2025-05-08 22:34:31,489 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=204, account_id=173076267) of 250
2025-05-08 22:34:31,489 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/173076267/match-history?only_stored_history=true
2025-05-08 22:34:31,490 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:31,976 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/173076267/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:32,046 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:32,047 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       173076267
1       173076267
2       173076267
3       173076267
4       173076267
          ...    
1068    173076267
1069    173076267
1070    173076267
1071    173076267
1072    173076267
Name: account_id, Length: 1073, dtype: int64
2025-05-08 22:34:32,047 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9137
2025-05-08 22:34:32,047 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5854
2025-05-08 22:34:32,048 [DEBUG] [root.generate_player_performance_metrics] match_total: 1073
2025-05-08 22:34:32,048 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       173076267
1       173076267
2       173076267
3       173076267
4       173076267
          ...    
1068    173076267
1069    173076267
1070    173076267
1071    173076267
1072    173076267
Name: account_id, Length: 1073, dtype: int64
2025-05-08 22:34:32,048 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:32,053 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:32,054 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:32,054 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:32,055 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:32,055 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:32,062 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 204-203
2025-05-08 22:34:32,062 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:32,064 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 173076267
2025-05-08 22:34:32,064 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:32,064 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:32,074 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 191285-190212
2025-05-08 22:34:32,074 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=205, account_id=839595668) of 250
2025-05-08 22:34:32,074 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/839595668/match-history?only_stored_history=true
2025-05-08 22:34:32,074 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:32,546 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/839595668/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:32,550 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:32,551 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      839595668
1      839595668
2      839595668
3      839595668
4      839595668
         ...    
851    839595668
852    839595668
853    839595668
854    839595668
855    839595668
Name: account_id, Length: 856, dtype: int64
2025-05-08 22:34:32,551 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5811
2025-05-08 22:34:32,551 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4672
2025-05-08 22:34:32,551 [DEBUG] [root.generate_player_performance_metrics] match_total: 856
2025-05-08 22:34:32,552 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      839595668
1      839595668
2      839595668
3      839595668
4      839595668
         ...    
851    839595668
852    839595668
853    839595668
854    839595668
855    839595668
Name: account_id, Length: 856, dtype: int64
2025-05-08 22:34:32,552 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:32,558 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:32,559 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:32,559 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:32,559 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:32,559 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:32,567 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 205-204
2025-05-08 22:34:32,567 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:32,569 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 839595668
2025-05-08 22:34:32,569 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:32,569 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:32,578 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 192141-191285
2025-05-08 22:34:32,578 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=206, account_id=1129934912) of 250
2025-05-08 22:34:32,578 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1129934912/match-history?only_stored_history=true
2025-05-08 22:34:32,579 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:33,026 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1129934912/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:33,031 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:33,032 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1129934912
1      1129934912
2      1129934912
3      1129934912
4      1129934912
          ...    
814    1129934912
815    1129934912
816    1129934912
817    1129934912
818    1129934912
Name: account_id, Length: 819, dtype: int64
2025-05-08 22:34:33,032 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6169
2025-05-08 22:34:33,032 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3600
2025-05-08 22:34:33,032 [DEBUG] [root.generate_player_performance_metrics] match_total: 819
2025-05-08 22:34:33,033 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1129934912
1      1129934912
2      1129934912
3      1129934912
4      1129934912
          ...    
814    1129934912
815    1129934912
816    1129934912
817    1129934912
818    1129934912
Name: account_id, Length: 819, dtype: int64
2025-05-08 22:34:33,033 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:33,038 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:33,039 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:33,039 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:33,039 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:33,039 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:33,046 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 206-205
2025-05-08 22:34:33,047 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:33,049 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1129934912
2025-05-08 22:34:33,049 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:33,049 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:33,057 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 192960-192141
2025-05-08 22:34:33,057 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=207, account_id=1799636657) of 250
2025-05-08 22:34:33,057 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1799636657/match-history?only_stored_history=true
2025-05-08 22:34:33,058 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:33,295 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1799636657/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:33,295 [ERROR] [root.fetch_player_match_history] player_match_history is empty in fetch_player_match_history, p_id: 1799636657
2025-05-08 22:34:33,295 [WARNING] [root.run_etl_player_hero_match_trends] No match history found for player 1799636657
2025-05-08 22:34:33,295 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=208, account_id=83057047) of 250
2025-05-08 22:34:33,295 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/83057047/match-history?only_stored_history=true
2025-05-08 22:34:33,296 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:33,794 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/83057047/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:33,803 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:33,803 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      83057047
1      83057047
2      83057047
3      83057047
4      83057047
         ...   
470    83057047
471    83057047
472    83057047
473    83057047
474    83057047
Name: account_id, Length: 475, dtype: int64
2025-05-08 22:34:33,803 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4860
2025-05-08 22:34:33,803 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3474
2025-05-08 22:34:33,804 [DEBUG] [root.generate_player_performance_metrics] match_total: 475
2025-05-08 22:34:33,804 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      83057047
1      83057047
2      83057047
3      83057047
4      83057047
         ...   
470    83057047
471    83057047
472    83057047
473    83057047
474    83057047
Name: account_id, Length: 475, dtype: int64
2025-05-08 22:34:33,804 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:33,809 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:33,810 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:33,810 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:33,810 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:33,810 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:33,818 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 207-206
2025-05-08 22:34:33,818 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:33,819 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 83057047
2025-05-08 22:34:33,820 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:33,820 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:33,826 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 193435-192960
2025-05-08 22:34:33,826 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=209, account_id=974517477) of 250
2025-05-08 22:34:33,826 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/974517477/match-history?only_stored_history=true
2025-05-08 22:34:33,827 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:34,408 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/974517477/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:34,416 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:34,417 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       974517477
1       974517477
2       974517477
3       974517477
4       974517477
          ...    
1392    974517477
1393    974517477
1394    974517477
1395    974517477
1396    974517477
Name: account_id, Length: 1397, dtype: int64
2025-05-08 22:34:34,417 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11042
2025-05-08 22:34:34,417 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8075
2025-05-08 22:34:34,417 [DEBUG] [root.generate_player_performance_metrics] match_total: 1397
2025-05-08 22:34:34,418 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       974517477
1       974517477
2       974517477
3       974517477
4       974517477
          ...    
1392    974517477
1393    974517477
1394    974517477
1395    974517477
1396    974517477
Name: account_id, Length: 1397, dtype: int64
2025-05-08 22:34:34,418 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:34,424 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:34,425 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:34,425 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:34,425 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:34,425 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:34,434 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 208-207
2025-05-08 22:34:34,434 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:34,436 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 974517477
2025-05-08 22:34:34,436 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:34,436 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:34,448 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 194832-193435
2025-05-08 22:34:34,448 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 97.60seconds. Processed 210 of 250 players
2025-05-08 22:34:34,448 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=210, account_id=377948415) of 250
2025-05-08 22:34:34,448 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/377948415/match-history?only_stored_history=true
2025-05-08 22:34:34,449 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:34,937 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/377948415/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:35,020 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:35,021 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       377948415
1       377948415
2       377948415
3       377948415
4       377948415
          ...    
1448    377948415
1449    377948415
1450    377948415
1451    377948415
1452    377948415
Name: account_id, Length: 1453, dtype: int64
2025-05-08 22:34:35,021 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10410
2025-05-08 22:34:35,021 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11704
2025-05-08 22:34:35,021 [DEBUG] [root.generate_player_performance_metrics] match_total: 1453
2025-05-08 22:34:35,022 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       377948415
1       377948415
2       377948415
3       377948415
4       377948415
          ...    
1448    377948415
1449    377948415
1450    377948415
1451    377948415
1452    377948415
Name: account_id, Length: 1453, dtype: int64
2025-05-08 22:34:35,022 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:35,027 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:35,028 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:35,028 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:35,028 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:35,028 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:35,037 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 209-208
2025-05-08 22:34:35,037 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:35,039 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 377948415
2025-05-08 22:34:35,039 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:35,039 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:35,051 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 196285-194832
2025-05-08 22:34:35,051 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=211, account_id=856338556) of 250
2025-05-08 22:34:35,051 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/856338556/match-history?only_stored_history=true
2025-05-08 22:34:35,051 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:35,520 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/856338556/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:35,524 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:35,525 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      856338556
1      856338556
2      856338556
3      856338556
4      856338556
         ...    
607    856338556
608    856338556
609    856338556
610    856338556
611    856338556
Name: account_id, Length: 612, dtype: int64
2025-05-08 22:34:35,525 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5948
2025-05-08 22:34:35,525 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3146
2025-05-08 22:34:35,525 [DEBUG] [root.generate_player_performance_metrics] match_total: 612
2025-05-08 22:34:35,526 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      856338556
1      856338556
2      856338556
3      856338556
4      856338556
         ...    
607    856338556
608    856338556
609    856338556
610    856338556
611    856338556
Name: account_id, Length: 612, dtype: int64
2025-05-08 22:34:35,526 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:35,531 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:35,533 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:35,533 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:35,533 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:35,533 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:35,540 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 210-209
2025-05-08 22:34:35,540 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:35,542 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 856338556
2025-05-08 22:34:35,542 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:35,542 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:35,549 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 196897-196285
2025-05-08 22:34:35,549 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=212, account_id=1734752566) of 250
2025-05-08 22:34:35,549 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1734752566/match-history?only_stored_history=true
2025-05-08 22:34:35,550 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:35,932 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1734752566/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:35,933 [ERROR] [root.fetch_player_match_history] player_match_history is empty in fetch_player_match_history, p_id: 1734752566
2025-05-08 22:34:35,933 [WARNING] [root.run_etl_player_hero_match_trends] No match history found for player 1734752566
2025-05-08 22:34:35,933 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=213, account_id=86936554) of 250
2025-05-08 22:34:35,933 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/86936554/match-history?only_stored_history=true
2025-05-08 22:34:35,934 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:36,242 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/86936554/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:36,351 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:36,352 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       86936554
1       86936554
2       86936554
3       86936554
4       86936554
          ...   
1996    86936554
1997    86936554
1998    86936554
1999    86936554
2000    86936554
Name: account_id, Length: 2001, dtype: int64
2025-05-08 22:34:36,352 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14109
2025-05-08 22:34:36,352 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 11147
2025-05-08 22:34:36,352 [DEBUG] [root.generate_player_performance_metrics] match_total: 2001
2025-05-08 22:34:36,353 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       86936554
1       86936554
2       86936554
3       86936554
4       86936554
          ...   
1996    86936554
1997    86936554
1998    86936554
1999    86936554
2000    86936554
Name: account_id, Length: 2001, dtype: int64
2025-05-08 22:34:36,353 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:36,359 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:36,360 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:36,360 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:36,360 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:36,360 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:36,370 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 211-210
2025-05-08 22:34:36,370 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:36,372 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 86936554
2025-05-08 22:34:36,372 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:36,372 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:36,389 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 198898-196897
2025-05-08 22:34:36,389 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=214, account_id=1562248701) of 250
2025-05-08 22:34:36,389 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1562248701/match-history?only_stored_history=true
2025-05-08 22:34:36,389 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:36,870 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1562248701/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:36,881 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:36,881 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1562248701
1      1562248701
2      1562248701
3      1562248701
4      1562248701
          ...    
819    1562248701
820    1562248701
821    1562248701
822    1562248701
823    1562248701
Name: account_id, Length: 824, dtype: int64
2025-05-08 22:34:36,882 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6165
2025-05-08 22:34:36,882 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5998
2025-05-08 22:34:36,882 [DEBUG] [root.generate_player_performance_metrics] match_total: 824
2025-05-08 22:34:36,882 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1562248701
1      1562248701
2      1562248701
3      1562248701
4      1562248701
          ...    
819    1562248701
820    1562248701
821    1562248701
822    1562248701
823    1562248701
Name: account_id, Length: 824, dtype: int64
2025-05-08 22:34:36,883 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:36,887 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:36,888 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:36,889 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:36,889 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:36,889 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:36,897 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 212-211
2025-05-08 22:34:36,897 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:36,899 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1562248701
2025-05-08 22:34:36,899 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:36,899 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:36,907 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 199722-198898
2025-05-08 22:34:36,907 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=215, account_id=195016484) of 250
2025-05-08 22:34:36,907 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/195016484/match-history?only_stored_history=true
2025-05-08 22:34:36,907 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:37,320 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/195016484/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:37,422 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:37,423 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       195016484
1       195016484
2       195016484
3       195016484
4       195016484
          ...    
1351    195016484
1352    195016484
1353    195016484
1354    195016484
1355    195016484
Name: account_id, Length: 1356, dtype: int64
2025-05-08 22:34:37,423 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10842
2025-05-08 22:34:37,423 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5972
2025-05-08 22:34:37,423 [DEBUG] [root.generate_player_performance_metrics] match_total: 1356
2025-05-08 22:34:37,424 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       195016484
1       195016484
2       195016484
3       195016484
4       195016484
          ...    
1351    195016484
1352    195016484
1353    195016484
1354    195016484
1355    195016484
Name: account_id, Length: 1356, dtype: int64
2025-05-08 22:34:37,424 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:37,429 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:37,431 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:37,431 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:37,431 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:37,431 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:37,438 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 213-212
2025-05-08 22:34:37,439 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:37,440 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 195016484
2025-05-08 22:34:37,441 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:37,441 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:37,453 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 201078-199722
2025-05-08 22:34:37,453 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=216, account_id=1682265751) of 250
2025-05-08 22:34:37,453 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1682265751/match-history?only_stored_history=true
2025-05-08 22:34:37,453 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:37,736 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1682265751/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:37,845 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:37,846 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1682265751
1       1682265751
2       1682265751
3       1682265751
4       1682265751
           ...    
1763    1682265751
1764    1682265751
1765    1682265751
1766    1682265751
1767    1682265751
Name: account_id, Length: 1768, dtype: int64
2025-05-08 22:34:37,846 [DEBUG] [root.generate_player_performance_metrics] total_kills: 14223
2025-05-08 22:34:37,846 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9948
2025-05-08 22:34:37,846 [DEBUG] [root.generate_player_performance_metrics] match_total: 1768
2025-05-08 22:34:37,847 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1682265751
1       1682265751
2       1682265751
3       1682265751
4       1682265751
           ...    
1763    1682265751
1764    1682265751
1765    1682265751
1766    1682265751
1767    1682265751
Name: account_id, Length: 1768, dtype: int64
2025-05-08 22:34:37,847 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:37,853 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:37,854 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:37,854 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:37,854 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:37,854 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:37,863 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 214-213
2025-05-08 22:34:37,863 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:37,866 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1682265751
2025-05-08 22:34:37,866 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:37,866 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:37,880 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 202846-201078
2025-05-08 22:34:37,880 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=217, account_id=1018014843) of 250
2025-05-08 22:34:37,880 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1018014843/match-history?only_stored_history=true
2025-05-08 22:34:37,881 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:38,340 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1018014843/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:38,347 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:38,347 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1018014843
1       1018014843
2       1018014843
3       1018014843
4       1018014843
           ...    
1067    1018014843
1068    1018014843
1069    1018014843
1070    1018014843
1071    1018014843
Name: account_id, Length: 1072, dtype: int64
2025-05-08 22:34:38,347 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5842
2025-05-08 22:34:38,348 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8297
2025-05-08 22:34:38,348 [DEBUG] [root.generate_player_performance_metrics] match_total: 1072
2025-05-08 22:34:38,348 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1018014843
1       1018014843
2       1018014843
3       1018014843
4       1018014843
           ...    
1067    1018014843
1068    1018014843
1069    1018014843
1070    1018014843
1071    1018014843
Name: account_id, Length: 1072, dtype: int64
2025-05-08 22:34:38,348 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:38,353 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:38,354 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:38,354 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:38,354 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:38,355 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:38,363 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 215-214
2025-05-08 22:34:38,363 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:38,365 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1018014843
2025-05-08 22:34:38,365 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:38,365 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:38,376 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 203918-202846
2025-05-08 22:34:38,376 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=218, account_id=6888268) of 250
2025-05-08 22:34:38,376 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/6888268/match-history?only_stored_history=true
2025-05-08 22:34:38,377 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:38,850 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/6888268/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:38,856 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:38,856 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      6888268
1      6888268
2      6888268
3      6888268
4      6888268
        ...   
685    6888268
686    6888268
687    6888268
688    6888268
689    6888268
Name: account_id, Length: 690, dtype: int64
2025-05-08 22:34:38,857 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4034
2025-05-08 22:34:38,857 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3146
2025-05-08 22:34:38,857 [DEBUG] [root.generate_player_performance_metrics] match_total: 690
2025-05-08 22:34:38,858 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      6888268
1      6888268
2      6888268
3      6888268
4      6888268
        ...   
685    6888268
686    6888268
687    6888268
688    6888268
689    6888268
Name: account_id, Length: 690, dtype: int64
2025-05-08 22:34:38,858 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:38,862 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:38,863 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:38,863 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:38,863 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:38,863 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:38,870 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 216-215
2025-05-08 22:34:38,870 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:38,872 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 6888268
2025-05-08 22:34:38,872 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:38,873 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:38,880 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 204608-203918
2025-05-08 22:34:38,880 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=219, account_id=1624341528) of 250
2025-05-08 22:34:38,880 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1624341528/match-history?only_stored_history=true
2025-05-08 22:34:38,881 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:39,361 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1624341528/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:39,473 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:39,473 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1624341528
1       1624341528
2       1624341528
3       1624341528
4       1624341528
           ...    
1748    1624341528
1749    1624341528
1750    1624341528
1751    1624341528
1752    1624341528
Name: account_id, Length: 1753, dtype: int64
2025-05-08 22:34:39,474 [DEBUG] [root.generate_player_performance_metrics] total_kills: 11238
2025-05-08 22:34:39,474 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9925
2025-05-08 22:34:39,474 [DEBUG] [root.generate_player_performance_metrics] match_total: 1753
2025-05-08 22:34:39,475 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1624341528
1       1624341528
2       1624341528
3       1624341528
4       1624341528
           ...    
1748    1624341528
1749    1624341528
1750    1624341528
1751    1624341528
1752    1624341528
Name: account_id, Length: 1753, dtype: int64
2025-05-08 22:34:39,475 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:39,480 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:39,481 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:39,481 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:39,481 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:39,481 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:39,489 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 217-216
2025-05-08 22:34:39,489 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:39,492 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1624341528
2025-05-08 22:34:39,492 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:39,492 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:39,507 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 206361-204608
2025-05-08 22:34:39,508 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 102.66seconds. Processed 220 of 250 players
2025-05-08 22:34:39,508 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=220, account_id=102629081) of 250
2025-05-08 22:34:39,508 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/102629081/match-history?only_stored_history=true
2025-05-08 22:34:39,508 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:39,753 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/102629081/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:39,781 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:39,781 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       102629081
1       102629081
2       102629081
3       102629081
4       102629081
          ...    
1004    102629081
1005    102629081
1006    102629081
1007    102629081
1008    102629081
Name: account_id, Length: 1009, dtype: int64
2025-05-08 22:34:39,782 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7609
2025-05-08 22:34:39,782 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5662
2025-05-08 22:34:39,782 [DEBUG] [root.generate_player_performance_metrics] match_total: 1009
2025-05-08 22:34:39,783 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       102629081
1       102629081
2       102629081
3       102629081
4       102629081
          ...    
1004    102629081
1005    102629081
1006    102629081
1007    102629081
1008    102629081
Name: account_id, Length: 1009, dtype: int64
2025-05-08 22:34:39,783 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:39,787 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:39,788 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:39,789 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:39,789 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:39,789 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:39,797 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 218-217
2025-05-08 22:34:39,797 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:39,799 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 102629081
2025-05-08 22:34:39,800 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:39,800 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:39,809 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 207370-206361
2025-05-08 22:34:39,809 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=221, account_id=1244155246) of 250
2025-05-08 22:34:39,809 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1244155246/match-history?only_stored_history=true
2025-05-08 22:34:39,810 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:40,409 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1244155246/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:40,418 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:40,418 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1244155246
1       1244155246
2       1244155246
3       1244155246
4       1244155246
           ...    
1396    1244155246
1397    1244155246
1398    1244155246
1399    1244155246
1400    1244155246
Name: account_id, Length: 1401, dtype: int64
2025-05-08 22:34:40,419 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9765
2025-05-08 22:34:40,419 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9857
2025-05-08 22:34:40,419 [DEBUG] [root.generate_player_performance_metrics] match_total: 1401
2025-05-08 22:34:40,419 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1244155246
1       1244155246
2       1244155246
3       1244155246
4       1244155246
           ...    
1396    1244155246
1397    1244155246
1398    1244155246
1399    1244155246
1400    1244155246
Name: account_id, Length: 1401, dtype: int64
2025-05-08 22:34:40,419 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:40,424 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:40,425 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:40,425 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:40,425 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:40,425 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:40,434 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 219-218
2025-05-08 22:34:40,434 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:40,436 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1244155246
2025-05-08 22:34:40,436 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:40,436 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:40,448 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 208771-207370
2025-05-08 22:34:40,448 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=222, account_id=1555744383) of 250
2025-05-08 22:34:40,448 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1555744383/match-history?only_stored_history=true
2025-05-08 22:34:40,448 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:40,847 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1555744383/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:40,849 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:40,849 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1555744383
1      1555744383
2      1555744383
3      1555744383
4      1555744383
          ...    
148    1555744383
149    1555744383
150    1555744383
151    1555744383
152    1555744383
Name: account_id, Length: 153, dtype: int64
2025-05-08 22:34:40,850 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1694
2025-05-08 22:34:40,850 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 808
2025-05-08 22:34:40,850 [DEBUG] [root.generate_player_performance_metrics] match_total: 153
2025-05-08 22:34:40,851 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1555744383
1      1555744383
2      1555744383
3      1555744383
4      1555744383
          ...    
148    1555744383
149    1555744383
150    1555744383
151    1555744383
152    1555744383
Name: account_id, Length: 153, dtype: int64
2025-05-08 22:34:40,851 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:40,855 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:40,857 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:40,857 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:40,857 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:40,857 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:40,865 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 220-219
2025-05-08 22:34:40,865 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:40,867 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1555744383
2025-05-08 22:34:40,867 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:40,867 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:40,872 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 208924-208771
2025-05-08 22:34:40,873 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=223, account_id=444495446) of 250
2025-05-08 22:34:40,873 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/444495446/match-history?only_stored_history=true
2025-05-08 22:34:40,873 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:41,300 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/444495446/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:41,304 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:41,305 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      444495446
1      444495446
2      444495446
3      444495446
4      444495446
         ...    
343    444495446
344    444495446
345    444495446
346    444495446
347    444495446
Name: account_id, Length: 348, dtype: int64
2025-05-08 22:34:41,305 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3580
2025-05-08 22:34:41,305 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 1426
2025-05-08 22:34:41,305 [DEBUG] [root.generate_player_performance_metrics] match_total: 348
2025-05-08 22:34:41,306 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      444495446
1      444495446
2      444495446
3      444495446
4      444495446
         ...    
343    444495446
344    444495446
345    444495446
346    444495446
347    444495446
Name: account_id, Length: 348, dtype: int64
2025-05-08 22:34:41,306 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:41,310 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:41,312 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:41,312 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:41,312 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:41,312 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:41,318 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 221-220
2025-05-08 22:34:41,318 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:41,320 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 444495446
2025-05-08 22:34:41,321 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:41,321 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:41,328 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 209272-208924
2025-05-08 22:34:41,328 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=224, account_id=1080128109) of 250
2025-05-08 22:34:41,328 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1080128109/match-history?only_stored_history=true
2025-05-08 22:34:41,329 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:41,795 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1080128109/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:41,909 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:41,909 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1080128109
1       1080128109
2       1080128109
3       1080128109
4       1080128109
           ...    
1942    1080128109
1943    1080128109
1944    1080128109
1945    1080128109
1946    1080128109
Name: account_id, Length: 1947, dtype: int64
2025-05-08 22:34:41,910 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13770
2025-05-08 22:34:41,910 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10132
2025-05-08 22:34:41,910 [DEBUG] [root.generate_player_performance_metrics] match_total: 1947
2025-05-08 22:34:41,910 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1080128109
1       1080128109
2       1080128109
3       1080128109
4       1080128109
           ...    
1942    1080128109
1943    1080128109
1944    1080128109
1945    1080128109
1946    1080128109
Name: account_id, Length: 1947, dtype: int64
2025-05-08 22:34:41,911 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:41,915 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:41,917 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:41,917 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:41,917 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:41,917 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:41,927 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 222-221
2025-05-08 22:34:41,927 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:41,929 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1080128109
2025-05-08 22:34:41,929 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:41,929 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:41,945 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 211219-209272
2025-05-08 22:34:41,945 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=225, account_id=163329738) of 250
2025-05-08 22:34:41,945 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/163329738/match-history?only_stored_history=true
2025-05-08 22:34:41,946 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:42,226 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/163329738/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:42,272 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:42,273 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       163329738
1       163329738
2       163329738
3       163329738
4       163329738
          ...    
1419    163329738
1420    163329738
1421    163329738
1422    163329738
1423    163329738
Name: account_id, Length: 1424, dtype: int64
2025-05-08 22:34:42,273 [DEBUG] [root.generate_player_performance_metrics] total_kills: 13512
2025-05-08 22:34:42,273 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7130
2025-05-08 22:34:42,273 [DEBUG] [root.generate_player_performance_metrics] match_total: 1424
2025-05-08 22:34:42,274 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       163329738
1       163329738
2       163329738
3       163329738
4       163329738
          ...    
1419    163329738
1420    163329738
1421    163329738
1422    163329738
1423    163329738
Name: account_id, Length: 1424, dtype: int64
2025-05-08 22:34:42,274 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:42,279 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:42,280 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:42,280 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:42,280 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:42,280 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:42,289 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 223-222
2025-05-08 22:34:42,289 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:42,291 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 163329738
2025-05-08 22:34:42,292 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:42,292 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:42,307 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 212643-211219
2025-05-08 22:34:42,308 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=226, account_id=215398243) of 250
2025-05-08 22:34:42,308 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/215398243/match-history?only_stored_history=true
2025-05-08 22:34:42,308 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:42,891 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/215398243/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:42,898 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:42,899 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       215398243
1       215398243
2       215398243
3       215398243
4       215398243
          ...    
1225    215398243
1226    215398243
1227    215398243
1228    215398243
1229    215398243
Name: account_id, Length: 1230, dtype: int64
2025-05-08 22:34:42,899 [DEBUG] [root.generate_player_performance_metrics] total_kills: 9465
2025-05-08 22:34:42,899 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7754
2025-05-08 22:34:42,899 [DEBUG] [root.generate_player_performance_metrics] match_total: 1230
2025-05-08 22:34:42,900 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       215398243
1       215398243
2       215398243
3       215398243
4       215398243
          ...    
1225    215398243
1226    215398243
1227    215398243
1228    215398243
1229    215398243
Name: account_id, Length: 1230, dtype: int64
2025-05-08 22:34:42,900 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:42,905 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:42,906 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:42,906 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:42,906 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:42,907 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:42,915 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 224-223
2025-05-08 22:34:42,916 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:42,918 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 215398243
2025-05-08 22:34:42,918 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:42,918 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:42,933 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 213873-212643
2025-05-08 22:34:42,933 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=227, account_id=1881573494) of 250
2025-05-08 22:34:42,933 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1881573494/match-history?only_stored_history=true
2025-05-08 22:34:42,934 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:43,150 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1881573494/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:43,151 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:43,152 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1881573494
1     1881573494
2     1881573494
3     1881573494
4     1881573494
5     1881573494
6     1881573494
7     1881573494
8     1881573494
9     1881573494
10    1881573494
11    1881573494
12    1881573494
13    1881573494
14    1881573494
15    1881573494
16    1881573494
17    1881573494
18    1881573494
19    1881573494
20    1881573494
21    1881573494
22    1881573494
23    1881573494
24    1881573494
25    1881573494
26    1881573494
27    1881573494
28    1881573494
29    1881573494
30    1881573494
31    1881573494
32    1881573494
33    1881573494
34    1881573494
35    1881573494
36    1881573494
37    1881573494
38    1881573494
39    1881573494
40    1881573494
41    1881573494
42    1881573494
43    1881573494
44    1881573494
45    1881573494
46    1881573494
47    1881573494
48    1881573494
Name: account_id, dtype: int64
2025-05-08 22:34:43,152 [DEBUG] [root.generate_player_performance_metrics] total_kills: 481
2025-05-08 22:34:43,152 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 158
2025-05-08 22:34:43,152 [DEBUG] [root.generate_player_performance_metrics] match_total: 49
2025-05-08 22:34:43,153 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1881573494
1     1881573494
2     1881573494
3     1881573494
4     1881573494
5     1881573494
6     1881573494
7     1881573494
8     1881573494
9     1881573494
10    1881573494
11    1881573494
12    1881573494
13    1881573494
14    1881573494
15    1881573494
16    1881573494
17    1881573494
18    1881573494
19    1881573494
20    1881573494
21    1881573494
22    1881573494
23    1881573494
24    1881573494
25    1881573494
26    1881573494
27    1881573494
28    1881573494
29    1881573494
30    1881573494
31    1881573494
32    1881573494
33    1881573494
34    1881573494
35    1881573494
36    1881573494
37    1881573494
38    1881573494
39    1881573494
40    1881573494
41    1881573494
42    1881573494
43    1881573494
44    1881573494
45    1881573494
46    1881573494
47    1881573494
48    1881573494
Name: account_id, dtype: int64
2025-05-08 22:34:43,153 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:43,157 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:43,160 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:43,160 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:43,160 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:43,160 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:43,167 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 225-224
2025-05-08 22:34:43,167 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:43,169 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1881573494
2025-05-08 22:34:43,169 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:43,169 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:43,174 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 213922-213873
2025-05-08 22:34:43,174 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=228, account_id=179675971) of 250
2025-05-08 22:34:43,175 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/179675971/match-history?only_stored_history=true
2025-05-08 22:34:43,175 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:43,755 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/179675971/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:43,764 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:43,765 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       179675971
1       179675971
2       179675971
3       179675971
4       179675971
          ...    
1457    179675971
1458    179675971
1459    179675971
1460    179675971
1461    179675971
Name: account_id, Length: 1462, dtype: int64
2025-05-08 22:34:43,765 [DEBUG] [root.generate_player_performance_metrics] total_kills: 15563
2025-05-08 22:34:43,765 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8577
2025-05-08 22:34:43,765 [DEBUG] [root.generate_player_performance_metrics] match_total: 1462
2025-05-08 22:34:43,766 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       179675971
1       179675971
2       179675971
3       179675971
4       179675971
          ...    
1457    179675971
1458    179675971
1459    179675971
1460    179675971
1461    179675971
Name: account_id, Length: 1462, dtype: int64
2025-05-08 22:34:43,766 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:43,772 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:43,773 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:43,773 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:43,773 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:43,773 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:43,781 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 226-225
2025-05-08 22:34:43,781 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:43,784 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 179675971
2025-05-08 22:34:43,784 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:43,784 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:43,799 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 215384-213922
2025-05-08 22:34:43,799 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=229, account_id=150079070) of 250
2025-05-08 22:34:43,799 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/150079070/match-history?only_stored_history=true
2025-05-08 22:34:43,800 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:44,224 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/150079070/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:44,327 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:44,328 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       150079070
1       150079070
2       150079070
3       150079070
4       150079070
          ...    
1201    150079070
1202    150079070
1203    150079070
1204    150079070
1205    150079070
Name: account_id, Length: 1206, dtype: int64
2025-05-08 22:34:44,328 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8364
2025-05-08 22:34:44,328 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 9688
2025-05-08 22:34:44,328 [DEBUG] [root.generate_player_performance_metrics] match_total: 1206
2025-05-08 22:34:44,329 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       150079070
1       150079070
2       150079070
3       150079070
4       150079070
          ...    
1201    150079070
1202    150079070
1203    150079070
1204    150079070
1205    150079070
Name: account_id, Length: 1206, dtype: int64
2025-05-08 22:34:44,329 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:44,334 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:44,336 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:44,336 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:44,336 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:44,336 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:44,344 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 227-226
2025-05-08 22:34:44,344 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:44,346 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 150079070
2025-05-08 22:34:44,346 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:44,346 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:44,361 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 216590-215384
2025-05-08 22:34:44,361 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 107.51seconds. Processed 230 of 250 players
2025-05-08 22:34:44,361 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=230, account_id=1387549649) of 250
2025-05-08 22:34:44,361 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1387549649/match-history?only_stored_history=true
2025-05-08 22:34:44,362 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:44,784 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1387549649/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:44,806 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:44,806 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1387549649
1      1387549649
2      1387549649
3      1387549649
4      1387549649
          ...    
753    1387549649
754    1387549649
755    1387549649
756    1387549649
757    1387549649
Name: account_id, Length: 758, dtype: int64
2025-05-08 22:34:44,806 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5879
2025-05-08 22:34:44,806 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5635
2025-05-08 22:34:44,806 [DEBUG] [root.generate_player_performance_metrics] match_total: 758
2025-05-08 22:34:44,807 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1387549649
1      1387549649
2      1387549649
3      1387549649
4      1387549649
          ...    
753    1387549649
754    1387549649
755    1387549649
756    1387549649
757    1387549649
Name: account_id, Length: 758, dtype: int64
2025-05-08 22:34:44,807 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:44,812 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:44,813 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:44,813 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:44,813 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:44,813 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:44,821 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 228-227
2025-05-08 22:34:44,821 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:44,824 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1387549649
2025-05-08 22:34:44,824 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:44,824 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:44,839 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 217348-216590
2025-05-08 22:34:44,839 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=231, account_id=282957284) of 250
2025-05-08 22:34:44,839 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/282957284/match-history?only_stored_history=true
2025-05-08 22:34:44,840 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:45,335 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/282957284/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:45,414 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:45,415 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       282957284
1       282957284
2       282957284
3       282957284
4       282957284
          ...    
1267    282957284
1268    282957284
1269    282957284
1270    282957284
1271    282957284
Name: account_id, Length: 1272, dtype: int64
2025-05-08 22:34:45,415 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8879
2025-05-08 22:34:45,415 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7398
2025-05-08 22:34:45,416 [DEBUG] [root.generate_player_performance_metrics] match_total: 1272
2025-05-08 22:34:45,416 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       282957284
1       282957284
2       282957284
3       282957284
4       282957284
          ...    
1267    282957284
1268    282957284
1269    282957284
1270    282957284
1271    282957284
Name: account_id, Length: 1272, dtype: int64
2025-05-08 22:34:45,416 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:45,421 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:45,422 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:45,422 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:45,423 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:45,423 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:45,432 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 229-228
2025-05-08 22:34:45,432 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:45,435 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 282957284
2025-05-08 22:34:45,435 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:45,435 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:45,449 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 218620-217348
2025-05-08 22:34:45,449 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=232, account_id=1176357514) of 250
2025-05-08 22:34:45,449 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1176357514/match-history?only_stored_history=true
2025-05-08 22:34:45,451 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:45,685 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1176357514/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:45,695 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:45,696 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1176357514
1      1176357514
2      1176357514
3      1176357514
4      1176357514
          ...    
369    1176357514
370    1176357514
371    1176357514
372    1176357514
373    1176357514
Name: account_id, Length: 374, dtype: int64
2025-05-08 22:34:45,696 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3093
2025-05-08 22:34:45,696 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3110
2025-05-08 22:34:45,696 [DEBUG] [root.generate_player_performance_metrics] match_total: 374
2025-05-08 22:34:45,697 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1176357514
1      1176357514
2      1176357514
3      1176357514
4      1176357514
          ...    
369    1176357514
370    1176357514
371    1176357514
372    1176357514
373    1176357514
Name: account_id, Length: 374, dtype: int64
2025-05-08 22:34:45,697 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:45,702 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:45,703 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:45,703 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:45,703 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:45,703 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:45,711 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 230-229
2025-05-08 22:34:45,711 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:45,713 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1176357514
2025-05-08 22:34:45,714 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:45,714 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:45,723 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 218994-218620
2025-05-08 22:34:45,723 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=233, account_id=1108205529) of 250
2025-05-08 22:34:45,723 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1108205529/match-history?only_stored_history=true
2025-05-08 22:34:45,724 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:45,963 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1108205529/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:45,966 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:45,966 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1108205529
1     1108205529
2     1108205529
3     1108205529
4     1108205529
         ...    
63    1108205529
64    1108205529
65    1108205529
66    1108205529
67    1108205529
Name: account_id, Length: 68, dtype: int64
2025-05-08 22:34:45,967 [DEBUG] [root.generate_player_performance_metrics] total_kills: 933
2025-05-08 22:34:45,967 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 280
2025-05-08 22:34:45,967 [DEBUG] [root.generate_player_performance_metrics] match_total: 68
2025-05-08 22:34:45,968 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1108205529
1     1108205529
2     1108205529
3     1108205529
4     1108205529
         ...    
63    1108205529
64    1108205529
65    1108205529
66    1108205529
67    1108205529
Name: account_id, Length: 68, dtype: int64
2025-05-08 22:34:45,968 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:45,972 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:45,973 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:45,973 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:45,973 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:45,973 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:45,981 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 231-230
2025-05-08 22:34:45,981 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:45,983 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1108205529
2025-05-08 22:34:45,983 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:45,983 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:45,988 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 219062-218994
2025-05-08 22:34:45,988 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=234, account_id=162829790) of 250
2025-05-08 22:34:45,988 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/162829790/match-history?only_stored_history=true
2025-05-08 22:34:45,989 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:46,453 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/162829790/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:46,548 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:46,549 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       162829790
1       162829790
2       162829790
3       162829790
4       162829790
          ...    
1288    162829790
1289    162829790
1290    162829790
1291    162829790
1292    162829790
Name: account_id, Length: 1293, dtype: int64
2025-05-08 22:34:46,549 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10727
2025-05-08 22:34:46,549 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 7092
2025-05-08 22:34:46,549 [DEBUG] [root.generate_player_performance_metrics] match_total: 1293
2025-05-08 22:34:46,550 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       162829790
1       162829790
2       162829790
3       162829790
4       162829790
          ...    
1288    162829790
1289    162829790
1290    162829790
1291    162829790
1292    162829790
Name: account_id, Length: 1293, dtype: int64
2025-05-08 22:34:46,550 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:46,555 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:46,556 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:46,557 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:46,557 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:46,557 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:46,564 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 232-231
2025-05-08 22:34:46,564 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:46,567 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 162829790
2025-05-08 22:34:46,568 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:46,568 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:46,579 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 220355-219062
2025-05-08 22:34:46,579 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=235, account_id=888327418) of 250
2025-05-08 22:34:46,579 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/888327418/match-history?only_stored_history=true
2025-05-08 22:34:46,580 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:46,873 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/888327418/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:46,979 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:46,979 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       888327418
1       888327418
2       888327418
3       888327418
4       888327418
          ...    
1500    888327418
1501    888327418
1502    888327418
1503    888327418
1504    888327418
Name: account_id, Length: 1505, dtype: int64
2025-05-08 22:34:46,980 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10752
2025-05-08 22:34:46,980 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 10209
2025-05-08 22:34:46,980 [DEBUG] [root.generate_player_performance_metrics] match_total: 1505
2025-05-08 22:34:46,981 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       888327418
1       888327418
2       888327418
3       888327418
4       888327418
          ...    
1500    888327418
1501    888327418
1502    888327418
1503    888327418
1504    888327418
Name: account_id, Length: 1505, dtype: int64
2025-05-08 22:34:46,981 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:46,986 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:46,987 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:46,987 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:46,987 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:46,987 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:46,995 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 233-232
2025-05-08 22:34:46,996 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:46,998 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 888327418
2025-05-08 22:34:46,998 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:46,998 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:47,012 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 221860-220355
2025-05-08 22:34:47,012 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=236, account_id=1140097740) of 250
2025-05-08 22:34:47,012 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1140097740/match-history?only_stored_history=true
2025-05-08 22:34:47,012 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:47,299 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1140097740/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:47,391 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:47,392 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       1140097740
1       1140097740
2       1140097740
3       1140097740
4       1140097740
           ...    
1486    1140097740
1487    1140097740
1488    1140097740
1489    1140097740
1490    1140097740
Name: account_id, Length: 1491, dtype: int64
2025-05-08 22:34:47,392 [DEBUG] [root.generate_player_performance_metrics] total_kills: 10504
2025-05-08 22:34:47,392 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8261
2025-05-08 22:34:47,392 [DEBUG] [root.generate_player_performance_metrics] match_total: 1491
2025-05-08 22:34:47,393 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       1140097740
1       1140097740
2       1140097740
3       1140097740
4       1140097740
           ...    
1486    1140097740
1487    1140097740
1488    1140097740
1489    1140097740
1490    1140097740
Name: account_id, Length: 1491, dtype: int64
2025-05-08 22:34:47,393 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:47,398 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:47,399 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:47,399 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:47,400 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:47,400 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:47,407 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 234-233
2025-05-08 22:34:47,407 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:47,409 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1140097740
2025-05-08 22:34:47,409 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:47,409 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:47,423 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 223351-221860
2025-05-08 22:34:47,423 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=237, account_id=163455333) of 250
2025-05-08 22:34:47,423 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/163455333/match-history?only_stored_history=true
2025-05-08 22:34:47,423 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:47,835 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/163455333/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:47,864 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:47,864 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      163455333
1      163455333
2      163455333
3      163455333
4      163455333
         ...    
977    163455333
978    163455333
979    163455333
980    163455333
981    163455333
Name: account_id, Length: 982, dtype: int64
2025-05-08 22:34:47,865 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7386
2025-05-08 22:34:47,865 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 5848
2025-05-08 22:34:47,865 [DEBUG] [root.generate_player_performance_metrics] match_total: 982
2025-05-08 22:34:47,866 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      163455333
1      163455333
2      163455333
3      163455333
4      163455333
         ...    
977    163455333
978    163455333
979    163455333
980    163455333
981    163455333
Name: account_id, Length: 982, dtype: int64
2025-05-08 22:34:47,866 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:47,870 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:47,871 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:47,872 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:47,872 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:47,872 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:47,881 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 235-234
2025-05-08 22:34:47,881 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:47,884 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 163455333
2025-05-08 22:34:47,884 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:47,884 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:47,893 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 224333-223351
2025-05-08 22:34:47,894 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=238, account_id=838322891) of 250
2025-05-08 22:34:47,894 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/838322891/match-history?only_stored_history=true
2025-05-08 22:34:47,894 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:48,430 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/838322891/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:48,440 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:48,440 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       838322891
1       838322891
2       838322891
3       838322891
4       838322891
          ...    
1036    838322891
1037    838322891
1038    838322891
1039    838322891
1040    838322891
Name: account_id, Length: 1041, dtype: int64
2025-05-08 22:34:48,441 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7044
2025-05-08 22:34:48,441 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6766
2025-05-08 22:34:48,441 [DEBUG] [root.generate_player_performance_metrics] match_total: 1041
2025-05-08 22:34:48,442 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       838322891
1       838322891
2       838322891
3       838322891
4       838322891
          ...    
1036    838322891
1037    838322891
1038    838322891
1039    838322891
1040    838322891
Name: account_id, Length: 1041, dtype: int64
2025-05-08 22:34:48,442 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:48,446 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:48,448 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:48,448 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:48,448 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:48,448 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:48,455 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 236-235
2025-05-08 22:34:48,455 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:48,457 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 838322891
2025-05-08 22:34:48,458 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:48,458 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:48,467 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 225374-224333
2025-05-08 22:34:48,467 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=239, account_id=1528704742) of 250
2025-05-08 22:34:48,467 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1528704742/match-history?only_stored_history=true
2025-05-08 22:34:48,468 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:48,905 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1528704742/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:48,907 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:48,907 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1528704742
1      1528704742
2      1528704742
3      1528704742
4      1528704742
          ...    
155    1528704742
156    1528704742
157    1528704742
158    1528704742
159    1528704742
Name: account_id, Length: 160, dtype: int64
2025-05-08 22:34:48,908 [DEBUG] [root.generate_player_performance_metrics] total_kills: 1874
2025-05-08 22:34:48,908 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 832
2025-05-08 22:34:48,908 [DEBUG] [root.generate_player_performance_metrics] match_total: 160
2025-05-08 22:34:48,909 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1528704742
1      1528704742
2      1528704742
3      1528704742
4      1528704742
          ...    
155    1528704742
156    1528704742
157    1528704742
158    1528704742
159    1528704742
Name: account_id, Length: 160, dtype: int64
2025-05-08 22:34:48,909 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:48,913 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:48,915 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:48,915 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:48,915 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:48,915 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:48,920 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 237-236
2025-05-08 22:34:48,920 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:48,922 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1528704742
2025-05-08 22:34:48,923 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:48,923 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:48,928 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 225534-225374
2025-05-08 22:34:48,929 [INFO] [root.run_etl_player_hero_match_trends] Time passed = 112.08seconds. Processed 240 of 250 players
2025-05-08 22:34:48,929 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=240, account_id=848192769) of 250
2025-05-08 22:34:48,929 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/848192769/match-history?only_stored_history=true
2025-05-08 22:34:48,929 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:49,445 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/848192769/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:49,451 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:49,451 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      848192769
1      848192769
2      848192769
3      848192769
4      848192769
         ...    
975    848192769
976    848192769
977    848192769
978    848192769
979    848192769
Name: account_id, Length: 980, dtype: int64
2025-05-08 22:34:49,452 [DEBUG] [root.generate_player_performance_metrics] total_kills: 8097
2025-05-08 22:34:49,452 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6746
2025-05-08 22:34:49,452 [DEBUG] [root.generate_player_performance_metrics] match_total: 980
2025-05-08 22:34:49,453 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      848192769
1      848192769
2      848192769
3      848192769
4      848192769
         ...    
975    848192769
976    848192769
977    848192769
978    848192769
979    848192769
Name: account_id, Length: 980, dtype: int64
2025-05-08 22:34:49,453 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:49,458 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:49,459 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:49,459 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:49,459 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:49,459 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:49,469 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 238-237
2025-05-08 22:34:49,469 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:49,471 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 848192769
2025-05-08 22:34:49,471 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:49,471 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:49,479 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 226514-225534
2025-05-08 22:34:49,479 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=241, account_id=1827474242) of 250
2025-05-08 22:34:49,479 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1827474242/match-history?only_stored_history=true
2025-05-08 22:34:49,481 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:49,738 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1827474242/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:49,750 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:49,750 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1827474242
1      1827474242
2      1827474242
3      1827474242
4      1827474242
          ...    
398    1827474242
399    1827474242
400    1827474242
401    1827474242
402    1827474242
Name: account_id, Length: 403, dtype: int64
2025-05-08 22:34:49,750 [DEBUG] [root.generate_player_performance_metrics] total_kills: 3673
2025-05-08 22:34:49,752 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 2300
2025-05-08 22:34:49,752 [DEBUG] [root.generate_player_performance_metrics] match_total: 403
2025-05-08 22:34:49,753 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1827474242
1      1827474242
2      1827474242
3      1827474242
4      1827474242
          ...    
398    1827474242
399    1827474242
400    1827474242
401    1827474242
402    1827474242
Name: account_id, Length: 403, dtype: int64
2025-05-08 22:34:49,753 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:49,757 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:49,759 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:49,759 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:49,759 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:49,759 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:49,765 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 239-238
2025-05-08 22:34:49,765 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:49,767 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1827474242
2025-05-08 22:34:49,768 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:49,768 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:49,774 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 226917-226514
2025-05-08 22:34:49,774 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=242, account_id=1725635087) of 250
2025-05-08 22:34:49,774 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1725635087/match-history?only_stored_history=true
2025-05-08 22:34:49,775 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:50,272 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1725635087/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:50,276 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:50,277 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1725635087
1      1725635087
2      1725635087
3      1725635087
4      1725635087
          ...    
584    1725635087
585    1725635087
586    1725635087
587    1725635087
588    1725635087
Name: account_id, Length: 589, dtype: int64
2025-05-08 22:34:50,277 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4746
2025-05-08 22:34:50,277 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3814
2025-05-08 22:34:50,277 [DEBUG] [root.generate_player_performance_metrics] match_total: 589
2025-05-08 22:34:50,278 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1725635087
1      1725635087
2      1725635087
3      1725635087
4      1725635087
          ...    
584    1725635087
585    1725635087
586    1725635087
587    1725635087
588    1725635087
Name: account_id, Length: 589, dtype: int64
2025-05-08 22:34:50,278 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:50,282 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:50,283 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:50,284 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:50,284 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:50,284 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:50,292 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 240-239
2025-05-08 22:34:50,292 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:50,294 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1725635087
2025-05-08 22:34:50,294 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:50,294 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:50,302 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 227506-226917
2025-05-08 22:34:50,302 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=243, account_id=40281331) of 250
2025-05-08 22:34:50,302 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/40281331/match-history?only_stored_history=true
2025-05-08 22:34:50,302 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:50,670 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/40281331/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:50,683 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:50,683 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      40281331
1      40281331
2      40281331
3      40281331
4      40281331
         ...   
523    40281331
524    40281331
525    40281331
526    40281331
527    40281331
Name: account_id, Length: 528, dtype: int64
2025-05-08 22:34:50,684 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4804
2025-05-08 22:34:50,684 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3650
2025-05-08 22:34:50,684 [DEBUG] [root.generate_player_performance_metrics] match_total: 528
2025-05-08 22:34:50,685 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      40281331
1      40281331
2      40281331
3      40281331
4      40281331
         ...   
523    40281331
524    40281331
525    40281331
526    40281331
527    40281331
Name: account_id, Length: 528, dtype: int64
2025-05-08 22:34:50,685 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:50,690 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:50,692 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:50,692 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:50,692 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:50,692 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:50,701 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 241-240
2025-05-08 22:34:50,701 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:50,703 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 40281331
2025-05-08 22:34:50,703 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:50,703 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:50,710 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 228034-227506
2025-05-08 22:34:50,710 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=244, account_id=294399714) of 250
2025-05-08 22:34:50,710 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/294399714/match-history?only_stored_history=true
2025-05-08 22:34:50,711 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:50,981 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/294399714/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:51,320 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:51,321 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       294399714
1       294399714
2       294399714
3       294399714
4       294399714
          ...    
1157    294399714
1158    294399714
1159    294399714
1160    294399714
1161    294399714
Name: account_id, Length: 1162, dtype: int64
2025-05-08 22:34:51,321 [DEBUG] [root.generate_player_performance_metrics] total_kills: 7395
2025-05-08 22:34:51,321 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 8157
2025-05-08 22:34:51,321 [DEBUG] [root.generate_player_performance_metrics] match_total: 1162
2025-05-08 22:34:51,322 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       294399714
1       294399714
2       294399714
3       294399714
4       294399714
          ...    
1157    294399714
1158    294399714
1159    294399714
1160    294399714
1161    294399714
Name: account_id, Length: 1162, dtype: int64
2025-05-08 22:34:51,322 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:51,327 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:51,328 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:51,328 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:51,328 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:51,328 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:51,335 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 242-241
2025-05-08 22:34:51,335 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:51,337 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 294399714
2025-05-08 22:34:51,337 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:51,337 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:51,348 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 229196-228034
2025-05-08 22:34:51,348 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=245, account_id=1207602479) of 250
2025-05-08 22:34:51,349 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1207602479/match-history?only_stored_history=true
2025-05-08 22:34:51,349 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:51,556 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1207602479/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:51,557 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:51,557 [DEBUG] [root.generate_player_performance_metrics] stats for player 0     1207602479
1     1207602479
2     1207602479
3     1207602479
4     1207602479
5     1207602479
6     1207602479
7     1207602479
8     1207602479
9     1207602479
10    1207602479
11    1207602479
12    1207602479
13    1207602479
14    1207602479
15    1207602479
16    1207602479
17    1207602479
18    1207602479
19    1207602479
20    1207602479
21    1207602479
22    1207602479
23    1207602479
24    1207602479
25    1207602479
26    1207602479
27    1207602479
28    1207602479
29    1207602479
30    1207602479
31    1207602479
32    1207602479
33    1207602479
34    1207602479
35    1207602479
36    1207602479
37    1207602479
38    1207602479
39    1207602479
40    1207602479
41    1207602479
42    1207602479
43    1207602479
44    1207602479
45    1207602479
46    1207602479
47    1207602479
48    1207602479
49    1207602479
50    1207602479
51    1207602479
52    1207602479
53    1207602479
54    1207602479
55    1207602479
56    1207602479
57    1207602479
58    1207602479
59    1207602479
Name: account_id, dtype: int64
2025-05-08 22:34:51,557 [DEBUG] [root.generate_player_performance_metrics] total_kills: 628
2025-05-08 22:34:51,557 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 268
2025-05-08 22:34:51,557 [DEBUG] [root.generate_player_performance_metrics] match_total: 60
2025-05-08 22:34:51,558 [WARNING] [root.compute_player_stats] No player stats calculated for player 0     1207602479
1     1207602479
2     1207602479
3     1207602479
4     1207602479
5     1207602479
6     1207602479
7     1207602479
8     1207602479
9     1207602479
10    1207602479
11    1207602479
12    1207602479
13    1207602479
14    1207602479
15    1207602479
16    1207602479
17    1207602479
18    1207602479
19    1207602479
20    1207602479
21    1207602479
22    1207602479
23    1207602479
24    1207602479
25    1207602479
26    1207602479
27    1207602479
28    1207602479
29    1207602479
30    1207602479
31    1207602479
32    1207602479
33    1207602479
34    1207602479
35    1207602479
36    1207602479
37    1207602479
38    1207602479
39    1207602479
40    1207602479
41    1207602479
42    1207602479
43    1207602479
44    1207602479
45    1207602479
46    1207602479
47    1207602479
48    1207602479
49    1207602479
50    1207602479
51    1207602479
52    1207602479
53    1207602479
54    1207602479
55    1207602479
56    1207602479
57    1207602479
58    1207602479
59    1207602479
Name: account_id, dtype: int64
2025-05-08 22:34:51,558 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:51,563 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:51,564 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:51,564 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:51,564 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:51,564 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:51,571 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 243-242
2025-05-08 22:34:51,571 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:51,573 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1207602479
2025-05-08 22:34:51,573 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:51,574 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:51,579 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 229256-229196
2025-05-08 22:34:51,579 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=246, account_id=12047600) of 250
2025-05-08 22:34:51,579 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/12047600/match-history?only_stored_history=true
2025-05-08 22:34:51,579 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:51,885 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/12047600/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:51,918 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:51,919 [DEBUG] [root.generate_player_performance_metrics] stats for player 0       12047600
1       12047600
2       12047600
3       12047600
4       12047600
          ...   
1179    12047600
1180    12047600
1181    12047600
1182    12047600
1183    12047600
Name: account_id, Length: 1184, dtype: int64
2025-05-08 22:34:51,919 [DEBUG] [root.generate_player_performance_metrics] total_kills: 6525
2025-05-08 22:34:51,919 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 6121
2025-05-08 22:34:51,919 [DEBUG] [root.generate_player_performance_metrics] match_total: 1184
2025-05-08 22:34:51,920 [WARNING] [root.compute_player_stats] No player stats calculated for player 0       12047600
1       12047600
2       12047600
3       12047600
4       12047600
          ...   
1179    12047600
1180    12047600
1181    12047600
1182    12047600
1183    12047600
Name: account_id, Length: 1184, dtype: int64
2025-05-08 22:34:51,920 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:51,924 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:51,926 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:51,926 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:51,926 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:51,926 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:51,935 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 244-243
2025-05-08 22:34:51,935 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:51,937 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 12047600
2025-05-08 22:34:51,937 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:51,937 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:51,947 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 230440-229256
2025-05-08 22:34:51,947 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=247, account_id=159221812) of 250
2025-05-08 22:34:51,947 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/159221812/match-history?only_stored_history=true
2025-05-08 22:34:51,948 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:52,358 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/159221812/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:52,372 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:52,372 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      159221812
1      159221812
2      159221812
3      159221812
4      159221812
         ...    
537    159221812
538    159221812
539    159221812
540    159221812
541    159221812
Name: account_id, Length: 542, dtype: int64
2025-05-08 22:34:52,373 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4143
2025-05-08 22:34:52,373 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 3306
2025-05-08 22:34:52,373 [DEBUG] [root.generate_player_performance_metrics] match_total: 542
2025-05-08 22:34:52,374 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      159221812
1      159221812
2      159221812
3      159221812
4      159221812
         ...    
537    159221812
538    159221812
539    159221812
540    159221812
541    159221812
Name: account_id, Length: 542, dtype: int64
2025-05-08 22:34:52,374 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:52,378 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:52,379 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:52,379 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:52,379 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:52,379 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:52,386 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 245-244
2025-05-08 22:34:52,386 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:52,388 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 159221812
2025-05-08 22:34:52,389 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:52,389 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:52,396 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 230982-230440
2025-05-08 22:34:52,396 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=248, account_id=219345973) of 250
2025-05-08 22:34:52,396 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/219345973/match-history?only_stored_history=true
2025-05-08 22:34:52,396 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:52,665 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/219345973/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:52,669 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:52,670 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      219345973
1      219345973
2      219345973
3      219345973
4      219345973
         ...    
725    219345973
726    219345973
727    219345973
728    219345973
729    219345973
Name: account_id, Length: 730, dtype: int64
2025-05-08 22:34:52,670 [DEBUG] [root.generate_player_performance_metrics] total_kills: 4418
2025-05-08 22:34:52,670 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4402
2025-05-08 22:34:52,670 [DEBUG] [root.generate_player_performance_metrics] match_total: 730
2025-05-08 22:34:52,671 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      219345973
1      219345973
2      219345973
3      219345973
4      219345973
         ...    
725    219345973
726    219345973
727    219345973
728    219345973
729    219345973
Name: account_id, Length: 730, dtype: int64
2025-05-08 22:34:52,671 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:52,676 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:52,677 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:52,677 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:52,677 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:52,677 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:52,686 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 246-245
2025-05-08 22:34:52,686 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:52,688 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 219345973
2025-05-08 22:34:52,688 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:52,688 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:52,696 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 231712-230982
2025-05-08 22:34:52,696 [DEBUG] [root.run_etl_player_hero_match_trends] Processing player Pandas(Index=249, account_id=1709408368) of 250
2025-05-08 22:34:52,696 [DEBUG] [root.fetch_player_match_history] Getting player match history from full url: https://api.deadlock-api.com/v1/players/1709408368/match-history?only_stored_history=true
2025-05-08 22:34:52,696 [DEBUG] [urllib3.connectionpool._new_conn] Starting new HTTPS connection (1): api.deadlock-api.com:443
2025-05-08 22:34:52,984 [DEBUG] [urllib3.connectionpool._make_request] https://api.deadlock-api.com:443 "GET /v1/players/1709408368/match-history?only_stored_history=true HTTP/1.1" 200 None
2025-05-08 22:34:52,993 [INFO] [root.calculate_won_column] Calculating 'won' column
2025-05-08 22:34:52,994 [DEBUG] [root.generate_player_performance_metrics] stats for player 0      1709408368
1      1709408368
2      1709408368
3      1709408368
4      1709408368
          ...    
677    1709408368
678    1709408368
679    1709408368
680    1709408368
681    1709408368
Name: account_id, Length: 682, dtype: int64
2025-05-08 22:34:52,994 [DEBUG] [root.generate_player_performance_metrics] total_kills: 5927
2025-05-08 22:34:52,994 [DEBUG] [root.generate_player_performance_metrics] total_deaths: 4563
2025-05-08 22:34:52,994 [DEBUG] [root.generate_player_performance_metrics] match_total: 682
2025-05-08 22:34:52,995 [WARNING] [root.compute_player_stats] No player stats calculated for player 0      1709408368
1      1709408368
2      1709408368
3      1709408368
4      1709408368
          ...    
677    1709408368
678    1709408368
679    1709408368
680    1709408368
681    1709408368
Name: account_id, Length: 682, dtype: int64
2025-05-08 22:34:52,995 [INFO] [root.count_player_streaks] Counting player streaks
2025-05-08 22:34:53,000 [DEBUG] [root.run_etl_player_hero_match_trends] Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-08 22:34:53,001 [DEBUG] [root.process_player_hero_stats] IN MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:53,001 [DEBUG] [root.run_etl_player_hero_match_trends] POST MERGE, Player stats columns: Index(['account_id', 'match_id', 'hero_id', 'hero_level', 'start_time',
       'game_mode', 'match_mode', 'player_team', 'player_kills',
       'player_deaths', 'player_assists', 'denies', 'net_worth', 'last_hits',
       'team_abandoned', 'abandoned_time_s', 'match_duration_s',
       'match_result', 'objectives_mask_team0', 'objectives_mask_team1', 'won',
       'win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches', 'p_v_h_kd_pct'],
      dtype='object')
2025-05-08 22:34:53,001 [INFO] [root.save_player_trends_to_db] Extra columns in player_trends, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'start_time', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'player_assists', 'last_hits', 'match_id', 'match_duration_s'}
2025-05-08 22:34:53,001 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:53,009 [INFO] [root.save_player_trends_to_db] Bulk load complete. rows inserted: 247-246
2025-05-08 22:34:53,009 [INFO] [root.compute_player_rolling_stats] Calculating player streak trends.
2025-05-08 22:34:53,011 [DEBUG] [root.compute_player_rolling_stats] Calculated player streak trends for player 1709408368
2025-05-08 22:34:53,012 [INFO] [root.save_player_rolling_stats_to_db] Extra columns in roll_stats, extras: {'team_abandoned', 'hero_level', 'won', 'game_mode', 'hero_id', 'match_result', 'player_deaths', 'objectives_mask_team0', 'objectives_mask_team1', 'p_win_pct_6', 'denies', 'match_mode', 'net_worth', 'player_kills', 'player_team', 'abandoned_time_s', 'p_loss_pct_6', 'player_assists', 'last_hits', 'match_duration_s'}
2025-05-08 22:34:53,012 [INFO] [root.save_player_rolling_stats_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-08 22:34:53,019 [INFO] [root.save_player_rolling_stats_to_db] Bulk load complete. rows inserted: 232394-231712
2025-05-08 22:34:53,019 [INFO] [root.run_etl_player_hero_match_trends] *TEST*completed player_trends
