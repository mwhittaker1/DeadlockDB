2025-05-16 13:36:17,849 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 13:36:17,849 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 13:36:17,853 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 13:36:17,853 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.00seconds. Processed Pandas(Index=0, account_id=109261166) of 5 players
2025-05-16 13:36:17,853 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=109261166) of 5
2025-05-16 13:36:17,853 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 109261166
2025-05-16 13:36:17,898 [DEBUG] [root.compute_player_stats] Calculating player stats for player 109261166
2025-05-16 13:36:17,898 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 109261166
2025-05-16 13:36:17,902 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.092612e+08
p_win_rate          5.134000e+01
p_average_kills     6.870000e+00
p_average_deaths    8.590000e+00
p_avg_kd            8.000000e-01
p_total_matches     1.194000e+03
dtype: float64
2025-05-16 13:36:17,902 [DEBUG] [root.count_player_streaks] Counting player streaks for: 109261166
2025-05-16 13:36:17,906 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     150.000000
win_streaks_3plus      83.000000
win_streaks_4plus      37.000000
win_streaks_5plus      22.000000
loss_streaks_2plus    152.000000
loss_streaks_3plus     73.000000
loss_streaks_4plus     36.000000
loss_streaks_5plus     17.000000
p_win_streak_avg        2.092150
p_loss_streak_avg       1.989726
dtype: float64
2025-05-16 13:36:17,906 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:36:17,907 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:36:17,908 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    109261166.0
Name: account_id, dtype: float64
2025-05-16 13:36:17,915 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              150.0               83.0               37.0               22.0               152.0                73.0  ...       51.34             6.87              8.59       0.8           1194.0         -11.0

[1 rows x 17 columns]
2025-05-16 13:36:17,915 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:36:17,919 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:36:17,926 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:36:18,027 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 109261166: 'won_int'
2025-05-16 13:36:18,027 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=1, account_id=393467885) of 5
2025-05-16 13:36:18,027 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 393467885
2025-05-16 13:36:18,039 [DEBUG] [root.compute_player_stats] Calculating player stats for player 393467885
2025-05-16 13:36:18,039 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 393467885
2025-05-16 13:36:18,041 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          3.934679e+08
p_win_rate          5.170000e+01
p_average_kills     7.380000e+00
p_average_deaths    8.560000e+00
p_avg_kd            8.600000e-01
p_total_matches     7.040000e+02
dtype: float64
2025-05-16 13:36:18,042 [DEBUG] [root.count_player_streaks] Counting player streaks for: 393467885
2025-05-16 13:36:18,045 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     85.000000
win_streaks_3plus     38.000000
win_streaks_4plus     21.000000
win_streaks_5plus     13.000000
loss_streaks_2plus    81.000000
loss_streaks_3plus    38.000000
loss_streaks_4plus    24.000000
loss_streaks_5plus    10.000000
p_win_streak_avg       2.068182
p_loss_streak_avg      1.920904
dtype: float64
2025-05-16 13:36:18,045 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:36:18,046 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:36:18,047 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    393467885.0
Name: account_id, dtype: float64
2025-05-16 13:36:18,053 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               85.0               38.0               21.0               13.0                81.0                38.0  ...        51.7             7.38              8.56      0.86            704.0          -5.0

[1 rows x 17 columns]
2025-05-16 13:36:18,053 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:36:18,056 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:36:18,062 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:36:18,120 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 393467885: 'won_int'
2025-05-16 13:36:18,120 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=2, account_id=46179133) of 5
2025-05-16 13:36:18,120 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 46179133
2025-05-16 13:36:18,132 [DEBUG] [root.compute_player_stats] Calculating player stats for player 46179133
2025-05-16 13:36:18,132 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 46179133
2025-05-16 13:36:18,134 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          46179133.00
p_win_rate                53.53
p_average_kills            8.22
p_average_deaths           5.12
p_avg_kd                   1.61
p_total_matches          751.00
dtype: float64
2025-05-16 13:36:18,134 [DEBUG] [root.count_player_streaks] Counting player streaks for: 46179133
2025-05-16 13:36:18,138 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     99.000000
win_streaks_3plus     53.000000
win_streaks_4plus     27.000000
win_streaks_5plus     20.000000
loss_streaks_2plus    84.000000
loss_streaks_3plus    50.000000
loss_streaks_4plus    24.000000
loss_streaks_5plus    13.000000
p_win_streak_avg       2.407186
p_loss_streak_avg      2.077381
dtype: float64
2025-05-16 13:36:18,138 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:36:18,139 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:36:18,140 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    46179133.0
Name: account_id, dtype: float64
2025-05-16 13:36:18,147 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               99.0               53.0               27.0               20.0                84.0                50.0  ...       53.53             8.22              5.12      1.61            751.0          70.0

[1 rows x 17 columns]
2025-05-16 13:36:18,147 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:36:18,150 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:36:18,156 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:36:18,220 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 46179133: 'won_int'
2025-05-16 13:36:18,221 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=3, account_id=1177550028) of 5
2025-05-16 13:36:18,221 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 1177550028
2025-05-16 13:36:18,254 [DEBUG] [root.compute_player_stats] Calculating player stats for player 1177550028
2025-05-16 13:36:18,254 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 1177550028
2025-05-16 13:36:18,256 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.177550e+09
p_win_rate          6.109000e+01
p_average_kills     6.740000e+00
p_average_deaths    4.960000e+00
p_avg_kd            1.360000e+00
p_total_matches     2.138000e+03
dtype: float64
2025-05-16 13:36:18,256 [DEBUG] [root.count_player_streaks] Counting player streaks for: 1177550028
2025-05-16 13:36:18,260 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     270.000000
win_streaks_3plus     172.000000
win_streaks_4plus     114.000000
win_streaks_5plus      81.000000
loss_streaks_2plus    192.000000
loss_streaks_3plus     90.000000
loss_streaks_4plus     43.000000
loss_streaks_5plus     22.000000
p_win_streak_avg        2.761099
p_loss_streak_avg       1.758985
dtype: float64
2025-05-16 13:36:18,260 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:36:18,261 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:36:18,262 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    1.177550e+09
Name: account_id, dtype: float64
2025-05-16 13:36:18,267 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              270.0              172.0              114.0               81.0               192.0                90.0  ...       61.09             6.74              4.96      1.36           2138.0          45.0

[1 rows x 17 columns]
2025-05-16 13:36:18,268 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:36:18,271 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:36:18,291 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:36:18,474 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 1177550028: 'won_int'
2025-05-16 13:36:18,474 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=4, account_id=486858272) of 5
2025-05-16 13:36:18,475 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 486858272
2025-05-16 13:36:18,485 [DEBUG] [root.compute_player_stats] Calculating player stats for player 486858272
2025-05-16 13:36:18,485 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 486858272
2025-05-16 13:36:18,487 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          4.868583e+08
p_win_rate          4.991000e+01
p_average_kills     8.010000e+00
p_average_deaths    7.190000e+00
p_avg_kd            1.110000e+00
p_total_matches     5.290000e+02
dtype: float64
2025-05-16 13:36:18,488 [DEBUG] [root.count_player_streaks] Counting player streaks for: 486858272
2025-05-16 13:36:18,491 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     66.000000
win_streaks_3plus     32.000000
win_streaks_4plus     19.000000
win_streaks_5plus      8.000000
loss_streaks_2plus    67.000000
loss_streaks_3plus    35.000000
loss_streaks_4plus    16.000000
loss_streaks_5plus     7.000000
p_win_streak_avg       2.000000
p_loss_streak_avg      2.022901
dtype: float64
2025-05-16 13:36:18,491 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:36:18,492 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:36:18,493 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    486858272.0
Name: account_id, dtype: float64
2025-05-16 13:36:18,499 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               66.0               32.0               19.0                8.0                67.0                35.0  ...       49.91             8.01              7.19      1.11            529.0          20.0

[1 rows x 17 columns]
2025-05-16 13:36:18,499 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:36:18,503 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:36:18,509 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:36:18,552 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 486858272: 'won_int'
2025-05-16 13:38:48,815 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 13:38:48,815 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 13:38:48,820 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 13:38:48,820 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.01seconds. Processed Pandas(Index=0, account_id=196305819) of 5 players
2025-05-16 13:38:48,820 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=196305819) of 5
2025-05-16 13:38:48,820 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 196305819
2025-05-16 13:38:48,863 [DEBUG] [root.compute_player_stats] Calculating player stats for player 196305819
2025-05-16 13:38:48,863 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 196305819
2025-05-16 13:38:48,867 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.963058e+08
p_win_rate          5.749000e+01
p_average_kills     9.900000e+00
p_average_deaths    6.040000e+00
p_avg_kd            1.640000e+00
p_total_matches     1.209000e+03
dtype: float64
2025-05-16 13:38:48,867 [DEBUG] [root.count_player_streaks] Counting player streaks for: 196305819
2025-05-16 13:38:48,871 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     160.000000
win_streaks_3plus     105.000000
win_streaks_4plus      65.000000
win_streaks_5plus      39.000000
loss_streaks_2plus    126.000000
loss_streaks_3plus     59.000000
loss_streaks_4plus     25.000000
loss_streaks_5plus     14.000000
p_win_streak_avg        2.482143
p_loss_streak_avg       1.835714
dtype: float64
2025-05-16 13:38:48,871 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:38:48,872 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:38:48,873 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    196305819.0
Name: account_id, dtype: float64
2025-05-16 13:38:48,880 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              160.0              105.0               65.0               39.0               126.0                59.0  ...       57.49              9.9              6.04      1.64           1209.0          73.0

[1 rows x 17 columns]
2025-05-16 13:38:48,880 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:38:48,883 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:38:48,890 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:38:50,185 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 196305819
2025-05-16 13:38:50,189 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:       account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0      196305819  18810067        3     1     12       9       12       8      39988  False 2024-09-30 01:13:30                   <NA>
1      196305819  18816926        7     1     10      13       18      15      36820  False 2024-09-30 01:59:37                   <NA>
2      196305819  26025698       17     1     17       7       11       1      45826   True 2024-11-02 03:04:25                   <NA>
3      196305819  26349328       17     1     21      11       15       0      69028   True 2024-11-03 23:51:39                   <NA>
4      196305819  27562425       17     1     10       4        8       2      42507  False 2024-11-12 14:57:58                   <NA>
...          ...       ...      ...   ...    ...     ...      ...     ...        ...    ...                 ...                    ...
1204   196305819  34196885       52     1      7       9       11       6      34252  False 2025-03-23 07:58:53                   <NA>
1205   196305819  34197717       17     0      4       5        1       2      20682  False 2025-03-23 08:36:27                   <NA>
1206   196305819  34275077       52     0      8       4        7       4      29069   True 2025-03-25 16:03:19                   <NA>
1207   196305819  34532288       17     0      9       7       12       5      41625  False 2025-04-03 00:17:11                   <NA>
1208   196305819  34213254       17     1     10       3        7       4      33065   True 2025-03-23 16:26:46                   <NA>

[1209 rows x 12 columns]
2025-05-16 13:38:50,192 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'}, extra={'denies', 'deaths', 'won', 'team', 'assists', 'prior_win_loss_streak', 'kills', 'hero_id', 'net_worth'}
2025-05-16 13:38:50,192 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 196305819: ('roll_stats columns do not align with matches schema, missing', {'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'})
2025-05-16 13:38:50,192 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=1, account_id=345987571) of 5
2025-05-16 13:38:50,192 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 345987571
2025-05-16 13:38:50,205 [DEBUG] [root.compute_player_stats] Calculating player stats for player 345987571
2025-05-16 13:38:50,205 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 345987571
2025-05-16 13:38:50,208 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          3.459876e+08
p_win_rate          5.522000e+01
p_average_kills     7.610000e+00
p_average_deaths    5.810000e+00
p_avg_kd            1.310000e+00
p_total_matches     9.000000e+02
dtype: float64
2025-05-16 13:38:50,208 [DEBUG] [root.count_player_streaks] Counting player streaks for: 345987571
2025-05-16 13:38:50,211 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     119.000000
win_streaks_3plus      72.000000
win_streaks_4plus      37.000000
win_streaks_5plus      19.000000
loss_streaks_2plus     99.000000
loss_streaks_3plus     54.000000
loss_streaks_4plus     21.000000
loss_streaks_5plus      8.000000
p_win_streak_avg        2.269406
p_loss_streak_avg       1.848624
dtype: float64
2025-05-16 13:38:50,211 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:38:50,212 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:38:50,213 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    345987571.0
Name: account_id, dtype: float64
2025-05-16 13:38:50,220 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              119.0               72.0               37.0               19.0                99.0                54.0  ...       55.22             7.61              5.81      1.31            900.0          40.0

[1 rows x 17 columns]
2025-05-16 13:38:50,220 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:38:50,223 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:38:50,228 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:38:51,213 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 345987571
2025-05-16 13:38:51,217 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0     345987571  26020842        1     0      5       2        9      11      33175   True 2024-11-02 02:03:47                   <NA>
1     345987571  26023464       13     0      9       8       17       4      56782  False 2024-11-02 02:36:04                   <NA>
2     345987571  26346673       13     1     12       2       10       6      38959   True 2024-11-03 23:20:21                   <NA>
3     345987571  26349389        7     0      4       2        1      13      21105   True 2024-11-03 23:52:13                   <NA>
4     345987571  26350992        7     0      2       7        3      19      34781  False 2024-11-04 00:11:55                   <NA>
..          ...       ...      ...   ...    ...     ...      ...     ...        ...    ...                 ...                    ...
895   345987571  34532983        4     1      7       4       20      13      35342   True 2025-04-03 01:03:35                   <NA>
896   345987571  34534112       17     1      7      11       12       5      41410  False 2025-04-03 02:34:01                   <NA>
897   345987571  34533488       17     1      6       6       10       3      57086   True 2025-04-03 01:40:48                   <NA>
898   345987571  34534628        4     1     15       4       11       5      55420   True 2025-04-03 03:22:24                   <NA>
899   345987571  34535119       17     1      4       4        2       9      31393  False 2025-04-03 04:10:48                   <NA>

[900 rows x 12 columns]
2025-05-16 13:38:51,217 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'}, extra={'denies', 'deaths', 'won', 'team', 'assists', 'prior_win_loss_streak', 'kills', 'hero_id', 'net_worth'}
2025-05-16 13:38:51,217 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 345987571: ('roll_stats columns do not align with matches schema, missing', {'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'})
2025-05-16 13:38:51,217 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=2, account_id=104030097) of 5
2025-05-16 13:38:51,217 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 104030097
2025-05-16 13:38:51,225 [DEBUG] [root.compute_player_stats] Calculating player stats for player 104030097
2025-05-16 13:38:51,225 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 104030097
2025-05-16 13:38:51,227 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.040301e+08
p_win_rate          5.119000e+01
p_average_kills     7.360000e+00
p_average_deaths    6.420000e+00
p_avg_kd            1.150000e+00
p_total_matches     2.950000e+02
dtype: float64
2025-05-16 13:38:51,227 [DEBUG] [root.count_player_streaks] Counting player streaks for: 104030097
2025-05-16 13:38:51,232 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     35.000000
win_streaks_3plus     20.000000
win_streaks_4plus     12.000000
win_streaks_5plus      6.000000
loss_streaks_2plus    37.000000
loss_streaks_3plus    18.000000
loss_streaks_4plus     8.000000
loss_streaks_5plus     7.000000
p_win_streak_avg       2.188406
p_loss_streak_avg      2.057143
dtype: float64
2025-05-16 13:38:51,232 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:38:51,233 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:38:51,234 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    104030097.0
Name: account_id, dtype: float64
2025-05-16 13:38:51,241 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               35.0               20.0               12.0                6.0                37.0                18.0  ...       51.19             7.36              6.42      1.15            295.0          24.0

[1 rows x 17 columns]
2025-05-16 13:38:51,242 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:38:51,245 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:38:51,254 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:38:51,603 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 104030097
2025-05-16 13:38:51,608 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0     104030097  18807807        7     0     12       5        3       9      27645   True 2024-09-30 00:59:26                   <NA>
1     104030097  24997016        2     1      5       7        2      14      38758  False 2024-10-26 16:45:47                   <NA>
2     104030097  25839649       13     1     13       5        8       8      47797   True 2024-10-31 20:32:49                   <NA>
3     104030097  25693240        7     0      6       6       10      12      48759   True 2024-10-30 20:13:20                   <NA>
4     104030097  25697903       13     1     10       6        7      19      54403  False 2024-10-30 20:58:48                   <NA>
..          ...       ...      ...   ...    ...     ...      ...     ...        ...    ...                 ...                    ...
290   104030097  26135329        7     1      5       7        7      10      34065  False 2024-11-02 18:02:59                   <NA>
291   104030097  32782836       58     0     11       7        8       5      26691  False 2025-02-09 20:48:22                   <NA>
292   104030097  32783505        1     0      5       3        8       6      38002  False 2025-02-09 21:20:23                   <NA>
293   104030097  25853132        7     0     12       3       10      19      51858   True 2024-10-31 22:57:59                   <NA>
294   104030097  33655655       13     1     11       6       14       2      37092   True 2025-03-06 21:01:26                   <NA>

[295 rows x 12 columns]
2025-05-16 13:38:51,608 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'}, extra={'denies', 'deaths', 'won', 'team', 'assists', 'prior_win_loss_streak', 'kills', 'hero_id', 'net_worth'}
2025-05-16 13:38:51,608 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 104030097: ('roll_stats columns do not align with matches schema, missing', {'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'})
2025-05-16 13:38:51,608 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=3, account_id=84379844) of 5
2025-05-16 13:38:51,608 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 84379844
2025-05-16 13:38:51,621 [DEBUG] [root.compute_player_stats] Calculating player stats for player 84379844
2025-05-16 13:38:51,621 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 84379844
2025-05-16 13:38:51,623 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          84379844.00
p_win_rate                53.63
p_average_kills            8.16
p_average_deaths           7.16
p_avg_kd                   1.14
p_total_matches          744.00
dtype: float64
2025-05-16 13:38:51,623 [DEBUG] [root.count_player_streaks] Counting player streaks for: 84379844
2025-05-16 13:38:51,627 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     98.000000
win_streaks_3plus     52.000000
win_streaks_4plus     31.000000
win_streaks_5plus     15.000000
loss_streaks_2plus    94.000000
loss_streaks_3plus    34.000000
loss_streaks_4plus    15.000000
loss_streaks_5plus    10.000000
p_win_streak_avg       2.145161
p_loss_streak_avg      1.864865
dtype: float64
2025-05-16 13:38:51,627 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:38:51,628 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:38:51,628 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    84379844.0
Name: account_id, dtype: float64
2025-05-16 13:38:51,636 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               98.0               52.0               31.0               15.0                94.0                34.0  ...       53.63             8.16              7.16      1.14            744.0          23.0

[1 rows x 17 columns]
2025-05-16 13:38:51,636 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:38:51,638 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:38:51,647 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:38:52,455 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 84379844
2025-05-16 13:38:52,458 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0      84379844  20469280        2     0      5       5        3       7      29683  False 2024-10-05 18:49:27                   <NA>
1      84379844  20473711        2     1      4       9       18       7      47558   True 2024-10-05 19:14:19                   <NA>
2      84379844  20480868       19     1     12       3        9      13      35401   True 2024-10-05 19:56:35                   <NA>
3      84379844  23234112       52     0      8      11       26       4      50625   True 2024-10-17 16:19:15                   <NA>
4      84379844  25288916        1     1     11       9       16      10      46633  False 2024-10-28 08:22:36                   <NA>
..          ...       ...      ...   ...    ...     ...      ...     ...        ...    ...                 ...                    ...
739    84379844  34850347       19     1     16       5       11       4      39861   True 2025-04-13 21:50:30                   <NA>
740    84379844  34930750       31     0     12      14       15       7      39280  False 2025-04-16 23:19:12                   <NA>
741    84379844  34196885       17     0      9       6       26       9      38552   True 2025-03-23 07:58:53                   <NA>
742    84379844  34197650        1     1      8       8        4       6      31455  False 2025-03-23 08:33:34                   <NA>
743    84379844  34198521       17     1      8      12       10       4      32839  False 2025-03-23 09:10:10                   <NA>

[744 rows x 12 columns]
2025-05-16 13:38:52,460 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'}, extra={'denies', 'deaths', 'won', 'team', 'assists', 'prior_win_loss_streak', 'kills', 'hero_id', 'net_worth'}
2025-05-16 13:38:52,460 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 84379844: ('roll_stats columns do not align with matches schema, missing', {'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'})
2025-05-16 13:38:52,460 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=4, account_id=172857725) of 5
2025-05-16 13:38:52,460 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 172857725
2025-05-16 13:38:52,471 [DEBUG] [root.compute_player_stats] Calculating player stats for player 172857725
2025-05-16 13:38:52,471 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 172857725
2025-05-16 13:38:52,472 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.728577e+08
p_win_rate          5.588000e+01
p_average_kills     8.680000e+00
p_average_deaths    7.820000e+00
p_avg_kd            1.110000e+00
p_total_matches     6.120000e+02
dtype: float64
2025-05-16 13:38:52,472 [DEBUG] [root.count_player_streaks] Counting player streaks for: 172857725
2025-05-16 13:38:52,475 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     87.000000
win_streaks_3plus     45.000000
win_streaks_4plus     26.000000
win_streaks_5plus     13.000000
loss_streaks_2plus    65.000000
loss_streaks_3plus    30.000000
loss_streaks_4plus    10.000000
loss_streaks_5plus     4.000000
p_win_streak_avg       2.178344
p_loss_streak_avg      1.730769
dtype: float64
2025-05-16 13:38:52,476 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:38:52,476 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:38:52,477 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    172857725.0
Name: account_id, dtype: float64
2025-05-16 13:38:52,483 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               87.0               45.0               26.0               13.0                65.0                30.0  ...       55.88             8.68              7.82      1.11            612.0          20.0

[1 rows x 17 columns]
2025-05-16 13:38:52,484 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:38:52,486 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:38:52,493 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:38:53,155 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 172857725
2025-05-16 13:38:53,159 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0     172857725  18797621       15     1     19      15       14      10      71906   True 2024-09-30 00:00:44                   <NA>
1     172857725  28979742       15     0     11      14       14       4      34195   True 2024-11-24 20:25:17                   <NA>
2     172857725  28429997       15     1     12      11       15       0      28656  False 2024-11-19 20:29:36                   <NA>
3     172857725  29334025       15     1     16      14        7       6      44364  False 2024-11-28 21:02:38                   <NA>
4     172857725  31845771       19     1      6      10        5       3      32550  False 2025-01-15 16:54:14                   <NA>
..          ...       ...      ...   ...    ...     ...      ...     ...        ...    ...                 ...                    ...
607   172857725  34586404       16     0     15      12       12       2      34837   True 2025-04-04 22:02:02                   <NA>
608   172857725  34661676        2     1      7       7        9       3      38621   True 2025-04-07 08:36:40                   <NA>
609   172857725  34587032       35     0      2      14        6       2      32373  False 2025-04-04 22:32:57                   <NA>
610   172857725  34060826       18     0      6       8       10       2      48961  False 2025-03-19 01:12:27                   <NA>
611   172857725  34442588       18     1      8       2       13       6      46110   True 2025-03-30 20:09:22                   <NA>

[612 rows x 12 columns]
2025-05-16 13:38:53,160 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'}, extra={'denies', 'deaths', 'won', 'team', 'assists', 'prior_win_loss_streak', 'kills', 'hero_id', 'net_worth'}
2025-05-16 13:38:53,160 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 172857725: ('roll_stats columns do not align with matches schema, missing', {'p_win_pct_4', 'p_win_pct_3', 'p_loss_pct_3', 'p_loss_pct_5', 'p_win_pct_2', 'p_loss_pct_4', 'p_loss_pct_2', 'p_win_pct_5'})
2025-05-16 13:43:49,844 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 13:43:49,844 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 13:43:49,848 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 13:43:49,849 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.01seconds. Processed Pandas(Index=0, account_id=196305819) of 5 players
2025-05-16 13:43:49,849 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=196305819) of 5
2025-05-16 13:43:49,849 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 196305819
2025-05-16 13:43:49,899 [DEBUG] [root.compute_player_stats] Calculating player stats for player 196305819
2025-05-16 13:43:49,899 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 196305819
2025-05-16 13:43:49,902 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.963058e+08
p_win_rate          5.749000e+01
p_average_kills     9.900000e+00
p_average_deaths    6.040000e+00
p_avg_kd            1.640000e+00
p_total_matches     1.209000e+03
dtype: float64
2025-05-16 13:43:49,902 [DEBUG] [root.count_player_streaks] Counting player streaks for: 196305819
2025-05-16 13:43:49,907 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     160.000000
win_streaks_3plus     105.000000
win_streaks_4plus      65.000000
win_streaks_5plus      39.000000
loss_streaks_2plus    126.000000
loss_streaks_3plus     59.000000
loss_streaks_4plus     25.000000
loss_streaks_5plus     14.000000
p_win_streak_avg        2.482143
p_loss_streak_avg       1.835714
dtype: float64
2025-05-16 13:43:49,907 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:43:49,907 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:43:49,908 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    196305819.0
Name: account_id, dtype: float64
2025-05-16 13:43:49,916 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              160.0              105.0               65.0               39.0               126.0                59.0  ...       57.49              9.9              6.04      1.64           1209.0          73.0

[1 rows x 17 columns]
2025-05-16 13:43:49,916 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:43:49,920 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:43:49,926 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:43:51,191 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 196305819
2025-05-16 13:43:51,194 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:    account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0   196305819  18810067        3     1     12       9       12       8      39988  False 2024-09-30 01:13:30                   <NA>
1   196305819  18816926        7     1     10      13       18      15      36820  False 2024-09-30 01:59:37                   <NA>
2   196305819  26025698       17     1     17       7       11       1      45826   True 2024-11-02 03:04:25                   <NA>
3   196305819  26349328       17     1     21      11       15       0      69028   True 2024-11-03 23:51:39                   <NA>
4   196305819  27562425       17     1     10       4        8       2      42507  False 2024-11-12 14:57:58                   <NA>
2025-05-16 13:43:51,195 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'}, extra={'deaths', 'won', 'assists', 'hero_id', 'denies', 'kills', 'team', 'net_worth'}
2025-05-16 13:43:51,195 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 196305819: ('roll_stats columns do not align with matches schema, missing', {'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'})
2025-05-16 13:43:51,195 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=1, account_id=345987571) of 5
2025-05-16 13:43:51,195 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 345987571
2025-05-16 13:43:51,209 [DEBUG] [root.compute_player_stats] Calculating player stats for player 345987571
2025-05-16 13:43:51,209 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 345987571
2025-05-16 13:43:51,211 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          3.459876e+08
p_win_rate          5.522000e+01
p_average_kills     7.610000e+00
p_average_deaths    5.810000e+00
p_avg_kd            1.310000e+00
p_total_matches     9.000000e+02
dtype: float64
2025-05-16 13:43:51,212 [DEBUG] [root.count_player_streaks] Counting player streaks for: 345987571
2025-05-16 13:43:51,215 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     119.000000
win_streaks_3plus      72.000000
win_streaks_4plus      37.000000
win_streaks_5plus      19.000000
loss_streaks_2plus     99.000000
loss_streaks_3plus     54.000000
loss_streaks_4plus     21.000000
loss_streaks_5plus      8.000000
p_win_streak_avg        2.269406
p_loss_streak_avg       1.848624
dtype: float64
2025-05-16 13:43:51,215 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:43:51,216 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:43:51,217 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    345987571.0
Name: account_id, dtype: float64
2025-05-16 13:43:51,222 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              119.0               72.0               37.0               19.0                99.0                54.0  ...       55.22             7.61              5.81      1.31            900.0          40.0

[1 rows x 17 columns]
2025-05-16 13:43:51,223 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:43:51,226 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:43:51,232 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:43:52,188 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 345987571
2025-05-16 13:43:52,192 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:    account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0   345987571  26020842        1     0      5       2        9      11      33175   True 2024-11-02 02:03:47                   <NA>
1   345987571  26023464       13     0      9       8       17       4      56782  False 2024-11-02 02:36:04                   <NA>
2   345987571  26346673       13     1     12       2       10       6      38959   True 2024-11-03 23:20:21                   <NA>
3   345987571  26349389        7     0      4       2        1      13      21105   True 2024-11-03 23:52:13                   <NA>
4   345987571  26350992        7     0      2       7        3      19      34781  False 2024-11-04 00:11:55                   <NA>
2025-05-16 13:43:52,192 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'}, extra={'deaths', 'won', 'assists', 'hero_id', 'denies', 'kills', 'team', 'net_worth'}
2025-05-16 13:43:52,192 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 345987571: ('roll_stats columns do not align with matches schema, missing', {'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'})
2025-05-16 13:43:52,192 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=2, account_id=104030097) of 5
2025-05-16 13:43:52,192 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 104030097
2025-05-16 13:43:52,200 [DEBUG] [root.compute_player_stats] Calculating player stats for player 104030097
2025-05-16 13:43:52,200 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 104030097
2025-05-16 13:43:52,202 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.040301e+08
p_win_rate          5.119000e+01
p_average_kills     7.360000e+00
p_average_deaths    6.420000e+00
p_avg_kd            1.150000e+00
p_total_matches     2.950000e+02
dtype: float64
2025-05-16 13:43:52,202 [DEBUG] [root.count_player_streaks] Counting player streaks for: 104030097
2025-05-16 13:43:52,205 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     35.000000
win_streaks_3plus     20.000000
win_streaks_4plus     12.000000
win_streaks_5plus      6.000000
loss_streaks_2plus    37.000000
loss_streaks_3plus    18.000000
loss_streaks_4plus     8.000000
loss_streaks_5plus     7.000000
p_win_streak_avg       2.188406
p_loss_streak_avg      2.057143
dtype: float64
2025-05-16 13:43:52,205 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:43:52,207 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:43:52,208 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    104030097.0
Name: account_id, dtype: float64
2025-05-16 13:43:52,213 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               35.0               20.0               12.0                6.0                37.0                18.0  ...       51.19             7.36              6.42      1.15            295.0          24.0

[1 rows x 17 columns]
2025-05-16 13:43:52,214 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:43:52,215 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:43:52,223 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:43:52,557 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 104030097
2025-05-16 13:43:52,560 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:    account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0   104030097  18807807        7     0     12       5        3       9      27645   True 2024-09-30 00:59:26                   <NA>
1   104030097  24997016        2     1      5       7        2      14      38758  False 2024-10-26 16:45:47                   <NA>
2   104030097  25839649       13     1     13       5        8       8      47797   True 2024-10-31 20:32:49                   <NA>
3   104030097  25693240        7     0      6       6       10      12      48759   True 2024-10-30 20:13:20                   <NA>
4   104030097  25697903       13     1     10       6        7      19      54403  False 2024-10-30 20:58:48                   <NA>
2025-05-16 13:43:52,560 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'}, extra={'deaths', 'won', 'assists', 'hero_id', 'denies', 'kills', 'team', 'net_worth'}
2025-05-16 13:43:52,560 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 104030097: ('roll_stats columns do not align with matches schema, missing', {'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'})
2025-05-16 13:43:52,560 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=3, account_id=84379844) of 5
2025-05-16 13:43:52,560 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 84379844
2025-05-16 13:43:52,573 [DEBUG] [root.compute_player_stats] Calculating player stats for player 84379844
2025-05-16 13:43:52,573 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 84379844
2025-05-16 13:43:52,575 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          84379844.00
p_win_rate                53.63
p_average_kills            8.16
p_average_deaths           7.16
p_avg_kd                   1.14
p_total_matches          744.00
dtype: float64
2025-05-16 13:43:52,575 [DEBUG] [root.count_player_streaks] Counting player streaks for: 84379844
2025-05-16 13:43:52,579 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     98.000000
win_streaks_3plus     52.000000
win_streaks_4plus     31.000000
win_streaks_5plus     15.000000
loss_streaks_2plus    94.000000
loss_streaks_3plus    34.000000
loss_streaks_4plus    15.000000
loss_streaks_5plus    10.000000
p_win_streak_avg       2.145161
p_loss_streak_avg      1.864865
dtype: float64
2025-05-16 13:43:52,580 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:43:52,581 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:43:52,582 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    84379844.0
Name: account_id, dtype: float64
2025-05-16 13:43:52,588 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               98.0               52.0               31.0               15.0                94.0                34.0  ...       53.63             8.16              7.16      1.14            744.0          23.0

[1 rows x 17 columns]
2025-05-16 13:43:52,588 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:43:52,591 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:43:52,598 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:43:53,535 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 84379844
2025-05-16 13:43:53,538 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:    account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0    84379844  20469280        2     0      5       5        3       7      29683  False 2024-10-05 18:49:27                   <NA>
1    84379844  20473711        2     1      4       9       18       7      47558   True 2024-10-05 19:14:19                   <NA>
2    84379844  20480868       19     1     12       3        9      13      35401   True 2024-10-05 19:56:35                   <NA>
3    84379844  23234112       52     0      8      11       26       4      50625   True 2024-10-17 16:19:15                   <NA>
4    84379844  25288916        1     1     11       9       16      10      46633  False 2024-10-28 08:22:36                   <NA>
2025-05-16 13:43:53,539 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'}, extra={'deaths', 'won', 'assists', 'hero_id', 'denies', 'kills', 'team', 'net_worth'}
2025-05-16 13:43:53,539 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 84379844: ('roll_stats columns do not align with matches schema, missing', {'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'})
2025-05-16 13:43:53,539 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=4, account_id=172857725) of 5
2025-05-16 13:43:53,539 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 172857725
2025-05-16 13:43:53,550 [DEBUG] [root.compute_player_stats] Calculating player stats for player 172857725
2025-05-16 13:43:53,550 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 172857725
2025-05-16 13:43:53,553 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.728577e+08
p_win_rate          5.588000e+01
p_average_kills     8.680000e+00
p_average_deaths    7.820000e+00
p_avg_kd            1.110000e+00
p_total_matches     6.120000e+02
dtype: float64
2025-05-16 13:43:53,553 [DEBUG] [root.count_player_streaks] Counting player streaks for: 172857725
2025-05-16 13:43:53,555 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     87.000000
win_streaks_3plus     45.000000
win_streaks_4plus     26.000000
win_streaks_5plus     13.000000
loss_streaks_2plus    65.000000
loss_streaks_3plus    30.000000
loss_streaks_4plus    10.000000
loss_streaks_5plus     4.000000
p_win_streak_avg       2.178344
p_loss_streak_avg      1.730769
dtype: float64
2025-05-16 13:43:53,557 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:43:53,557 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:43:53,558 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    172857725.0
Name: account_id, dtype: float64
2025-05-16 13:43:53,564 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  loss_streaks_3plus  ...  p_win_rate  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               87.0               45.0               26.0               13.0                65.0                30.0  ...       55.88             8.68              7.82      1.11            612.0          20.0

[1 rows x 17 columns]
2025-05-16 13:43:53,564 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:43:53,568 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:43:53,574 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:43:54,298 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 172857725
2025-05-16 13:43:54,302 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:    account_id  match_id  hero_id  team  kills  deaths  assists  denies  net_worth    won          start_time  prior_win_loss_streak
0   172857725  18797621       15     1     19      15       14      10      71906   True 2024-09-30 00:00:44                   <NA>
1   172857725  28979742       15     0     11      14       14       4      34195   True 2024-11-24 20:25:17                   <NA>
2   172857725  28429997       15     1     12      11       15       0      28656  False 2024-11-19 20:29:36                   <NA>
3   172857725  29334025       15     1     16      14        7       6      44364  False 2024-11-28 21:02:38                   <NA>
4   172857725  31845771       19     1      6      10        5       3      32550  False 2025-01-15 16:54:14                   <NA>
2025-05-16 13:43:54,302 [ERROR] [root.save_computed_player_match_data_to_db] roll_stats df schema mismatch:  missing={'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'}, extra={'deaths', 'won', 'assists', 'hero_id', 'denies', 'kills', 'team', 'net_worth'}
2025-05-16 13:43:54,302 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 172857725: ('roll_stats columns do not align with matches schema, missing', {'p_loss_pct_4', 'p_loss_pct_5', 'p_loss_pct_3', 'p_win_pct_2', 'p_win_pct_3', 'p_loss_pct_2', 'p_win_pct_5', 'p_win_pct_4'})
2025-05-16 13:46:01,263 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 13:46:01,264 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 13:46:01,270 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 13:46:01,271 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.01seconds. Processed Pandas(Index=0, account_id=196305819) of 5 players
2025-05-16 13:46:01,271 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=196305819) of 5
2025-05-16 13:46:14,096 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 196305819
2025-05-16 13:46:14,152 [DEBUG] [root.compute_player_stats] Calculating player stats for player 196305819
2025-05-16 13:46:14,152 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 196305819
2025-05-16 13:46:14,164 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.963058e+08
p_win_rate          5.749000e+01
p_average_kills     9.900000e+00
p_average_deaths    6.040000e+00
p_avg_kd            1.640000e+00
p_total_matches     1.209000e+03
dtype: float64
2025-05-16 13:46:14,164 [DEBUG] [root.count_player_streaks] Counting player streaks for: 196305819
2025-05-16 13:46:14,177 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     160.000000
win_streaks_3plus     105.000000
win_streaks_4plus      65.000000
win_streaks_5plus      39.000000
loss_streaks_2plus    126.000000
loss_streaks_3plus     59.000000
loss_streaks_4plus     25.000000
loss_streaks_5plus     14.000000
p_win_streak_avg        2.482143
p_loss_streak_avg       1.835714
dtype: float64
2025-05-16 13:46:14,178 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:46:14,179 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:46:14,180 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    196305819.0
Name: account_id, dtype: float64
2025-05-16 13:46:14,195 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              160.0              105.0               65.0               39.0               126.0  ...              9.9              6.04      1.64           1209.0          73.0

[1 rows x 17 columns]
2025-05-16 13:46:14,195 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:14,199 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:46:14,211 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:46:16,520 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 196305819
2025-05-16 13:46:53,439 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 13:46:53,439 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 13:46:53,443 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 13:46:53,443 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.00seconds. Processed Pandas(Index=0, account_id=109261166) of 5 players
2025-05-16 13:46:53,443 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=109261166) of 5
2025-05-16 13:46:53,443 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 109261166
2025-05-16 13:46:53,485 [DEBUG] [root.compute_player_stats] Calculating player stats for player 109261166
2025-05-16 13:46:53,485 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 109261166
2025-05-16 13:46:53,489 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.092612e+08
p_win_rate          5.134000e+01
p_average_kills     6.870000e+00
p_average_deaths    8.590000e+00
p_avg_kd            8.000000e-01
p_total_matches     1.194000e+03
dtype: float64
2025-05-16 13:46:53,489 [DEBUG] [root.count_player_streaks] Counting player streaks for: 109261166
2025-05-16 13:46:53,493 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     150.000000
win_streaks_3plus      83.000000
win_streaks_4plus      37.000000
win_streaks_5plus      22.000000
loss_streaks_2plus    152.000000
loss_streaks_3plus     73.000000
loss_streaks_4plus     36.000000
loss_streaks_5plus     17.000000
p_win_streak_avg        2.092150
p_loss_streak_avg       1.989726
dtype: float64
2025-05-16 13:46:53,494 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:46:53,494 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:46:53,496 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    109261166.0
Name: account_id, dtype: float64
2025-05-16 13:46:53,503 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              150.0               83.0               37.0               22.0               152.0  ...             6.87              8.59       0.8           1194.0         -11.0

[1 rows x 17 columns]
2025-05-16 13:46:53,503 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:53,506 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:46:53,513 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:46:54,858 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 109261166
2025-05-16 13:46:54,865 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:       account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
0      109261166  20486718       19     1      6       9       18  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
894    109261166  20559842        6     0     18       7        2  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
655    109261166  20763885        6     1     14       2        9  ...         33.33          NaN           NaN         NaN          NaN          NaN           NaN
656    109261166  20771831        6     0      2       3        0  ...         33.33         50.0          50.0         NaN          NaN          NaN           NaN
1134   109261166  20833119        6     1     21       7       16  ...         66.67         50.0          50.0        40.0         60.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:46:54,866 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'p_win_pct_6', 'won_int', 'deaths', 'net_worth', 'denies', 'won', 'team', 'kills', 'p_loss_pct_6', 'assists', 'hero_id'}
2025-05-16 13:46:54,866 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:54,872 [ERROR] [root.save_computed_player_match_data_to_db] Failed to load bulk match data
Traceback (most recent call last):
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 564, in save_computed_player_match_data_to_db
    with duckdb.connect(database=db.DB_PATH) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 568, in save_computed_player_match_data_to_db
    con.execute("""
duckdb.duckdb.BinderException: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:46:54,873 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 109261166: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:46:54,873 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=1, account_id=393467885) of 5
2025-05-16 13:46:54,873 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 393467885
2025-05-16 13:46:54,885 [DEBUG] [root.compute_player_stats] Calculating player stats for player 393467885
2025-05-16 13:46:54,885 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 393467885
2025-05-16 13:46:54,888 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          3.934679e+08
p_win_rate          5.170000e+01
p_average_kills     7.380000e+00
p_average_deaths    8.560000e+00
p_avg_kd            8.600000e-01
p_total_matches     7.040000e+02
dtype: float64
2025-05-16 13:46:54,888 [DEBUG] [root.count_player_streaks] Counting player streaks for: 393467885
2025-05-16 13:46:54,891 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     85.000000
win_streaks_3plus     38.000000
win_streaks_4plus     21.000000
win_streaks_5plus     13.000000
loss_streaks_2plus    81.000000
loss_streaks_3plus    38.000000
loss_streaks_4plus    24.000000
loss_streaks_5plus    10.000000
p_win_streak_avg       2.068182
p_loss_streak_avg      1.920904
dtype: float64
2025-05-16 13:46:54,892 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:46:54,893 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:46:54,894 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    393467885.0
Name: account_id, dtype: float64
2025-05-16 13:46:54,899 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               85.0               38.0               21.0               13.0                81.0  ...             7.38              8.56      0.86            704.0          -5.0

[1 rows x 17 columns]
2025-05-16 13:46:54,899 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:54,903 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:46:54,909 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:46:55,716 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 393467885
2025-05-16 13:46:55,724 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
245   393467885  18075397       13     1      8       7        5  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
0     393467885  18813772       31     0      6       6       15  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
1     393467885  18821972       13     1     10       6       12  ...         66.67          NaN           NaN         NaN          NaN          NaN           NaN
542   393467885  19108057       31     0      1      11       12  ...         66.67         25.0          75.0         NaN          NaN          NaN           NaN
376   393467885  19113993       31     1      7       9       10  ...         66.67         25.0          75.0        20.0         80.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:46:55,725 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'p_win_pct_6', 'won_int', 'deaths', 'net_worth', 'denies', 'won', 'team', 'kills', 'p_loss_pct_6', 'assists', 'hero_id'}
2025-05-16 13:46:55,725 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:55,728 [ERROR] [root.save_computed_player_match_data_to_db] Failed to load bulk match data
Traceback (most recent call last):
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 564, in save_computed_player_match_data_to_db
    with duckdb.connect(database=db.DB_PATH) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 568, in save_computed_player_match_data_to_db
    con.execute("""
duckdb.duckdb.BinderException: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:46:55,728 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 393467885: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:46:55,728 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=2, account_id=46179133) of 5
2025-05-16 13:46:55,728 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 46179133
2025-05-16 13:46:55,739 [DEBUG] [root.compute_player_stats] Calculating player stats for player 46179133
2025-05-16 13:46:55,739 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 46179133
2025-05-16 13:46:55,741 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          46179133.00
p_win_rate                53.53
p_average_kills            8.22
p_average_deaths           5.12
p_avg_kd                   1.61
p_total_matches          751.00
dtype: float64
2025-05-16 13:46:55,741 [DEBUG] [root.count_player_streaks] Counting player streaks for: 46179133
2025-05-16 13:46:55,745 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     99.000000
win_streaks_3plus     53.000000
win_streaks_4plus     27.000000
win_streaks_5plus     20.000000
loss_streaks_2plus    84.000000
loss_streaks_3plus    50.000000
loss_streaks_4plus    24.000000
loss_streaks_5plus    13.000000
p_win_streak_avg       2.407186
p_loss_streak_avg      2.077381
dtype: float64
2025-05-16 13:46:55,745 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:46:55,746 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:46:55,747 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    46179133.0
Name: account_id, dtype: float64
2025-05-16 13:46:55,753 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               99.0               53.0               27.0               20.0                84.0  ...             8.22              5.12      1.61            751.0          70.0

[1 rows x 17 columns]
2025-05-16 13:46:55,753 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:55,756 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:46:55,763 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:46:56,600 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 46179133
2025-05-16 13:46:56,609 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
232    46179133   9016745        3     0     19       9       11  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
233    46179133  18343723       52     1     12       5       27  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
234    46179133  18389837        1     1     13       7        8  ...         66.67          NaN           NaN         NaN          NaN          NaN           NaN
238    46179133  18400328       52     1      6       4        9  ...         66.67         50.0          50.0         NaN          NaN          NaN           NaN
235    46179133  18409729        7     1      0       0        0  ...         33.33         50.0          50.0        60.0         40.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:46:56,609 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'p_win_pct_6', 'won_int', 'deaths', 'net_worth', 'denies', 'won', 'team', 'kills', 'p_loss_pct_6', 'assists', 'hero_id'}
2025-05-16 13:46:56,609 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:56,613 [ERROR] [root.save_computed_player_match_data_to_db] Failed to load bulk match data
Traceback (most recent call last):
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 564, in save_computed_player_match_data_to_db
    with duckdb.connect(database=db.DB_PATH) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 568, in save_computed_player_match_data_to_db
    con.execute("""
duckdb.duckdb.BinderException: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:46:56,613 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 46179133: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:46:56,613 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=3, account_id=1177550028) of 5
2025-05-16 13:46:56,613 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 1177550028
2025-05-16 13:46:56,645 [DEBUG] [root.compute_player_stats] Calculating player stats for player 1177550028
2025-05-16 13:46:56,645 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 1177550028
2025-05-16 13:46:56,647 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.177550e+09
p_win_rate          6.109000e+01
p_average_kills     6.740000e+00
p_average_deaths    4.960000e+00
p_avg_kd            1.360000e+00
p_total_matches     2.138000e+03
dtype: float64
2025-05-16 13:46:56,647 [DEBUG] [root.count_player_streaks] Counting player streaks for: 1177550028
2025-05-16 13:46:56,651 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     270.000000
win_streaks_3plus     172.000000
win_streaks_4plus     114.000000
win_streaks_5plus      81.000000
loss_streaks_2plus    192.000000
loss_streaks_3plus     90.000000
loss_streaks_4plus     43.000000
loss_streaks_5plus     22.000000
p_win_streak_avg        2.761099
p_loss_streak_avg       1.758985
dtype: float64
2025-05-16 13:46:56,651 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:46:56,652 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:46:56,653 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    1.177550e+09
Name: account_id, dtype: float64
2025-05-16 13:46:56,659 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              270.0              172.0              114.0               81.0               192.0  ...             6.74              4.96      1.36           2138.0          45.0

[1 rows x 17 columns]
2025-05-16 13:46:56,659 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:56,662 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:46:56,668 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:46:59,004 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 1177550028
2025-05-16 13:46:59,012 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:       account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
683   1177550028  18488834       27     0     18      12        9  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
0     1177550028  18838145       27     0      7       8        7  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
1974  1177550028  18849477        7     0      3      14        4  ...        100.00          NaN           NaN         NaN          NaN          NaN           NaN
1975  1177550028  18856237       27     1      9       4       13  ...        100.00         25.0          75.0         NaN          NaN          NaN           NaN
414   1177550028  19718554       27     1     16      14       18  ...         66.67         25.0          75.0        20.0         80.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:46:59,013 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'p_win_pct_6', 'won_int', 'deaths', 'net_worth', 'denies', 'won', 'team', 'kills', 'p_loss_pct_6', 'assists', 'hero_id'}
2025-05-16 13:46:59,013 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:59,016 [ERROR] [root.save_computed_player_match_data_to_db] Failed to load bulk match data
Traceback (most recent call last):
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 564, in save_computed_player_match_data_to_db
    with duckdb.connect(database=db.DB_PATH) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 568, in save_computed_player_match_data_to_db
    con.execute("""
duckdb.duckdb.BinderException: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:46:59,016 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 1177550028: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:46:59,016 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=4, account_id=486858272) of 5
2025-05-16 13:46:59,016 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 486858272
2025-05-16 13:46:59,027 [DEBUG] [root.compute_player_stats] Calculating player stats for player 486858272
2025-05-16 13:46:59,027 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 486858272
2025-05-16 13:46:59,030 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          4.868583e+08
p_win_rate          4.991000e+01
p_average_kills     8.010000e+00
p_average_deaths    7.190000e+00
p_avg_kd            1.110000e+00
p_total_matches     5.290000e+02
dtype: float64
2025-05-16 13:46:59,030 [DEBUG] [root.count_player_streaks] Counting player streaks for: 486858272
2025-05-16 13:46:59,033 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     66.000000
win_streaks_3plus     32.000000
win_streaks_4plus     19.000000
win_streaks_5plus      8.000000
loss_streaks_2plus    67.000000
loss_streaks_3plus    35.000000
loss_streaks_4plus    16.000000
loss_streaks_5plus     7.000000
p_win_streak_avg       2.000000
p_loss_streak_avg      2.022901
dtype: float64
2025-05-16 13:46:59,033 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:46:59,034 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:46:59,035 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    486858272.0
Name: account_id, dtype: float64
2025-05-16 13:46:59,041 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               66.0               32.0               19.0                8.0                67.0  ...             8.01              7.19      1.11            529.0          20.0

[1 rows x 17 columns]
2025-05-16 13:46:59,041 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:59,043 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:46:59,050 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:46:59,663 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 486858272
2025-05-16 13:46:59,671 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
151   486858272  18464020        7     1      5       6        7  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
229   486858272  19928778        7     1      3       4        8  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
230   486858272  19948060        2     0      3       8        3  ...         33.33          NaN           NaN         NaN          NaN          NaN           NaN
284   486858272  19952327        3     0      5       6        5  ...         33.33         50.0          50.0         NaN          NaN          NaN           NaN
285   486858272  19959644        7     0      9       7       10  ...         66.67         50.0          50.0        60.0         40.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:46:59,671 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'p_win_pct_6', 'won_int', 'deaths', 'net_worth', 'denies', 'won', 'team', 'kills', 'p_loss_pct_6', 'assists', 'hero_id'}
2025-05-16 13:46:59,671 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:46:59,674 [ERROR] [root.save_computed_player_match_data_to_db] Failed to load bulk match data
Traceback (most recent call last):
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 564, in save_computed_player_match_data_to_db
    with duckdb.connect(database=db.DB_PATH) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\deadlock_match_prediction\services\transform_and_load.py", line 568, in save_computed_player_match_data_to_db
    con.execute("""
duckdb.duckdb.BinderException: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:46:59,674 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 486858272: Binder Error: Table "player_rolling_stats" does not have a column with name "prior_win_loss_streak"
2025-05-16 13:52:42,173 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 13:52:42,173 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 13:52:42,178 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 13:52:42,178 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.00seconds. Processed Pandas(Index=0, account_id=395566021) of 5 players
2025-05-16 13:52:42,178 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=395566021) of 5
2025-05-16 13:52:42,178 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 395566021
2025-05-16 13:52:42,220 [DEBUG] [root.compute_player_stats] Calculating player stats for player 395566021
2025-05-16 13:52:42,221 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 395566021
2025-05-16 13:52:42,223 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          3.955660e+08
p_win_rate          5.299000e+01
p_average_kills     1.172000e+01
p_average_deaths    6.800000e+00
p_avg_kd            1.720000e+00
p_total_matches     7.700000e+02
dtype: float64
2025-05-16 13:52:42,223 [DEBUG] [root.count_player_streaks] Counting player streaks for: 395566021
2025-05-16 13:52:42,227 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     96.000000
win_streaks_3plus     54.000000
win_streaks_4plus     29.000000
win_streaks_5plus      9.000000
loss_streaks_2plus    86.000000
loss_streaks_3plus    40.000000
loss_streaks_4plus    18.000000
loss_streaks_5plus    12.000000
p_win_streak_avg       2.071066
p_loss_streak_avg      1.828283
dtype: float64
2025-05-16 13:52:42,227 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:52:42,227 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:52:42,230 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    395566021.0
Name: account_id, dtype: float64
2025-05-16 13:52:42,236 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               96.0               54.0               29.0                9.0                86.0  ...            11.72               6.8      1.72            770.0          81.0

[1 rows x 17 columns]
2025-05-16 13:52:42,236 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:42,240 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8085-8085
2025-05-16 13:52:42,247 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:52:43,079 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 395566021
2025-05-16 13:52:43,086 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
278   395566021  18075397        3     1      7       7        9  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
276   395566021  18398135       12     0     12       9        7  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
277   395566021  18413075       35     1      2       6        0  ...         100.0          NaN           NaN         NaN          NaN          NaN           NaN
218   395566021  18512852       12     1      8       6        4  ...         100.0          0.0         100.0         NaN          NaN          NaN           NaN
0     395566021  18813772       17     0      9       5       13  ...         100.0          0.0         100.0         0.0        100.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:52:43,087 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'hero_id', 'p_loss_pct_6', 'kills', 'net_worth', 'team', 'p_win_pct_6', 'won', 'won_int', 'denies', 'deaths', 'assists'}
2025-05-16 13:52:43,087 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:43,099 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6187631-6187631
2025-05-16 13:52:43,113 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=1, account_id=856485431) of 5
2025-05-16 13:52:43,113 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 856485431
2025-05-16 13:52:43,120 [DEBUG] [root.compute_player_stats] Calculating player stats for player 856485431
2025-05-16 13:52:43,120 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 856485431
2025-05-16 13:52:43,122 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          8.564854e+08
p_win_rate          5.116000e+01
p_average_kills     6.740000e+00
p_average_deaths    6.920000e+00
p_avg_kd            9.700000e-01
p_total_matches     2.580000e+02
dtype: float64
2025-05-16 13:52:43,122 [DEBUG] [root.count_player_streaks] Counting player streaks for: 856485431
2025-05-16 13:52:43,126 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     31.000000
win_streaks_3plus     21.000000
win_streaks_4plus     12.000000
win_streaks_5plus      4.000000
loss_streaks_2plus    29.000000
loss_streaks_3plus    20.000000
loss_streaks_4plus    11.000000
loss_streaks_5plus     3.000000
p_win_streak_avg       2.095238
p_loss_streak_avg      2.000000
dtype: float64
2025-05-16 13:52:43,126 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:52:43,127 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:52:43,128 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    856485431.0
Name: account_id, dtype: float64
2025-05-16 13:52:43,134 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               31.0               21.0               12.0                4.0                29.0  ...             6.74              6.92      0.97            258.0           6.0

[1 rows x 17 columns]
2025-05-16 13:52:43,134 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:43,143 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8086-8085
2025-05-16 13:52:43,149 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:52:43,432 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 856485431
2025-05-16 13:52:43,440 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
55    856485431  18463314       31     1      8       6       10  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
56    856485431  18470156       25     0     15       5        5  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
44    856485431  18741203       25     1     13      11        8  ...         33.33          NaN           NaN         NaN          NaN          NaN           NaN
242   856485431  18935530        4     1     12       3       10  ...         33.33         75.0          25.0         NaN          NaN          NaN           NaN
179   856485431  18956488        4     1      7       4        3  ...         33.33         75.0          25.0        80.0         20.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:52:43,440 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'hero_id', 'p_loss_pct_6', 'kills', 'net_worth', 'team', 'p_win_pct_6', 'won', 'won_int', 'denies', 'deaths', 'assists'}
2025-05-16 13:52:43,440 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:43,453 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6187889-6187631
2025-05-16 13:52:43,463 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=2, account_id=101857281) of 5
2025-05-16 13:52:43,463 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 101857281
2025-05-16 13:52:43,466 [DEBUG] [root.compute_player_stats] Calculating player stats for player 101857281
2025-05-16 13:52:43,466 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 101857281
2025-05-16 13:52:43,469 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.018573e+08
p_win_rate          5.188000e+01
p_average_kills     7.830000e+00
p_average_deaths    9.480000e+00
p_avg_kd            8.300000e-01
p_total_matches     1.330000e+02
dtype: float64
2025-05-16 13:52:43,469 [DEBUG] [root.count_player_streaks] Counting player streaks for: 101857281
2025-05-16 13:52:43,472 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     18.000000
win_streaks_3plus     10.000000
win_streaks_4plus      4.000000
win_streaks_5plus      1.000000
loss_streaks_2plus    16.000000
loss_streaks_3plus     8.000000
loss_streaks_4plus     5.000000
loss_streaks_5plus     0.000000
p_win_streak_avg       1.916667
p_loss_streak_avg      1.828571
dtype: float64
2025-05-16 13:52:43,472 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:52:43,473 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:52:43,474 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    101857281.0
Name: account_id, dtype: float64
2025-05-16 13:52:43,480 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               18.0               10.0                4.0                1.0                16.0  ...             7.83              9.48      0.83            133.0          -8.0

[1 rows x 17 columns]
2025-05-16 13:52:43,480 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:43,485 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8086
2025-05-16 13:52:43,491 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:52:43,631 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 101857281
2025-05-16 13:52:43,639 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:     account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
58   101857281  18094345       10     1      2       8       10  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
59   101857281  18130941        6     1     13       6        2  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
34   101857281  18474583        8     1     17      11       15  ...          0.00          NaN           NaN         NaN          NaN          NaN           NaN
33   101857281  18505617       52     1      9      16       13  ...          0.00         75.0          25.0         NaN          NaN          NaN           NaN
35   101857281  18532794        1     1      2      11        7  ...         33.33         75.0          25.0        80.0         20.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:52:43,639 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'hero_id', 'p_loss_pct_6', 'kills', 'net_worth', 'team', 'p_win_pct_6', 'won', 'won_int', 'denies', 'deaths', 'assists'}
2025-05-16 13:52:43,639 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:43,647 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6188022-6187889
2025-05-16 13:52:43,657 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=3, account_id=167267690) of 5
2025-05-16 13:52:43,657 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 167267690
2025-05-16 13:52:43,673 [DEBUG] [root.compute_player_stats] Calculating player stats for player 167267690
2025-05-16 13:52:43,673 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 167267690
2025-05-16 13:52:43,676 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.672677e+08
p_win_rate          5.645000e+01
p_average_kills     9.090000e+00
p_average_deaths    4.840000e+00
p_avg_kd            1.880000e+00
p_total_matches     1.031000e+03
dtype: float64
2025-05-16 13:52:43,676 [DEBUG] [root.count_player_streaks] Counting player streaks for: 167267690
2025-05-16 13:52:43,679 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     135.000000
win_streaks_3plus      80.000000
win_streaks_4plus      45.000000
win_streaks_5plus      30.000000
loss_streaks_2plus    113.000000
loss_streaks_3plus     49.000000
loss_streaks_4plus     25.000000
loss_streaks_5plus     12.000000
p_win_streak_avg        2.445378
p_loss_streak_avg       1.886555
dtype: float64
2025-05-16 13:52:43,679 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:52:43,680 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:52:43,681 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    167267690.0
Name: account_id, dtype: float64
2025-05-16 13:52:43,686 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              135.0               80.0               45.0               30.0               113.0  ...             9.09              4.84      1.88           1031.0          97.0

[1 rows x 17 columns]
2025-05-16 13:52:43,686 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:43,689 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 13:52:43,696 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:52:44,864 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 167267690
2025-05-16 13:52:44,872 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
167   167267690  23745444       50     1      4       7        6  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
966   167267690  24441508       50     0     20       7       21  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
121   167267690  24449062       50     0      3       9        3  ...         66.67          NaN           NaN         NaN          NaN          NaN           NaN
122   167267690  24451793       13     1     11       2       12  ...         66.67         50.0          50.0         NaN          NaN          NaN           NaN
123   167267690  24455862        7     1     12      10        3  ...         66.67         50.0          50.0        40.0         60.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:52:44,873 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'hero_id', 'p_loss_pct_6', 'kills', 'net_worth', 'team', 'p_win_pct_6', 'won', 'won_int', 'denies', 'deaths', 'assists'}
2025-05-16 13:52:44,873 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:44,886 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6188032-6188022
2025-05-16 13:52:44,905 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=4, account_id=291902996) of 5
2025-05-16 13:52:44,905 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 291902996
2025-05-16 13:52:44,928 [DEBUG] [root.compute_player_stats] Calculating player stats for player 291902996
2025-05-16 13:52:44,928 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 291902996
2025-05-16 13:52:44,931 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          2.919030e+08
p_win_rate          5.188000e+01
p_average_kills     8.820000e+00
p_average_deaths    5.850000e+00
p_avg_kd            1.510000e+00
p_total_matches     1.247000e+03
dtype: float64
2025-05-16 13:52:44,931 [DEBUG] [root.count_player_streaks] Counting player streaks for: 291902996
2025-05-16 13:52:44,935 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     161.000000
win_streaks_3plus      84.000000
win_streaks_4plus      45.000000
win_streaks_5plus      21.000000
loss_streaks_2plus    158.000000
loss_streaks_3plus     74.000000
loss_streaks_4plus     27.000000
loss_streaks_5plus     14.000000
p_win_streak_avg        2.087097
p_loss_streak_avg       1.929260
dtype: float64
2025-05-16 13:52:44,936 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:52:44,936 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:52:44,937 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    291902996.0
Name: account_id, dtype: float64
2025-05-16 13:52:44,945 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              161.0               84.0               45.0               21.0               158.0  ...             8.82              5.85      1.51           1247.0          60.0

[1 rows x 17 columns]
2025-05-16 13:52:44,945 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:44,948 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 13:52:44,955 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:52:46,385 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 291902996
2025-05-16 13:52:46,394 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  ...  p_loss_pct_3  p_win_pct_4  p_loss_pct_4 p_win_pct_5 p_loss_pct_5  p_win_pct_6  p_loss_pct_6
491   291902996  13996017        7     0      3       7        7  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
492   291902996  18038361       10     1      5       3       10  ...           NaN          NaN           NaN         NaN          NaN          NaN           NaN
493   291902996  18389838       27     1      7       3        7  ...         33.33          NaN           NaN         NaN          NaN          NaN           NaN
494   291902996  18398128        3     0     13      11        8  ...         33.33         50.0          50.0         NaN          NaN          NaN           NaN
495   291902996  18407646       10     1      6       4       16  ...         33.33         50.0          50.0        60.0         40.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:52:46,395 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'hero_id', 'p_loss_pct_6', 'kills', 'net_worth', 'team', 'p_win_pct_6', 'won', 'won_int', 'denies', 'deaths', 'assists'}
2025-05-16 13:52:46,395 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:52:46,410 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6188124-6188032
2025-05-16 13:58:23,478 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 13:58:23,478 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 13:58:23,484 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 13:58:23,485 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.01seconds. Processed Pandas(Index=0, account_id=322014060) of 5 players
2025-05-16 13:58:23,485 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=322014060) of 5
2025-05-16 13:58:23,485 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 322014060
2025-05-16 13:58:23,525 [DEBUG] [root.compute_player_stats] Calculating player stats for player 322014060
2025-05-16 13:58:23,525 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 322014060
2025-05-16 13:58:23,534 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          3.220141e+08
p_win_rate          5.178000e+01
p_average_kills     9.200000e+00
p_average_deaths    6.340000e+00
p_avg_kd            1.450000e+00
p_total_matches     4.770000e+02
dtype: float64
2025-05-16 13:58:23,534 [DEBUG] [root.count_player_streaks] Counting player streaks for: 322014060
2025-05-16 13:58:23,545 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     57.000000
win_streaks_3plus     32.000000
win_streaks_4plus     20.000000
win_streaks_5plus     12.000000
loss_streaks_2plus    54.000000
loss_streaks_3plus    27.000000
loss_streaks_4plus    18.000000
loss_streaks_5plus     6.000000
p_win_streak_avg       2.166667
p_loss_streak_avg      2.017544
dtype: float64
2025-05-16 13:58:23,547 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 13:58:23,548 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 13:58:23,549 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    322014060.0
Name: account_id, dtype: float64
2025-05-16 13:58:23,564 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               57.0               32.0               20.0               12.0                54.0  ...              9.2              6.34      1.45            477.0          54.0

[1 rows x 17 columns]
2025-05-16 13:58:23,564 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:58:23,568 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 13:58:23,578 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 13:58:24,467 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 322014060
2025-05-16 13:58:28,268 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  ...  p_win_pct_3  p_loss_pct_3 p_win_pct_4 p_loss_pct_4  p_win_pct_5  p_loss_pct_5  p_win_pct_6  p_loss_pct_6
0     322014060  18796540       31     1      1       4        1       5  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
1     322014060  18799563       31     0      9       8        9       4  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
2     322014060  18805131       31     0     15       9       15       6  ...          0.0         100.0         NaN          NaN          NaN           NaN          NaN           NaN
3     322014060  18817424       52     0      8       5        9       8  ...          0.0         100.0         0.0        100.0          NaN           NaN          NaN           NaN
450   322014060  18854232       27     1     11       9       12       7  ...          0.0         100.0         0.0        100.0         20.0          80.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 13:58:31,794 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'p_loss_pct_6', 'p_win_pct_6', 'team', 'net_worth', 'won_int', 'assists', 'kills', 'hero_id', 'won', 'deaths', 'denies'}
2025-05-16 13:58:33,853 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 13:58:48,791 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6188601-6188124
2025-05-16 14:04:41,963 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 14:04:41,963 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 14:04:41,969 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 14:04:41,970 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.01seconds. Processed Pandas(Index=0, account_id=109261166) of 5 players
2025-05-16 14:04:41,970 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=109261166) of 5
2025-05-16 14:04:41,970 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 109261166
2025-05-16 14:04:42,017 [DEBUG] [root.compute_player_stats] Calculating player stats for player 109261166
2025-05-16 14:04:42,018 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 109261166
2025-05-16 14:04:42,026 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.092612e+08
p_win_rate          5.134000e+01
p_average_kills     6.870000e+00
p_average_deaths    8.590000e+00
p_avg_kd            8.000000e-01
p_total_matches     1.194000e+03
dtype: float64
2025-05-16 14:04:42,027 [DEBUG] [root.count_player_streaks] Counting player streaks for: 109261166
2025-05-16 14:04:42,039 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     150.000000
win_streaks_3plus      83.000000
win_streaks_4plus      37.000000
win_streaks_5plus      22.000000
loss_streaks_2plus    152.000000
loss_streaks_3plus     73.000000
loss_streaks_4plus     36.000000
loss_streaks_5plus     17.000000
p_win_streak_avg        2.092150
p_loss_streak_avg       1.989726
dtype: float64
2025-05-16 14:04:42,040 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:04:42,041 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:04:42,042 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    109261166.0
Name: account_id, dtype: float64
2025-05-16 14:04:42,057 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              150.0               83.0               37.0               22.0               152.0  ...             6.87              8.59       0.8           1194.0         -11.0

[1 rows x 17 columns]
2025-05-16 14:04:42,057 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:04:42,060 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:04:42,072 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:04:44,290 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 109261166
2025-05-16 14:04:56,146 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:       account_id  match_id  hero_id  team  kills  deaths  assists  denies  ...  p_win_pct_3  p_loss_pct_3 p_win_pct_4 p_loss_pct_4  p_win_pct_5  p_loss_pct_5  p_win_pct_6  p_loss_pct_6
0      109261166  20486718       19     1      6       9       18       5  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
894    109261166  20559842        6     0     18       7        2      10  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
655    109261166  20763885        6     1     14       2        9       0  ...        66.67         33.33         NaN          NaN          NaN           NaN          NaN           NaN
656    109261166  20771831        6     0      2       3        0       7  ...        66.67         33.33        50.0         50.0          NaN           NaN          NaN           NaN
1134   109261166  20833119        6     1     21       7       16       6  ...        33.33         66.67        50.0         50.0         40.0          60.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 14:06:37,886 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'assists', 'net_worth', 'kills', 'won', 'denies', 'deaths', 'p_win_pct_6', 'team', 'hero_id', 'won_int', 'p_loss_pct_6'}
2025-05-16 14:06:43,223 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:13:40,456 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 14:13:40,456 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 14:13:40,460 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 14:13:40,460 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.00seconds. Processed Pandas(Index=0, account_id=1465196567) of 5 players
2025-05-16 14:13:40,460 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=1465196567) of 5
2025-05-16 14:13:40,461 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 1465196567
2025-05-16 14:13:40,490 [DEBUG] [root.compute_player_stats] Calculating player stats for player 1465196567
2025-05-16 14:13:40,490 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 1465196567
2025-05-16 14:13:40,493 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.465197e+09
p_win_rate          6.464000e+01
p_average_kills     1.119000e+01
p_average_deaths    4.460000e+00
p_avg_kd            2.510000e+00
p_total_matches     2.630000e+02
dtype: float64
2025-05-16 14:13:40,493 [DEBUG] [root.count_player_streaks] Counting player streaks for: 1465196567
2025-05-16 14:13:40,497 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     39.000000
win_streaks_3plus     23.000000
win_streaks_4plus     15.000000
win_streaks_5plus     12.000000
loss_streaks_2plus    23.000000
loss_streaks_3plus    11.000000
loss_streaks_4plus     2.000000
loss_streaks_5plus     0.000000
p_win_streak_avg       2.931034
p_loss_streak_avg      1.631579
dtype: float64
2025-05-16 14:13:40,498 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:13:40,498 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:13:40,500 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    1.465197e+09
Name: account_id, dtype: float64
2025-05-16 14:13:40,506 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               39.0               23.0               15.0               12.0                23.0  ...            11.19              4.46      2.51            263.0         160.0

[1 rows x 17 columns]
2025-05-16 14:13:40,506 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:13:40,510 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:13:40,517 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:13:40,804 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 1465196567: Must specify a fill 'value' or 'method'.
2025-05-16 14:13:40,804 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=1, account_id=136024220) of 5
2025-05-16 14:13:40,804 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 136024220
2025-05-16 14:13:40,816 [DEBUG] [root.compute_player_stats] Calculating player stats for player 136024220
2025-05-16 14:13:40,816 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 136024220
2025-05-16 14:13:40,818 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.360242e+08
p_win_rate          6.316000e+01
p_average_kills     9.100000e+00
p_average_deaths    4.250000e+00
p_avg_kd            2.140000e+00
p_total_matches     4.370000e+02
dtype: float64
2025-05-16 14:13:40,818 [DEBUG] [root.count_player_streaks] Counting player streaks for: 136024220
2025-05-16 14:13:40,821 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     68.000000
win_streaks_3plus     39.000000
win_streaks_4plus     25.000000
win_streaks_5plus     14.000000
loss_streaks_2plus    37.000000
loss_streaks_3plus    13.000000
loss_streaks_4plus     7.000000
loss_streaks_5plus     3.000000
p_win_streak_avg       2.760000
p_loss_streak_avg      1.626263
dtype: float64
2025-05-16 14:13:40,822 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:13:40,822 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:13:40,823 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    136024220.0
Name: account_id, dtype: float64
2025-05-16 14:13:40,829 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               68.0               39.0               25.0               14.0                37.0  ...              9.1              4.25      2.14            437.0         123.0

[1 rows x 17 columns]
2025-05-16 14:13:40,829 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:13:40,833 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:13:40,840 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:13:41,432 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 136024220: Must specify a fill 'value' or 'method'.
2025-05-16 14:13:41,433 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=2, account_id=1716124084) of 5
2025-05-16 14:13:41,433 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 1716124084
2025-05-16 14:13:41,439 [DEBUG] [root.compute_player_stats] Calculating player stats for player 1716124084
2025-05-16 14:13:41,439 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 1716124084
2025-05-16 14:13:41,441 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.716124e+09
p_win_rate          6.550000e+01
p_average_kills     9.900000e+00
p_average_deaths    6.130000e+00
p_avg_kd            1.620000e+00
p_total_matches     2.290000e+02
dtype: float64
2025-05-16 14:13:41,441 [DEBUG] [root.count_player_streaks] Counting player streaks for: 1716124084
2025-05-16 14:13:41,445 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     28.000000
win_streaks_3plus     20.000000
win_streaks_4plus     15.000000
win_streaks_5plus     11.000000
loss_streaks_2plus    18.000000
loss_streaks_3plus    10.000000
loss_streaks_4plus     5.000000
loss_streaks_5plus     1.000000
p_win_streak_avg       3.409091
p_loss_streak_avg      1.837209
dtype: float64
2025-05-16 14:13:41,445 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:13:41,445 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:13:41,446 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    1.716124e+09
Name: account_id, dtype: float64
2025-05-16 14:13:41,452 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               28.0               20.0               15.0               11.0                18.0  ...              9.9              6.13      1.62            229.0          71.0

[1 rows x 17 columns]
2025-05-16 14:13:41,452 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:13:41,454 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:13:41,461 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:13:41,721 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 1716124084: Must specify a fill 'value' or 'method'.
2025-05-16 14:13:41,721 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=3, account_id=429795010) of 5
2025-05-16 14:13:41,721 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 429795010
2025-05-16 14:13:41,740 [DEBUG] [root.compute_player_stats] Calculating player stats for player 429795010
2025-05-16 14:13:41,740 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 429795010
2025-05-16 14:13:41,742 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          4.297950e+08
p_win_rate          5.503000e+01
p_average_kills     9.380000e+00
p_average_deaths    6.900000e+00
p_avg_kd            1.360000e+00
p_total_matches     1.194000e+03
dtype: float64
2025-05-16 14:13:41,742 [DEBUG] [root.count_player_streaks] Counting player streaks for: 429795010
2025-05-16 14:13:41,746 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     154.000000
win_streaks_3plus      92.000000
win_streaks_4plus      53.000000
win_streaks_5plus      34.000000
loss_streaks_2plus    131.000000
loss_streaks_3plus     69.000000
loss_streaks_4plus     31.000000
loss_streaks_5plus     13.000000
p_win_streak_avg        2.313380
p_loss_streak_avg       1.890845
dtype: float64
2025-05-16 14:13:41,746 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:13:41,746 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:13:41,747 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    429795010.0
Name: account_id, dtype: float64
2025-05-16 14:13:41,753 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              154.0               92.0               53.0               34.0               131.0  ...             9.38               6.9      1.36           1194.0          45.0

[1 rows x 17 columns]
2025-05-16 14:13:41,753 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:13:41,756 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:13:41,762 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:13:43,074 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 429795010: Must specify a fill 'value' or 'method'.
2025-05-16 14:13:43,074 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=4, account_id=24826186) of 5
2025-05-16 14:13:43,074 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 24826186
2025-05-16 14:13:43,082 [DEBUG] [root.compute_player_stats] Calculating player stats for player 24826186
2025-05-16 14:13:43,082 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 24826186
2025-05-16 14:13:43,084 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          24826186.00
p_win_rate                49.34
p_average_kills            8.18
p_average_deaths           4.60
p_avg_kd                   1.78
p_total_matches          302.00
dtype: float64
2025-05-16 14:13:43,084 [DEBUG] [root.count_player_streaks] Counting player streaks for: 24826186
2025-05-16 14:13:43,087 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     37.0000
win_streaks_3plus     14.0000
win_streaks_4plus      8.0000
win_streaks_5plus      5.0000
loss_streaks_2plus    39.0000
loss_streaks_3plus    21.0000
loss_streaks_4plus     8.0000
loss_streaks_5plus     3.0000
p_win_streak_avg       1.8625
p_loss_streak_avg      1.9125
dtype: float64
2025-05-16 14:13:43,087 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:13:43,087 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:13:43,088 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    24826186.0
Name: account_id, dtype: float64
2025-05-16 14:13:43,094 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               37.0               14.0                8.0                5.0                39.0  ...             8.18               4.6      1.78            302.0          87.0

[1 rows x 17 columns]
2025-05-16 14:13:43,094 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:13:43,096 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:13:43,103 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:13:43,431 [ERROR] [root.run_etl_player_hero_match_trends_from_db] Error processing player 24826186: Must specify a fill 'value' or 'method'.
2025-05-16 14:15:43,267 [INFO] [root.run_etl_player_hero_match_trends_from_db] Starting run_etl_player_hero_match_trends_from_db tests
2025-05-16 14:15:43,267 [INFO] [root.test_pull_trend_players_from_db] Pulling players from player_matches table to trend
2025-05-16 14:15:43,270 [INFO] [root.test_pull_trend_players_from_db] Pulled 5 players to trend
2025-05-16 14:15:43,271 [INFO] [root.run_etl_player_hero_match_trends_from_db] Time passed = 0.00seconds. Processed Pandas(Index=0, account_id=105267228) of 5 players
2025-05-16 14:15:43,271 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=0, account_id=105267228) of 5
2025-05-16 14:15:43,271 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 105267228
2025-05-16 14:15:43,306 [DEBUG] [root.compute_player_stats] Calculating player stats for player 105267228
2025-05-16 14:15:43,306 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 105267228
2025-05-16 14:15:43,309 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.052672e+08
p_win_rate          4.931000e+01
p_average_kills     7.440000e+00
p_average_deaths    4.680000e+00
p_avg_kd            1.590000e+00
p_total_matches     6.510000e+02
dtype: float64
2025-05-16 14:15:43,309 [DEBUG] [root.count_player_streaks] Counting player streaks for: 105267228
2025-05-16 14:15:43,313 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     71.000000
win_streaks_3plus     36.000000
win_streaks_4plus     20.000000
win_streaks_5plus     13.000000
loss_streaks_2plus    76.000000
loss_streaks_3plus    37.000000
loss_streaks_4plus    21.000000
loss_streaks_5plus    13.000000
p_win_streak_avg       2.018868
p_loss_streak_avg      2.075472
dtype: float64
2025-05-16 14:15:43,313 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:15:43,314 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:15:43,315 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    105267228.0
Name: account_id, dtype: float64
2025-05-16 14:15:43,321 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               71.0               36.0               20.0               13.0                76.0  ...             7.44              4.68      1.59            651.0          68.0

[1 rows x 17 columns]
2025-05-16 14:15:43,321 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:43,325 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:15:43,331 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:15:44,029 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 105267228
2025-05-16 14:15:44,038 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  ...  p_win_pct_3  p_loss_pct_3 p_win_pct_4 p_loss_pct_4  p_win_pct_5  p_loss_pct_5  p_win_pct_6  p_loss_pct_6
242   105267228  18012836       17     0     17       2       11      29  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
502   105267228  19065102       17     1      4       4        8      23  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
39    105267228  19650634       17     0     12       3       12      22  ...        100.0           0.0         NaN          NaN          NaN           NaN          NaN           NaN
199   105267228  20502613       52     1      4       6       11      44  ...        100.0           0.0       100.0          0.0          NaN           NaN          NaN           NaN
200   105267228  20518208       52     0      9       7       20      32  ...        100.0           0.0       100.0          0.0        100.0           0.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 14:15:44,041 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'kills', 'p_loss_pct_6', 'deaths', 'team', 'hero_id', 'net_worth', 'p_win_pct_6', 'assists', 'won_int', 'won', 'denies'}
2025-05-16 14:15:44,041 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:44,049 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6188617-6188617
2025-05-16 14:15:44,063 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=1, account_id=151934376) of 5
2025-05-16 14:15:44,063 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 151934376
2025-05-16 14:15:44,075 [DEBUG] [root.compute_player_stats] Calculating player stats for player 151934376
2025-05-16 14:15:44,075 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 151934376
2025-05-16 14:15:44,077 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.519344e+08
p_win_rate          5.420000e+01
p_average_kills     5.370000e+00
p_average_deaths    5.420000e+00
p_avg_kd            9.900000e-01
p_total_matches     6.900000e+02
dtype: float64
2025-05-16 14:15:44,077 [DEBUG] [root.count_player_streaks] Counting player streaks for: 151934376
2025-05-16 14:15:44,080 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     93.000000
win_streaks_3plus     51.000000
win_streaks_4plus     30.000000
win_streaks_5plus     16.000000
loss_streaks_2plus    79.000000
loss_streaks_3plus    37.000000
loss_streaks_4plus    20.000000
loss_streaks_5plus     9.000000
p_win_streak_avg       2.294479
p_loss_streak_avg      1.938650
dtype: float64
2025-05-16 14:15:44,080 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:15:44,081 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:15:44,082 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    151934376.0
Name: account_id, dtype: float64
2025-05-16 14:15:44,089 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               93.0               51.0               30.0               16.0                79.0  ...             5.37              5.42      0.99            690.0           8.0

[1 rows x 17 columns]
2025-05-16 14:15:44,089 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:44,092 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:15:44,099 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:15:44,850 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 151934376
2025-05-16 14:15:44,858 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  ...  p_win_pct_3  p_loss_pct_3 p_win_pct_4 p_loss_pct_4  p_win_pct_5  p_loss_pct_5  p_win_pct_6  p_loss_pct_6
226   151934376  18055130       11     1      6       5       19      10  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
150   151934376  18791460       11     0      6       9       10      13  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
0     151934376  18827449       11     0      6       6        9      17  ...        33.33         66.67         NaN          NaN          NaN           NaN          NaN           NaN
1     151934376  18832913       11     0      9       1       32      25  ...        33.33         66.67        50.0         50.0          NaN           NaN          NaN           NaN
524   151934376  19109935       11     1      5       2       15      22  ...        33.33         66.67        50.0         50.0         60.0          40.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 14:15:44,861 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'kills', 'p_loss_pct_6', 'deaths', 'team', 'hero_id', 'net_worth', 'p_win_pct_6', 'assists', 'won_int', 'won', 'denies'}
2025-05-16 14:15:44,861 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:44,874 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6188640-6188617
2025-05-16 14:15:44,889 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=2, account_id=1851360525) of 5
2025-05-16 14:15:44,889 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 1851360525
2025-05-16 14:15:44,895 [DEBUG] [root.compute_player_stats] Calculating player stats for player 1851360525
2025-05-16 14:15:44,895 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 1851360525
2025-05-16 14:15:44,897 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.851361e+09
p_win_rate          6.582000e+01
p_average_kills     1.146000e+01
p_average_deaths    4.250000e+00
p_avg_kd            2.700000e+00
p_total_matches     2.750000e+02
dtype: float64
2025-05-16 14:15:44,897 [DEBUG] [root.count_player_streaks] Counting player streaks for: 1851360525
2025-05-16 14:15:44,900 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     42.000000
win_streaks_3plus     27.000000
win_streaks_4plus     20.000000
win_streaks_5plus     13.000000
loss_streaks_2plus    19.000000
loss_streaks_3plus    10.000000
loss_streaks_4plus     5.000000
loss_streaks_5plus     0.000000
p_win_streak_avg       3.016667
p_loss_streak_avg      1.566667
dtype: float64
2025-05-16 14:15:44,901 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:15:44,902 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:15:44,903 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    1.851361e+09
Name: account_id, dtype: float64
2025-05-16 14:15:44,908 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               42.0               27.0               20.0               13.0                19.0  ...            11.46              4.25       2.7            275.0         179.0

[1 rows x 17 columns]
2025-05-16 14:15:44,908 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:44,911 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:15:44,917 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:15:45,222 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 1851360525
2025-05-16 14:15:45,230 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  ...  p_win_pct_3  p_loss_pct_3 p_win_pct_4 p_loss_pct_4  p_win_pct_5  p_loss_pct_5  p_win_pct_6  p_loss_pct_6
0    1851360525  31171176        8     0     24       1       11       5  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
1    1851360525  31172353        8     0     11       4        5       9  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
2    1851360525  31173642       12     1     26       5        8       8  ...        100.0           0.0         NaN          NaN          NaN           NaN          NaN           NaN
221  1851360525  31256322       19     0      9       1        8       1  ...        100.0           0.0       100.0          0.0          NaN           NaN          NaN           NaN
222  1851360525  31256910        2     1     20       4        6       5  ...        100.0           0.0       100.0          0.0        100.0           0.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 14:15:45,232 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'kills', 'p_loss_pct_6', 'deaths', 'team', 'hero_id', 'net_worth', 'p_win_pct_6', 'assists', 'won_int', 'won', 'denies'}
2025-05-16 14:15:45,232 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:45,238 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6188640-6188640
2025-05-16 14:15:45,250 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=3, account_id=972385555) of 5
2025-05-16 14:15:45,250 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 972385555
2025-05-16 14:15:45,255 [DEBUG] [root.compute_player_stats] Calculating player stats for player 972385555
2025-05-16 14:15:45,255 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 972385555
2025-05-16 14:15:45,257 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          9.723856e+08
p_win_rate          5.673000e+01
p_average_kills     9.540000e+00
p_average_deaths    5.710000e+00
p_avg_kd            1.670000e+00
p_total_matches     2.080000e+02
dtype: float64
2025-05-16 14:15:45,257 [DEBUG] [root.count_player_streaks] Counting player streaks for: 972385555
2025-05-16 14:15:45,261 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     28.000000
win_streaks_3plus     18.000000
win_streaks_4plus      7.000000
win_streaks_5plus      6.000000
loss_streaks_2plus    17.000000
loss_streaks_3plus     7.000000
loss_streaks_4plus     6.000000
loss_streaks_5plus     3.000000
p_win_streak_avg       2.185185
p_loss_streak_avg      1.666667
dtype: float64
2025-05-16 14:15:45,261 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:15:45,262 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:15:45,263 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    972385555.0
Name: account_id, dtype: float64
2025-05-16 14:15:45,268 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0               28.0               18.0                7.0                6.0                17.0  ...             9.54              5.71      1.67            208.0          76.0

[1 rows x 17 columns]
2025-05-16 14:15:45,268 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:45,271 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:15:45,277 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:15:45,511 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 972385555
2025-05-16 14:15:45,518 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  ...  p_win_pct_3  p_loss_pct_3 p_win_pct_4 p_loss_pct_4  p_win_pct_5  p_loss_pct_5  p_win_pct_6  p_loss_pct_6
123   972385555  19130741       50     0      9       4        7       5  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
10    972385555  19694556       11     0      6       3       13       6  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
11    972385555  19698752       50     1     22       9        9       3  ...        100.0           0.0         NaN          NaN          NaN           NaN          NaN           NaN
12    972385555  19704585       50     1     13       4       12       5  ...        100.0           0.0       100.0          0.0          NaN           NaN          NaN           NaN
135   972385555  19980296       10     0      7       4       18       1  ...        100.0           0.0       100.0          0.0        100.0           0.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 14:15:45,522 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'kills', 'p_loss_pct_6', 'deaths', 'team', 'hero_id', 'net_worth', 'p_win_pct_6', 'assists', 'won_int', 'won', 'denies'}
2025-05-16 14:15:45,522 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:45,528 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6188640-6188640
2025-05-16 14:15:45,539 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Processing player Pandas(Index=4, account_id=1229366592) of 5
2025-05-16 14:15:45,539 [DEBUG] [root.pull_player_match_history_from_db] Pulling match history for player from db for: 1229366592
2025-05-16 14:15:45,554 [DEBUG] [root.compute_player_stats] Calculating player stats for player 1229366592
2025-05-16 14:15:45,554 [DEBUG] [root.generate_player_performance_metrics] Calculating player performance metrics for 1229366592
2025-05-16 14:15:45,556 [DEBUG] [root.generate_player_performance_metrics] all perfomance metrics calculated, returning single row of p_stats= account_id          1.229367e+09
p_win_rate          5.115000e+01
p_average_kills     7.070000e+00
p_average_deaths    5.460000e+00
p_avg_kd            1.290000e+00
p_total_matches     7.860000e+02
dtype: float64
2025-05-16 14:15:45,556 [DEBUG] [root.count_player_streaks] Counting player streaks for: 1229366592
2025-05-16 14:15:45,560 [DEBUG] [root.count_player_streaks] all streaks calculated, returning single row of player_streak_trends= win_streaks_2plus     102.000000
win_streaks_3plus      46.000000
win_streaks_4plus      22.000000
win_streaks_5plus      12.000000
loss_streaks_2plus     97.000000
loss_streaks_3plus     46.000000
loss_streaks_4plus     19.000000
loss_streaks_5plus      8.000000
p_win_streak_avg        1.932692
p_loss_streak_avg       1.846154
dtype: float64
2025-05-16 14:15:45,560 [DEBUG] [root.run_etl_player_hero_match_trends_from_db] Player stats columns: Index(['win_streaks_2plus', 'win_streaks_3plus', 'win_streaks_4plus',
       'win_streaks_5plus', 'loss_streaks_2plus', 'loss_streaks_3plus',
       'loss_streaks_4plus', 'loss_streaks_5plus', 'p_win_streak_avg',
       'p_loss_streak_avg', 'account_id', 'p_win_rate', 'p_average_kills',
       'p_average_deaths', 'p_avg_kd', 'p_total_matches'],
      dtype='object')
2025-05-16 14:15:45,560 [INFO] [root.pull_hero_trends_from_db] Pulling hero trends from db for 30 days
2025-05-16 14:15:45,561 [DEBUG] [root.process_player_hero_stats] Processing player_hero stats for 0    1.229367e+09
Name: account_id, dtype: float64
2025-05-16 14:15:45,567 [DEBUG] [root.save_player_trends_to_db] Saving player trends to database:    win_streaks_2plus  win_streaks_3plus  win_streaks_4plus  win_streaks_5plus  loss_streaks_2plus  ...  p_average_kills  p_average_deaths  p_avg_kd  p_total_matches  p_v_h_kd_pct
0              102.0               46.0               22.0               12.0                97.0  ...             7.07              5.46      1.29            786.0          38.0

[1 rows x 17 columns]
2025-05-16 14:15:45,567 [INFO] [root.save_player_trends_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:45,570 [INFO] [root.save_player_trends_to_db] player_trends load complete. rows inserted: 8087-8087
2025-05-16 14:15:45,576 [INFO] [root.compute_player_match_history] Calculating player streak trends.
2025-05-16 14:15:46,443 [DEBUG] [root.compute_player_match_history] Calculated player streak trends for player 1229366592
2025-05-16 14:15:46,450 [DEBUG] [root.save_computed_player_match_data_to_db] Saving player rolling stats to database:      account_id  match_id  hero_id  team  kills  deaths  assists  denies  ...  p_win_pct_3  p_loss_pct_3 p_win_pct_4 p_loss_pct_4  p_win_pct_5  p_loss_pct_5  p_win_pct_6  p_loss_pct_6
727  1229366592  18852221        3     1      8       9       17      23  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
579  1229366592  19102988        3     1     11       7       10      13  ...          NaN           NaN         NaN          NaN          NaN           NaN          NaN           NaN
431  1229366592  19141687        3     0      8       6       16       7  ...        66.67         33.33         NaN          NaN          NaN           NaN          NaN           NaN
346  1229366592  19157972        1     1      8       5        3      17  ...        66.67         33.33        75.0         25.0          NaN           NaN          NaN           NaN
151  1229366592  19731179       27     1     22      13       18       4  ...       100.00          0.00        75.0         25.0         60.0          40.0          NaN           NaN

[5 rows x 23 columns]
2025-05-16 14:15:46,453 [INFO] [root.save_computed_player_match_data_to_db] Extra columns in roll_stats, extras: {'kills', 'p_loss_pct_6', 'deaths', 'team', 'hero_id', 'net_worth', 'p_win_pct_6', 'assists', 'won_int', 'won', 'denies'}
2025-05-16 14:15:46,453 [INFO] [root.save_computed_player_match_data_to_db] connected to database: c:/Code/Local Code/deadlock_match_prediction/data/deadlock.db
2025-05-16 14:15:46,466 [INFO] [root.save_computed_player_match_data_to_db] Bulk load complete. rows inserted: 6188709-6188640
